<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="csrf-token" content="laravel-token">
    <title>Cannabest POS System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/pos.js"></script>
    <script src="/js/modal-keyboard-handler.js"></script>
    <script src="/js/report-export.js"></script>
    <script src="/lib/alpine/alpine.min.js" defer></script>
    <script src="/lib/axios/axios.min.js"></script>
    <script src="/lib/qrious/qrious.min.js"></script>
    <link rel="stylesheet" href="/css/report-export.css">
    
    <style>
        .transition-all { transition: all 0.2s ease-in-out; }
        .shadow-sm { box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05); }
        .shadow-md { box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); }
        .shadow-xl { box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1); }
        
        /* Cannabis-specific colors */
        .text-cannabis-green { color: #16a34a; }
        .bg-cannabis-green { background-color: #16a34a; }
        .border-cannabis-green { border-color: #16a34a; }
        
        /* POS specific utilities */
        .product-card:hover { transform: translateY(-1px); }
        .cart-item { border-left: 3px solid transparent; }
        .cart-item.selected { border-left-color: #16a34a; background-color: #f0fdf4; }
        
        /* Modal animations */
        .modal { transition: opacity 150ms ease-out, transform 150ms ease-out; }
        .modal.hidden { opacity: 0; transform: scale(0.95); pointer-events: none; }
        .modal:not(.hidden) { opacity: 1; transform: scale(1); }
        
        /* Loading states */
        .loading { opacity: 0.6; pointer-events: none; }
        
        /* Cart animations */
        .cart-expand { transition: all 0.3s ease-in-out; }
        .cart-collapse { max-height: 120px; overflow: hidden; }
        .cart-expanded { max-height: none; }

        /* Enhanced cart expansion for new sales */
        .cart-new-sale-highlight {
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
            transform: scale(1.02);
            transition: all 0.3s ease-in-out;
        }

        /* Product area highlight for new sales */
        .product-area-highlight {
            box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.4);
            transition: all 0.3s ease-in-out;
        }

        /* Sticky cart improvements */
        .sticky-cart {
            position: sticky;
            top: 1rem;
            z-index: 20;
            max-height: calc(100vh - 2rem);
            overflow-y: auto;
        }

        /* Layout transition animations */
        .layout-transition {
            transition: all 0.5s ease-in-out;
        }

        /* New Sale button highlight */
        .new-sale-highlight {
            animation: pulse-yellow 2s infinite;
        }

        @keyframes pulse-yellow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(251, 191, 36, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(251, 191, 36, 0); }
        }

        /* Cart view toggle improvements */
        .cart-view-toggle {
            transition: all 0.2s ease-in-out;
        }

        .cart-view-toggle:hover {
            transform: scale(1.05);
        }

        .cart-view-toggle.active {
            box-shadow: 0 2px 4px rgba(34, 197, 94, 0.3);
        }
        
        /* View toggle styles */
        .view-toggle.active { background-color: #16a34a; color: white; }
        
        /* Cannabis animations */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes slideDown { from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .fade-in { animation: fadeIn 0.3s ease-out; }
        .slide-up { animation: slideUp 0.3s ease-out; }
        .slide-down { animation: slideDown 0.3s ease-out; }
        
        /* Age verification highlight */
        .age-verification-required { 
            animation: pulse 2s infinite;
            border: 2px solid #ef4444;
        }
        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
        }

        /* Print dialog styling */
        .print-dialog {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(4px);
        }
    </style>
</head>

<body class="font-sans antialiased bg-gray-50">
    <div id="app" class="min-h-screen" x-data="cannabisPOS()">
        <!-- Authentication Modal -->
        <div x-show="showAuthModal || !isAuthenticated" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-cloak>
            <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900">Cannabis POS Login</h3>
                    </div>

                    <div x-data="{ loginType: 'email' }" class="space-y-4">
                        <!-- Login Type Toggle -->
                        <div class="flex rounded-lg overflow-hidden border border-gray-300">
                            <button @click="loginType = 'email'" :class="loginType === 'email' ? 'bg-cannabis-green text-white' : 'bg-white text-gray-700'" class="flex-1 px-4 py-2 text-sm font-medium transition-colors">
                                Email Login
                            </button>
                            <button @click="loginType = 'pin'" :class="loginType === 'pin' ? 'bg-cannabis-green text-white' : 'bg-white text-gray-700'" class="flex-1 px-4 py-2 text-sm font-medium border-l border-gray-300 transition-colors">
                                PIN Login
                            </button>
                        </div>

                        <!-- Email Login Form -->
                        <div x-show="loginType === 'email'" class="space-y-4">
                            <div>
                                <label for="login-email" class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                                <input id="login-email" name="login-email" type="email" x-model="loginEmail" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cannabis-green" placeholder="Enter your email">
                            </div>
                            <div>
                                <label for="login-password" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                                <input id="login-password" name="login-password" type="password" x-model="loginPassword" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cannabis-green" placeholder="Enter your password" @keydown.enter="handleLogin(loginEmail, loginPassword)">
                            </div>
                            <button @click="handleLogin(loginEmail, loginPassword)" class="w-full bg-cannabis-green text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors">
                                Login
                            </button>
                        </div>

                        <!-- PIN Login Form -->
                        <div x-show="loginType === 'pin'" class="space-y-4">
                            <div>
                                <label for="employee-id" class="block text-sm font-medium text-gray-700 mb-2">Employee ID</label>
                                <input id="employee-id" name="employee-id" type="text" x-model="employeeId" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cannabis-green" placeholder="Enter Employee ID">
                            </div>
                            <div>
                                <label for="employee-pin" class="block text-sm font-medium text-gray-700 mb-2">PIN</label>
                                <input id="employee-pin" name="employee-pin" type="password" maxlength="4" x-model="employeePin" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cannabis-green text-center text-2xl tracking-widest" placeholder="••••" @keydown.enter="handlePinLogin(employeeId, employeePin)">
                            </div>
                            <button @click="handlePinLogin(employeeId, employeePin)" class="w-full bg-cannabis-green text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors">
                                Login with PIN
                            </button>
                        </div>

                        <!-- Error Display -->
                        <div x-show="loginError"
                             x-text="loginError"
                             class="mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg"
                             x-transition></div>

                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <nav class="bg-white shadow-sm border-b border-gray-200">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-28">
                    <!-- Logo with Navigation Dropdown -->
                    <div class="flex items-center">
                        <div class="relative" x-data="{ showNavDropdown: false }">
                            <!-- Cannabest POS Logo with Dropdown -->
                            <button @click="showNavDropdown = !showNavDropdown" class="flex items-center hover:opacity-80 transition-opacity focus:outline-none">
                                <img src="https://cdn.builder.io/api/v1/image/assets%2F6f06fa3566d241a1be44357d41f89c78%2F604690281aab4a22942fe5a59e12ecf2?format=webp&width=800" alt="Cannabest POS" class="h-24 w-auto mr-2">
                                <span class="sr-only">Cannabest POS</span>
                                <!-- Dropdown Arrow -->
                                <svg class="w-4 h-4 ml-2 transition-transform" :class="showNavDropdown ? 'rotate-180' : ''" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                                </svg>
                            </button>

                            <!-- Navigation Dropdown Menu -->
                            <div x-show="showNavDropdown" @click.outside="showNavDropdown = false" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0 scale-95" x-transition:enter-end="opacity-100 scale-100" x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100 scale-100" x-transition:leave-end="opacity-0 scale-95" class="absolute top-full left-0 mt-2 w-56 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-50">
                                <div class="py-1" role="menu">
                                    <!-- Point of Sale -->
                                    <button @click="setCurrentPage('pos'); showNavDropdown = false"
                                           :class="currentPage === 'pos' ? 'bg-cannabis-green text-white' : 'text-gray-700 hover:bg-gray-100'"
                                           class="w-full text-left px-4 py-3 text-sm font-medium flex items-center transition-colors">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.1 5M7 13h10M17 21a2 2 0 100-4 2 2 0 000 4zM9 21a2 2 0 100-4 2 2 0 000 4z"/>
                                        </svg>
                                        Point of Sale
                                        <span x-show="currentPage === 'pos'" class="ml-auto">
                                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                                            </svg>
                                        </span>
                                    </button>

                                    <!-- Other navigation items... -->
                                    <button @click="setCurrentPage('customers'); showNavDropdown = false"
                                           :class="currentPage === 'customers' ? 'bg-cannabis-green text-white' : 'text-gray-700 hover:bg-gray-100'"
                                           class="w-full text-left px-4 py-3 text-sm font-medium flex items-center transition-colors">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"/>
                                        </svg>
                                        Customer Management
                                    </button>

                                    <button @click="setCurrentPage('products'); showNavDropdown = false"
                                           :class="currentPage === 'products' ? 'bg-cannabis-green text-white' : 'text-gray-700 hover:bg-gray-100'"
                                           class="w-full text-left px-4 py-3 text-sm font-medium flex items-center transition-colors">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                                        </svg>
                                        Products
                                    </button>

                                    <button @click="setCurrentPage('metrc-vendors'); showNavDropdown = false"
                                           :class="currentPage === 'metrc-vendors' ? 'bg-cannabis-green text-white' : 'text-gray-700 hover:bg-gray-100'"
                                           class="w-full text-left px-4 py-3 text-sm font-medium flex items-center transition-colors">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3a4 4 0 118 0v4h1a2 2 0 012 2v9a2 2 0 01-2 2H7a2 2 0 01-2-2V9a2 2 0 012-2h1z"/>
                                        </svg>
                                        METRC Transfers
                                    </button>

                                    <button @click="setCurrentPage('employees'); showNavDropdown = false"
                                           :class="currentPage === 'employees' ? 'bg-cannabis-green text-white' : 'text-gray-700 hover:bg-gray-100'"
                                           class="w-full text-left px-4 py-3 text-sm font-medium flex items-center transition-colors">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                                        </svg>
                                        Employees
                                    </button>

                                    <button @click="setCurrentPage('rooms-drawers'); showNavDropdown = false"
                                           :class="currentPage === 'rooms-drawers' ? 'bg-cannabis-green text-white' : 'text-gray-700 hover:bg-gray-100'"
                                           class="w-full text-left px-4 py-3 text-sm font-medium flex items-center transition-colors">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-4m-5 0H3m2 0h2M7 7h10M7 11h10M7 15h10"/>
                                        </svg>
                                        Rooms & Drawers
                                    </button>

                                    <button @click="setCurrentPage('price-tiers'); showNavDropdown = false"
                                           :class="currentPage === 'price-tiers' ? 'bg-cannabis-green text-white' : 'text-gray-700 hover:bg-gray-100'"
                                           class="w-full text-left px-4 py-3 text-sm font-medium flex items-center transition-colors">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
                                        </svg>
                                        Price Tiers
                                    </button>

                                    <button @click="setCurrentPage('sales'); showNavDropdown = false"
                                           :class="currentPage === 'sales' ? 'bg-cannabis-green text-white' : 'text-gray-700 hover:bg-gray-100'"
                                           class="w-full text-left px-4 py-3 text-sm font-medium flex items-center transition-colors">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                        </svg>
                                        Sales
                                    </button>

                                    <button @click="setCurrentPage('order-queue'); showNavDropdown = false"
                                           :class="currentPage === 'order-queue' ? 'bg-cannabis-green text-white' : 'text-gray-700 hover:bg-gray-100'"
                                           class="w-full text-left px-4 py-3 text-sm font-medium flex items-center transition-colors">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"/>
                                        </svg>
                                        Order Queue
                                    </button>

                                    <button @click="setCurrentPage('inventory-evaluation'); showNavDropdown = false"
                                           :class="currentPage === 'inventory-evaluation' ? 'bg-cannabis-green text-white' : 'text-gray-700 hover:bg-gray-100'"
                                           class="w-full text-left px-4 py-3 text-sm font-medium flex items-center transition-colors">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a4 4 0 01-4-4V5a4 4 0 014-4h10a4 4 0 014 4v14a4 4 0 01-4 4z"/>
                                        </svg>
                                        Inventory Evaluation Report
                                    </button>

                                    <button @click="setCurrentPage('analytics'); showNavDropdown = false"
                                           :class="currentPage === 'analytics' ? 'bg-cannabis-green text-white' : 'text-gray-700 hover:bg-gray-100'"
                                           class="w-full text-left px-4 py-3 text-sm font-medium flex items-center transition-colors">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                                        </svg>
                                        Analytics
                                    </button>

                                    <button @click="setCurrentPage('reports'); showNavDropdown = false"
                                           :class="currentPage === 'reports' ? 'bg-cannabis-green text-white' : 'text-gray-700 hover:bg-gray-100'"
                                           class="w-full text-left px-4 py-3 text-sm font-medium flex items-center transition-colors">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                        </svg>
                                        Reports
                                    </button>

                                    <button @click="setCurrentPage('deals'); showNavDropdown = false"
                                           :class="currentPage === 'deals' ? 'bg-cannabis-green text-white' : 'text-gray-700 hover:bg-gray-100'"
                                           class="w-full text-left px-4 py-3 text-sm font-medium flex items-center transition-colors">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
                                        </svg>
                                        Deals & Specials
                                    </button>

                                    <button @click="setCurrentPage('loyalty'); showNavDropdown = false"
                                           :class="currentPage === 'loyalty' ? 'bg-cannabis-green text-white' : 'text-gray-700 hover:bg-gray-100'"
                                           class="w-full text-left px-4 py-3 text-sm font-medium flex items-center transition-colors">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                        </svg>
                                        Loyalty Program
                                    </button>

                                    <button @click="setCurrentPage('settings'); showNavDropdown = false"
                                           :class="currentPage === 'settings' ? 'bg-cannabis-green text-white' : 'text-gray-700 hover:bg-gray-100'"
                                           class="w-full text-left px-4 py-3 text-sm font-medium flex items-center transition-colors">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                        </svg>
                                        Settings
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Current Page Indicator -->
                        <div class="ml-6 hidden md:block">
                            <span class="text-sm text-gray-500">Current: </span>
                            <span class="text-sm font-medium text-cannabis-green" x-text="getCurrentPageTitle()"></span>
                        </div>
                    </div>

                    <!-- User Menu -->
                    <div class="flex items-center space-x-4">
                        <!-- Tax Display -->
                        <div class="flex items-center px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
                            </svg>
                            <span x-text="`Tax: ${taxRate}%`"></span>
                        </div>

                        <!-- Customer Info -->
                        <button @click="showCustomerModal = true" class="hidden md:flex items-center px-3 py-2 text-sm font-medium text-blue-700 bg-blue-100 hover:bg-blue-200 rounded-md transition-colors"
                               :class="selectedCustomer && selectedCustomer.isMedical ? 'bg-green-100 text-green-700' : ''">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                            </svg>
                            <span x-text="selectedCustomer ? selectedCustomer.name + (selectedCustomer.isMedical ? ' (Medical)' : '') : 'Select Customer'"></span>
                        </button>

                        <!-- Current Employee -->
                        <div class="hidden md:flex items-center text-sm text-gray-700">
                            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                            </svg>
                            <span x-text="currentUser ? currentUser.name : 'Employee'"></span>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="flex-1">
            <!-- POS Page -->
            <div x-show="currentPage === 'pos'" class="fade-in">
                <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
                    <div class="bg-white rounded-lg shadow-sm overflow-hidden">
                        <div class="p-6">
                            <div class="flex justify-between items-center mb-6">
                                <h2 class="text-2xl font-bold text-gray-900">Cannabis Point of Sale</h2>
                                <div class="flex space-x-2">
                                    <!-- Category Filter -->
                                    <label for="category-filter" class="sr-only">Filter by category</label>
                                    <select id="category-filter" name="category-filter" x-model="selectedCategory" @change="filterProducts()" class="px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cannabis-green">
                                        <option value="">All Categories</option>
                                        <option value="Flower">🌸 Flower</option>
                                        <option value="Pre-Rolls">���� Pre-Rolls</option>
                                        <option value="Infused">🔥 Infused (Joints/Blunts)</option>
                                        <option value="Edibles">����� Edibles</option>
                                        <option value="Concentrates">�� Concentrates</option>
                                        <option value="Vape Products">💨 Vape Products</option>
                                        <option value="Tinctures">🧪 Tinctures</option>
                                        <option value="Topicals">🧴 Topicals</option>
                                        <option value="Capsules">💊 Capsules</option>
                                        <option value="Beverages">🥤 Beverages</option>
                                        <option value="Suppositories">⚕️ Suppositories</option>
                                        <option value="Clones/Seeds">🌱 Clones/Seeds</option>
                                        <option value="Immature Plants">🌿 Immature Plants</option>
                                        <option value="Mature Plants">🌲 Mature Plants</option>
                                        <option value="Hemp">🌿 Hemp Products</option>
                                        <option value="Paraphernalia">🔧 Accessories</option>
                                    </select>

                                    <!-- Sort Options -->
                                    <label for="sort-order" class="sr-only">Sort products</label>
                                    <select id="sort-order" name="sort-order" x-model="sortOrder" @change="sortProducts()" class="px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cannabis-green">
                                        <option value="name-asc">Name (A-Z)</option>
                                        <option value="name-desc">Name (Z-A)</option>
                                        <option value="price-asc">Price (Low-High)</option>
                                        <option value="price-desc">Price (High-Low)</option>
                                        <option value="stock-asc">Stock (Low-High)</option>
                                        <option value="stock-desc">Stock (High-Low)</option>
                                        <option value="category-asc">Category (A-Z)</option>
                                        <option value="thc-desc">THC % (High-Low)</option>
                                    </select>

                                    <!-- View Toggle Buttons -->
                                    <div class="flex rounded-lg overflow-hidden border border-gray-300">
                                        <button @click="viewMode = 'cards'; resetPagination()" :class="viewMode === 'cards' ? 'view-toggle active' : 'view-toggle'" class="px-3 py-2 text-sm bg-white text-gray-700 hover:bg-gray-50 border-r border-gray-300">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/>
                                            </svg>
                                        </button>
                                        <button @click="viewMode = 'list'; resetPagination()" :class="viewMode === 'list' ? 'view-toggle active' : 'view-toggle'" class="px-3 py-2 text-sm bg-white text-gray-700 hover:bg-gray-50">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"/>
                                            </svg>
                                        </button>
                                    </div>

                                    <button @click="showNewSaleModal = true" class="bg-cannabis-green text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                                        New Sale
                                    </button>
                                    <button @click="clearCart()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors">
                                        Clear Cart
                                    </button>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 gap-6 layout-transition"
                                 :class="cartViewMode === 'wide' ? 'lg:grid-cols-4' : 'lg:grid-cols-3'">
                                <!-- Product Grid -->
                                <div class="layout-transition"
                                     :class="cartViewMode === 'wide' ? 'lg:col-span-1' : 'lg:col-span-2'">
                                    <div class="mb-4 space-y-3">
                                        <label for="product-search" class="sr-only">Search products</label>
                                        <input id="product-search" name="product-search" x-model="searchQuery" @input="filterProducts()" type="text" placeholder="Search products by name, category, SKU, vendor, or supplier..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cannabis-green focus:border-transparent" aria-label="Search products">

                                        <!-- Active Filters Display -->
                                        <div class="flex items-center justify-between">
                                            <div class="flex items-center gap-2">
                                                <span x-show="selectedCategory || searchQuery" class="text-sm text-gray-600">Active filters:</span>
                                                <div x-show="selectedCategory" class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-cannabis-green text-white">
                                                    <span x-text="selectedCategory"></span>
                                                    <button @click="selectedCategory = ''; filterProducts()" class="ml-2 text-white hover:text-gray-200">
                                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                                        </svg>
                                                    </button>
                                                </div>
                                                <div x-show="searchQuery" class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                                    <span>Search: "</span><span x-text="searchQuery"></span><span>"</span>
                                                    <button @click="searchQuery = ''; filterProducts()" class="ml-2 text-blue-600 hover:text-blue-800">
                                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                                        </svg>
                                                    </button>
                                                </div>
                                                <button x-show="selectedCategory || searchQuery" @click="selectedCategory = ''; searchQuery = ''; filterProducts()" class="text-xs text-gray-500 hover:text-gray-700 underline">
                                                    Clear all filters
                                                </button>
                                            </div>
                                            <div class="text-sm text-gray-600">
                                                <span x-text="paginatedProducts.length"></span> of <span x-text="sortedProducts.length"></span> products
                                                <span x-show="sortedProducts.length !== products.length" class="text-gray-500">
                                                    (filtered from <span x-text="products.length"></span> total)
                                                </span>
                                                <span x-show="totalPages > 1" class="text-xs text-gray-500 ml-2">
                                                    • Page <span x-text="currentProductPage"></span> of <span x-text="totalPages"></span>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    

                                    <!-- Card View -->
                                    <div x-show="viewMode === 'cards'"
                                         class="grid gap-4"
                                         :class="[
                                             cartViewMode === 'wide' ? 'grid-cols-1' : 'grid-cols-2 md:grid-cols-3'
                                         ]">
                                        <template x-for="product in paginatedProducts" :key="product.id">
                                            <div class="product-card bg-white border border-gray-200 rounded-lg hover:shadow-md transition-all"
                                                 :class="!product.onSalesFloor ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'">
                                                <!-- Product Image Area -->
                                                <div @click="handleProductCardClick(product)" class="aspect-square bg-gray-100 rounded-lg mb-3 flex items-center justify-center relative">
                                                    <!-- Cannabis Icon -->
                                                    <svg class="w-12 h-12 text-green-500" fill="currentColor" viewBox="0 0 24 24">
                                                        <path d="M12 2L13.09 7.26L18 4.27L15.74 9.09L21 8L16.77 11.62L21 16L15.74 14.91L18 19.73L13.09 16.74L12 22L10.91 16.74L6 19.73L8.26 14.91L3 16L7.23 11.62L3 8L8.26 9.09L6 4.27L10.91 7.26L12 2Z"/>
                                                    </svg>
                                                    <!-- GLS Badge for special items -->
                                                    <div x-show="product.isGLS" class="absolute top-1 right-1 bg-yellow-400 text-yellow-900 text-xs px-1 rounded">GLS</div>
                                                    <!-- Not on Sales Floor indicator -->
                                                    <div x-show="!product.onSalesFloor" class="absolute top-1 left-1 bg-red-500 text-white text-xs px-1 rounded">NOT AVAILABLE</div>
                                                    <!-- Quick Add to Cart overlay -->
                                                    <div x-show="product.onSalesFloor" class="absolute inset-0 bg-black bg-opacity-0 hover:bg-opacity-10 rounded-lg flex items-center justify-center opacity-0 hover:opacity-100 transition-all">
                                                        <span class="bg-cannabis-green text-white px-3 py-1 rounded-md text-sm font-medium" x-text="(selectedCustomer || ageVerified) ? 'Click to Add' : 'Start Sale First'"></span>
                                                    </div>
                                                </div>

                                                <!-- Product Info -->
                                                <div class="p-4 pt-0">
                                                    <h3 class="font-medium text-gray-900" x-text="product.name"></h3>
                                                    <p class="text-sm text-gray-500" x-text="`${product.category} ��� ${product.weight || 'N/A'}`"></p>
                                                    <div x-show="!['Paraphernalia', 'Accessories', 'Glass', 'Accessories/Paraphernalia'].includes(product.category)" class="text-sm text-gray-500">
                                                        <p x-text="`THC: ${getCannabinoidDisplay(product, 'thc', product.thc)}`"></p>
                                                        <p x-text="`CBD: ${getCannabinoidDisplay(product, 'cbd', product.cbd)}`"></p>
                                                        <div x-show="usesMgDisplay(product)" class="text-xs text-blue-600 font-medium mt-1">
                                                            <span x-show="isEdible(product)">📊 Edible - Showing mg content</span>
                                                            <span x-show="product.category === 'Tinctures'">🧪 Tincture - Showing mg content</span>
                                                            <span x-show="product.category === 'Topicals'">🧴 Topical - Showing mg content</span>
                                                            <span x-show="product.category === 'Infused'">🔥 Infused - Showing mg content</span>
                                                        </div>
                                                    </div>
                                                    <p class="text-xs text-gray-400 mt-1" x-text="`SKU: ${product.sku || 'N/A'} • Room: ${product.room || 'Main'}`"></p>
                                                    <p class="text-xs text-gray-400" x-text="`Vendor: ${product.vendor || 'N/A'} • Supplier: ${product.supplier || 'N/A'}`"></p>
                                                    
                                                    <!-- METRC Tag Display -->
                                                    <div class="flex items-center mt-2 p-2 bg-purple-50 rounded border">
                                                        <svg class="w-3 h-3 mr-1 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
                                                        </svg>
                                                        <span class="text-xs text-purple-700 font-mono" x-text="product.metrcTag || 'No METRC tag'"></span>
                                                    </div>

                                                    <div class="flex justify-between items-center mt-3 mb-3">
                                                        <!-- Show price tier for flower products, regular price for others -->
                                                        <div x-show="product.category === 'Flower' && product.priceTier" class="flex-1">
                                                            <p class="text-sm font-medium text-green-700" x-text="getFlowerTierName(product.priceTier)"></p>
                                                            <p class="text-xs text-green-600" x-text="getFlowerTierRange(product.priceTier)"></p>
                                                        </div>
                                                        <div x-show="!(product.category === 'Flower' && product.priceTier)">
                                                            <p class="text-lg font-bold text-cannabis-green" x-text="`$${(product.price || 0).toFixed(2)}`"></p>
                                                        </div>
                                                        <span class="text-xs text-gray-500" x-text="`Stock: ${product.stock}`"></span>
                                                    </div>

                                                    <!-- Product Action Buttons -->
                                                    <div class="grid grid-cols-2 gap-1 mt-3">
                                                        <!-- METRC Data Button -->
                                                        <button @click.stop="viewMetrcData(product)" class="flex items-center justify-center p-2 text-xs bg-purple-100 text-purple-700 rounded hover:bg-purple-200 transition-colors">
                                                            <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                                            </svg>
                                                            METRC
                                                        </button>

                                                        <!-- Transfer Room Button -->
                                                        <button @click.stop="openTransferRoom(product)" class="flex items-center justify-center p-2 text-xs bg-orange-100 text-orange-700 rounded hover:bg-orange-200 transition-colors" :title="!product.onSalesFloor ? 'Move to Sales Floor or Other Room' : 'Transfer to Another Room'">
                                                            <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"/>
                                                            </svg>
                                                            <span>Transfer</span>
                                                        </button>

                                                        <!-- Edit Product Button -->
                                                        <button @click.stop="editProduct(product)" class="flex items-center justify-center p-2 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors">
                                                            <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                                            </svg>
                                                            Edit
                                                        </button>

                                                        <!-- Print Button -->
                                                        <button @click.stop="showPrintTypeModal(product)" class="w-full flex items-center justify-center p-2 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors">
                                                            <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V9a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                                                            </svg>
                                                            Print
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </template>
                                    </div>

                                    <!-- List View -->
                                    <div x-show="viewMode === 'list'"
                                         class="space-y-3">
                                        <template x-for="product in paginatedProducts" :key="product.id">
                                            <div class="bg-white border border-gray-200 rounded-lg p-5 hover:shadow-md transition-all"
                                                 :class="!product.onSalesFloor ? 'opacity-50 cursor-not-allowed bg-gray-50' : 'cursor-pointer'"
                                                 @click="handleProductCardClick(product)">
                                                <div class="flex items-start gap-4">
                                                    <!-- Main Product Information -->
                                                    <div class="flex-1 min-w-0">
                                                        <div class="grid grid-cols-1 lg:grid-cols-4 gap-4">
                                                            <!-- Product Name & Basic Info -->
                                                            <div class="lg:col-span-1">
                                                                <h3 class="font-semibold text-gray-900 text-base mb-1" x-text="product.name"></h3>
                                                                <div class="space-y-1">
                                                                    <p class="text-sm text-gray-600" x-text="`${product.category} • ${product.weight || 'N/A'}`"></p>
                                                                    <p class="text-xs text-gray-500" x-text="`SKU: ${product.sku || 'N/A'}`"></p>
                                                                    <div x-show="!product.onSalesFloor" class="inline-block text-xs text-red-600 font-medium bg-red-50 px-2 py-1 rounded">
                                                                        NOT ON SALES FLOOR
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <!-- METRC Info -->
                                            <div class="lg:col-span-1">
                                                <div class="space-y-2">
                                                    <div class="text-xs font-mono text-purple-700 bg-purple-50 px-2 py-1 rounded inline-block" x-text="product.metrcTag || 'No METRC'"></div>
                                                </div>
                                            </div>

                                                            <!-- Cannabinoid Profile -->
                                                            <div x-show="!['Paraphernalia', 'Accessories', 'Glass', 'Accessories/Paraphernalia'].includes(product.category)" class="lg:col-span-1">
                                                                <div class="space-y-1">
                                                                    <div class="font-medium text-xs text-gray-500 uppercase mb-2">Cannabinoids</div>
                                                                    <div class="grid grid-cols-2 gap-1 text-sm text-gray-700">
                                                                        <div class="flex justify-between">
                                                                            <span class="text-xs text-gray-500">THC:</span>
                                                                            <span class="font-medium" x-text="getCannabinoidDisplay(product, 'thc', product.thc)"></span>
                                                                        </div>
                                                                        <div class="flex justify-between">
                                                                            <span class="text-xs text-gray-500">CBD:</span>
                                                                            <span class="font-medium" x-text="getCannabinoidDisplay(product, 'cbd', product.cbd)"></span>
                                                                        </div>
                                                                        <div class="flex justify-between">
                                                                            <span class="text-xs text-gray-500">CBN:</span>
                                                                            <span class="font-medium" x-text="getCannabinoidDisplay(product, 'cbn', product.metrcData?.cbn)"></span>
                                                                        </div>
                                                                        <div class="flex justify-between">
                                                                            <span class="text-xs text-gray-500">CBG:</span>
                                                                            <span class="font-medium" x-text="getCannabinoidDisplay(product, 'cbg', product.metrcData?.cbg)"></span>
                                                                        </div>
                                                                    </div>
                                                                    <div x-show="usesMgDisplay(product)" class="text-xs text-blue-600 font-medium mt-2">
                                                                        <span x-show="isEdible(product)">📊 Edible - Showing mg content</span>
                                                                        <span x-show="product.category === 'Tinctures'">🧪 Tincture - Showing mg content</span>
                                                                        <span x-show="product.category === 'Topicals'">🧴 Topical - Showing mg content</span>
                                                                        <span x-show="product.category === 'Infused'">🔥 Infused - Showing mg content</span>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <!-- Stock, Room & Price -->
                                                            <div class="lg:col-span-1">
                                                                <div class="space-y-2">
                                                                    <div class="text-sm text-gray-600">
                                                                        <div class="font-medium text-xs text-gray-500 uppercase">Stock & Location</div>
                                                                        <div x-text="`${product.stock} units`"></div>
                                                                        <div class="text-xs text-gray-500" x-text="`Room: ${product.room || 'Main'}`"></div>
                                                                    </div>
                                                                    <div class="text-right">
                                                                        <!-- Show price tier for flower products, regular price for others -->
                                                                        <div x-show="product.category === 'Flower' && product.priceTier">
                                                                            <div class="text-sm font-medium text-green-700" x-text="getFlowerTierName(product.priceTier)"></div>
                                                                            <div class="text-xs text-green-600" x-text="getFlowerTierRange(product.priceTier)"></div>
                                                                        </div>
                                                                        <div x-show="!(product.category === 'Flower' && product.priceTier)">
                                                                            <div class="text-lg font-bold text-cannabis-green" x-text="`$${(product.price || 0).toFixed(2)}`"></div>
                                                                        </div>
                                                                        <div x-show="product.isGLS" class="inline-block text-xs bg-yellow-400 text-yellow-900 px-2 py-1 rounded mt-1">
                                                                            Green Leaf Special
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <!-- Action Buttons -->
                                                    <div class="flex flex-col gap-1 flex-shrink-0">
                                                        <button @click.stop="viewMetrcData(product)" class="p-2 text-xs bg-purple-100 text-purple-700 rounded hover:bg-purple-200 transition-colors" title="METRC Data">
                                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                                            </svg>
                                                        </button>
                                                        <button @click.stop="openTransferRoom(product)" class="p-2 text-xs bg-orange-100 text-orange-700 rounded hover:bg-orange-200 transition-colors" title="Transfer Room">
                                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"/>
                                                            </svg>
                                                        </button>
                                                        <button @click.stop="editProduct(product)" class="p-2 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors" title="Edit Product">
                                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                                            </svg>
                                                        </button>
                                                        <button @click.stop="showPrintTypeModal(product)" class="p-2 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors" title="Print">
                                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V9a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                                                            </svg>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                    <!-- Pagination Controls -->
                                    <div x-show="totalPages > 1" class="mt-6 flex items-center justify-between">
                                        <!-- Pagination Info -->
                                        <div class="text-sm text-gray-600">
                                            <span>Showing </span>
                                            <span x-text="paginationInfo.start"></span>
                                            <span> to </span>
                                            <span x-text="paginationInfo.end"></span>
                                            <span> of </span>
                                            <span x-text="paginationInfo.total"></span>
                                            <span> products</span>
                                            <span class="text-xs text-gray-500 ml-2">
                                                (<span x-text="viewMode === 'cards' ? itemsPerPageCard : itemsPerPageList"></span> per page)
                                            </span>
                                        </div>

                                        <!-- Pagination Controls -->
                                        <div class="flex items-center space-x-2">
                                            <!-- Previous Button -->
                                            <button @click="prevPage()"
                                                    :disabled="currentProductPage === 1"
                                                    class="px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                                                </svg>
                                                Previous
                                            </button>

                                            <!-- Page Numbers -->
                                            <div class="flex items-center space-x-1">
                                                <template x-for="page in Array.from({length: Math.min(5, totalPages)}, (_, i) => {
                                                    const start = Math.max(1, currentProductPage - 2);
                                                    const end = Math.min(totalPages, start + 4);
                                                    const adjustedStart = Math.max(1, end - 4);
                                                    return adjustedStart + i;
                                                }).filter(p => p <= totalPages)" :key="page">
                                                    <button @click="goToPage(page)"
                                                            :class="page === currentProductPage ? 'bg-cannabis-green text-white' : 'bg-white text-gray-700 hover:bg-gray-50'"
                                                            class="w-10 h-10 text-sm border border-gray-300 rounded-lg transition-colors">
                                                        <span x-text="page"></span>
                                                    </button>
                                                </template>
                                            </div>

                                            <!-- Next Button -->
                                            <button @click="nextPage()"
                                                    :disabled="currentProductPage === totalPages"
                                                    class="px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors">
                                                Next
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Enhanced Shopping Cart with Expandable functionality -->
                                <div class="bg-gray-50 rounded-lg p-6 sticky-cart layout-transition"
                                     :class="cartViewMode === 'wide' ? 'lg:col-span-3' : ''"
                                     style="z-index: 20;">
                                    <div class="flex items-center justify-between mb-4">
                                        <div class="flex items-center gap-2">
                                            <h3 class="text-lg font-medium text-gray-900">Shopping Cart</h3>
                                            <!-- New Sale Mode Indicator -->
                                            <div x-show="selectedCustomer || ageVerified" class="px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full flex items-center gap-1">
                                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                                </svg>
                                                <span x-text="selectedCustomer && selectedCustomer.isMedical ? 'Medical Sale' : 'Active Sale'"></span>
                                            </div>
                                        </div>
                                        <div class="flex items-center gap-2">
                                            <!-- Cart View Mode Toggle (always available) -->
                                            <div class="flex items-center gap-2">
                                                <span class="text-xs text-gray-500 hidden md:block">Cart View:</span>
                                                <div class="flex rounded-lg overflow-hidden border border-gray-300">
                                                    <button @click="cartViewMode = 'narrow'; saveSettings()"
                                                            :class="cartViewMode === 'narrow' ? 'bg-cannabis-green text-white' : 'bg-white text-gray-700 hover:bg-gray-50'"
                                                            class="cart-view-toggle px-3 py-1 text-xs font-medium border-r border-gray-300 transition-colors"
                                                            title="Narrow View - More products visible">
                                                        <div class="flex items-center gap-1">
                                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"/>
                                                            </svg>
                                                            <span class="hidden sm:inline">Narrow</span>
                                                        </div>
                                                    </button>
                                                    <button @click="cartViewMode = 'wide'; saveSettings()"
                                                            :class="cartViewMode === 'wide' ? 'bg-cannabis-green text-white' : 'bg-white text-gray-700 hover:bg-gray-50'"
                                                            class="cart-view-toggle px-3 py-1 text-xs font-medium transition-colors"
                                                            title="Wide View - Larger cart, single product column">
                                                        <div class="flex items-center gap-1">
                                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"/>
                                                            </svg>
                                                            <span class="hidden sm:inline">Wide</span>
                                                        </div>
                                                    </button>
                                                </div>
                                            </div>

                                        </div>
                                    </div>

                                    <!-- Cart View Mode Description -->
                                    <div x-show="cartViewMode === 'wide' || cartViewMode === 'narrow'" class="mb-3 text-xs text-gray-500">
                                        <span x-show="cartViewMode === 'narrow'">📱 Narrow view - See more products, compact cart</span>
                                        <span x-show="cartViewMode === 'wide'">📺 Wide view - Large cart, single product column</span>
                                    </div>

                                    <div class="cart-expand cart-expanded">
                                        <div class="space-y-3 mb-6">
                                            <template x-for="(item, index) in cart" :key="index">
                                                <div class="cart-item bg-white border border-gray-200 rounded-lg p-3">
                                                    <div class="flex justify-between items-center">
                                                        <div class="flex-1">
                                                            <h4 class="font-medium text-gray-900" x-text="item.name"></h4>
                                                            <p class="text-sm text-gray-500" x-text="`$${(item.price || 0).toFixed(2)} each`"></p>
                                                            <div x-show="item.isGLS" class="text-xs bg-yellow-100 text-yellow-800 px-1 rounded inline-block mt-1">Green Leaf Special</div>

                                                            <!-- Item Discount Display -->
                                                            <div x-show="item.discount && item.discount.amount > 0" class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded inline-block mt-1">
                                                                <span x-text="item.discount.type === 'percentage' ? `${item.discount.value}% off` : `$${(item.discount.value || 0).toFixed(2)} off`"></span>
                                                                <span x-show="item.discount.reason" x-text="`(${item.discount.reason})`"></span>
                                                            </div>
                                                        </div>
                                                        <div class="flex items-center space-x-2">
                                                            <!-- Item Discount Button -->
                                                            <button @click="openItemDiscountModal(index)" class="w-8 h-8 flex items-center justify-center text-blue-500 hover:bg-blue-50 rounded-full" title="Apply item discount">
                                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
                                                                </svg>
                                                            </button>

                                                            <button @click="updateQuantity(index, item.quantity - 1)" class="w-8 h-8 flex items-center justify-center bg-gray-100 rounded-full hover:bg-gray-200">
                                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"/>
                                                                </svg>
                                                            </button>
                                                            <span class="w-8 text-center font-medium" x-text="item.quantity"></span>
                                                            <button @click="updateQuantity(index, item.quantity + 1)" class="w-8 h-8 flex items-center justify-center bg-gray-100 rounded-full hover:bg-gray-200">
                                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                                                </svg>
                                                            </button>
                                                            <button @click="removeFromCart(index)" class="w-8 h-8 flex items-center justify-center text-red-500 hover:bg-red-50 rounded-full">
                                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                                                </svg>
                                                            </button>
                                                        </div>
                                                    </div>
                                                    <div class="mt-2 flex justify-between items-center">
                                                        <div class="text-right flex-1">
                                                            <!-- Original price (if discounted) -->
                                                            <div x-show="item.discount && item.discount.amount > 0" class="text-xs text-gray-400 line-through" x-text="`$${((item.price || 0) * (item.quantity || 1)).toFixed(2)}`"></div>
                                                            <!-- Final price -->
                                                            <span class="font-medium text-gray-900" x-text="`$${(getItemTotal(item) || 0).toFixed(2)}`"></span>
                                                            <div x-show="item.discount && item.discount.amount > 0" class="text-xs text-green-600" x-text="`Saved: $${((item.discount.amount || 0) * (item.quantity || 1)).toFixed(2)}`"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </template>
                                            
                                            <div x-show="cart.length === 0" class="text-gray-500 text-center py-8">
                                                Cart is empty
                                            </div>
                                        </div>
                                    </div>


                                    <!-- Oregon Sales Limit Tracker (Recreational Customers Only) -->
                                    <div x-show="shouldShowSalesLimitTracker() && cart.length > 0" class="mb-4 p-4 bg-orange-50 border border-orange-200 rounded-lg">
                                        <div class="flex items-center justify-between mb-3">
                                            <h4 class="font-medium text-orange-900 flex items-center">
                                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                                                </svg>
                                                Oregon Daily Limits
                                            </h4>
                                            <span class="text-xs text-orange-700 bg-orange-100 px-2 py-1 rounded">METRC Compliance</span>
                                        </div>

                                        <template x-for="(progress, category) in getSalesLimitProgress()" :key="category">
                                            <div x-show="progress.current > 0" class="mb-3 last:mb-0">
                                                <div class="flex items-center justify-between mb-1">
                                                    <span class="text-sm font-medium text-orange-800" x-text="progress.displayName"></span>
                                                    <span class="text-xs text-orange-700">
                                                        <span x-text="progress.current.toFixed(1)"></span>
                                                        <span>/</span>
                                                        <span x-text="progress.limit"></span>
                                                        <span x-text="progress.unit"></span>
                                                    </span>
                                                </div>
                                                <div class="w-full bg-orange-200 rounded-full h-2">
                                                    <div class="h-2 rounded-full transition-all duration-300"
                                                         :class="{
                                                             'bg-green-500': progress.percentage < 60,
                                                             'bg-yellow-500': progress.percentage >= 60 && progress.percentage < 80,
                                                             'bg-red-500': progress.percentage >= 80
                                                         }"
                                                         :style="`width: ${Math.min(progress.percentage, 100)}%`">
                                                    </div>
                                                </div>
                                                <div x-show="progress.isAtLimit" class="text-xs text-red-600 font-medium mt-1 flex items-center">
                                                    <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"/>
                                                    </svg>
                                                    Daily limit reached
                                                </div>
                                                <div x-show="progress.isNearLimit && !progress.isAtLimit" class="text-xs text-yellow-600 font-medium mt-1 flex items-center">
                                                    <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"/>
                                                    </svg>
                                                    Approaching daily limit
                                                </div>
                                            </div>
                                        </template>

                                        <div class="mt-3 text-xs text-orange-600">
                                            <div class="flex items-center">
                                                <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                                </svg>
                                                <span x-text="selectedCustomer && selectedCustomer.isMedical ? 'Oregon daily limits for medical patients (higher limits apply).' : 'Oregon daily limits for recreational customers. Medical patients have higher limits.'"></span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Customer Medical Status Display -->
                                    <div x-show="selectedCustomer && selectedCustomer.isMedical" class="mb-4 p-3 bg-green-50 border border-green-200 rounded-lg">
                                        <div class="flex items-center space-x-2">
                                            <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                            </svg>
                                            <div>
                                                <div class="font-medium text-green-800">Medical Patient/Caregiver</div>
                                                <div class="text-sm text-green-700">Customer data retained for compliance �� Tax exempt</div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Cart Discount Section -->
                                    <div x-show="cart.length > 0" class="mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                                        <div class="flex items-center justify-between mb-3">
                                            <h4 class="font-medium text-blue-900">Cart Discount</h4>
                                            <button @click="showDiscountModal = true" class="text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
                                                </svg>
                                                Apply Discount
                                            </button>
                                        </div>

                                        <!-- Applied Discounts Display -->
                                        <div x-show="cartDiscount.amount > 0" class="space-y-2">
                                            <div class="flex items-center justify-between text-sm">
                                                <span class="text-blue-700">
                                                    <span x-text="cartDiscount.type === 'percentage' ? `${cartDiscount.value || 0}% Off` : `$${(cartDiscount.value || 0).toFixed(2)} Off`"></span>
                                                    <span x-show="cartDiscount.reason" x-text="`(${cartDiscount.reason})`" class="text-blue-600"></span>
                                                </span>
                                                <div class="flex items-center gap-2">
                                                    <span class="text-green-600 font-medium" x-text="`-$${(cartDiscount.amount || 0).toFixed(2)}`"></span>
                                                    <button @click="removeCartDiscount()" class="text-red-500 hover:text-red-700">
                                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                                        </svg>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        <div x-show="cartDiscount.amount === 0" class="text-sm text-blue-600">
                                            No cart-wide discount applied
                                        </div>
                                    </div>

                                    <div class="border-t pt-4">
                                        <div class="flex justify-between text-sm text-gray-600 mb-2">
                                            <span>Subtotal:</span>
                                            <span x-text="`$${(subtotal || 0).toFixed(2)}`"></span>
                                        </div>

                                        <!-- Item Discounts -->
                                        <div x-show="getTotalItemDiscounts() > 0" class="flex justify-between text-sm text-green-600 mb-2">
                                            <span>Item Discounts:</span>
                                            <span x-text="`-$${(getTotalItemDiscounts() || 0).toFixed(2)}`"></span>
                                        </div>

                                        <!-- Cart Discount -->
                                        <div x-show="cartDiscount.amount > 0" class="flex justify-between text-sm text-green-600 mb-2">
                                            <span>Cart Discount:</span>
                                            <span x-text="`-$${(cartDiscount.amount || 0).toFixed(2)}`"></span>
                                        </div>

                                        <!-- Discounted Subtotal -->
                                        <div x-show="getTotalItemDiscounts() > 0 || cartDiscount.amount > 0" class="flex justify-between text-sm text-gray-700 mb-2 font-medium">
                                            <span>After Discounts:</span>
                                            <span x-text="`$${(getDiscountedSubtotal() || 0).toFixed(2)}`"></span>
                                        </div>

                                        <div class="flex justify-between text-sm text-gray-600 mb-2" x-show="shouldShowTax()">
                                            <span x-text="`Tax (${getEffectiveTaxRate()}%):`"></span>
                                            <span x-text="`$${(taxAmount || 0).toFixed(2)}`"></span>
                                        </div>
                                        <div class="flex justify-between text-lg font-bold text-gray-900 mb-4">
                                            <span>Total:</span>
                                            <span x-text="`$${(total || 0).toFixed(2)}`"></span>
                                        </div>

                                        <!-- Payment Buttons (Cash and Debit) -->
                                        <div class="space-y-2">
                                            <button @click="initiatePayment('cash')" :disabled="cart.length === 0" class="w-full bg-green-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                                                <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-3a2 2 0 00-2-2H9a2 2 0 00-2 2v3a2 2 0 002 2zm8-12V9a4 4 0 00-4-4H9a4 4 0 00-4 4v4h8V9z"/>
                                                </svg>
                                                Cash Payment
                                            </button>
                                            <button @click="initiatePayment('debit')" :disabled="cart.length === 0" class="w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                                                <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
                                                </svg>
                                                Debit Payment
                                            </button>
                                            <div x-show="cart.length === 0" class="text-center text-sm text-gray-500 mt-2">
                                                Cart is empty
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- New Sale Modal -->
            <div x-show="showNewSaleModal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition @keydown.escape="showNewSaleModal = false" @keydown.enter="selectCustomerType('recreational')" tabindex="0" x-init="showNewSaleModal && $el.focus()">
                <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-lg font-semibold text-gray-900">Start New Sale</h3>
                            <button @click="showNewSaleModal = false" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                        </div>
                        
                        <div class="space-y-4">
                            <p class="text-sm text-gray-600">Select customer type to begin transaction:</p>
                            
                            <!-- Recreational Customer -->
                            <button @click="selectCustomerType('recreational')" class="w-full p-4 border-2 border-gray-200 rounded-lg hover:border-blue-300 hover:bg-blue-50 transition-all text-left">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h4 class="font-medium text-gray-900">Recreational Customer</h4>
                                        <p class="text-sm text-gray-600">21+ years old �� Standard tax rates apply</p>
                                    </div>
                                    <svg class="w-6 h-6 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                                    </svg>
                                </div>
                            </button>

                            <!-- Medical/Caregiver Customer -->
                            <button @click="selectCustomerType('medical')" class="w-full p-4 border-2 border-gray-200 rounded-lg hover:border-green-300 hover:bg-green-50 transition-all text-left">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h4 class="font-medium text-gray-900">Medical Patient/Caregiver</h4>
                                        <p class="text-sm text-gray-600">18+ with valid medical card • Tax exempt</p>
                                    </div>
                                    <svg class="w-6 h-6 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recreational Customer Verification Modal -->
            <div x-show="showRecreationalModal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition @keydown.escape="cancelNewSale()" @keydown.enter="ageVerified ? confirmRecreationalSale() : null" x-init="showRecreationalModal && $el.focus()" tabindex="0">
                <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-lg font-semibold text-gray-900">Age Verification Required</h3>
                            <button @click="cancelNewSale()" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                        </div>
                        
                        <div class="space-y-4">
                            <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                                <div class="flex items-center space-x-3">
                                    <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"/>
                                    </svg>
                                    <div>
                                        <h4 class="font-medium text-red-900">Age Verification Required</h4>
                                        <p class="text-sm text-red-700">Customer must be 21+ years old for recreational cannabis</p>
                                    </div>
                                </div>
                            </div>

                            <div class="p-4 border-2 rounded-lg" :class="ageVerified ? 'border-green-200 bg-green-50' : 'border-red-200 bg-red-50'">
                                <label for="age-verification" class="flex items-center space-x-3 cursor-pointer">
                                    <input id="age-verification" name="age-verification" type="checkbox" x-model="ageVerified" class="h-5 w-5 text-cannabis-green rounded focus:ring-cannabis-green" aria-describedby="age-verification-desc">
                                    <div>
                                        <div class="font-medium text-gray-900">I have verified customer ID</div>
                                        <div class="text-sm text-gray-600">Customer is 21+ years old with valid government-issued ID</div>
                                    </div>
                                </label>
                            </div>
                        </div>
                        
                        <div class="mt-6 flex gap-3">
                            <button @click="cancelNewSale()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                                Cancel
                            </button>
                            <button @click="confirmRecreationalSale()" :disabled="!ageVerified" class="flex-1 px-4 py-2 bg-cannabis-green text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed">
                                Start Sale
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Medical Customer Information Modal -->
            <div x-show="showMedicalModal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition @keydown.escape="cancelNewSale()" @keydown.enter="(!medicalData.cardNumber || !medicalData.type || !medicalData.issueDate || !medicalData.expirationDate || (medicalData.type === 'caregiver' && !medicalData.patientCardNumber)) ? null : confirmMedicalSale()" x-init="showMedicalModal && $el.focus()" tabindex="0">
                <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[80vh] overflow-y-auto">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-lg font-semibold text-gray-900">Medical Patient Information</h3>
                            <button @click="cancelNewSale()" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                        </div>
                        
                        <div class="space-y-4">
                            <div>
                                <label for="medical-card-number" class="block text-sm font-medium text-gray-700 mb-2">Medical Card Number</label>
                                <input id="medical-card-number" name="medical-card-number" type="text" x-model="medicalData.cardNumber" placeholder="Enter medical card number" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-required="true">
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label for="medical-issue-date" class="block text-sm font-medium text-gray-700 mb-2">Issue Date *</label>
                                    <input id="medical-issue-date" name="medical-issue-date" type="date" x-model="medicalData.issueDate" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-required="true">
                                </div>
                                <div>
                                    <label for="medical-expiration-date" class="block text-sm font-medium text-gray-700 mb-2">Expiration Date *</label>
                                    <input id="medical-expiration-date" name="medical-expiration-date" type="date" x-model="medicalData.expirationDate" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-required="true">
                                </div>
                            </div>

                            <div class="space-y-3">
                                <div class="flex items-center space-x-3">
                                    <input type="radio" x-model="medicalData.type" value="medical" id="medical-patient" name="medical-type" class="h-4 w-4 text-cannabis-green focus:ring-cannabis-green">
                                    <label for="medical-patient" class="text-sm font-medium text-gray-700">Medical Patient</label>
                                </div>
                                <div class="flex items-center space-x-3">
                                    <input type="radio" x-model="medicalData.type" value="caregiver" id="caregiver" name="medical-type" class="h-4 w-4 text-cannabis-green focus:ring-cannabis-green">
                                    <label for="caregiver" class="text-sm font-medium text-gray-700">Caregiver</label>
                                </div>
                            </div>

                            <!-- Caregiver-specific field -->
                            <div x-show="medicalData.type === 'caregiver'" class="space-y-3">
                                <div>
                                    <label for="patient-card-number" class="block text-sm font-medium text-gray-700 mb-2">Patient Card Number *</label>
                                    <input id="patient-card-number" name="patient-card-number" type="text" x-model="medicalData.patientCardNumber" placeholder="Enter patient's medical card number" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-required="true">
                                    <p class="text-xs text-gray-500 mt-1">Required for caregiver verification</p>
                                </div>
                            </div>

                            <div class="p-4 border-2 rounded-lg" :class="medicalData.saveData ? 'border-green-200 bg-green-50' : 'border-gray-200'">
                                <label for="save-medical-data" class="flex items-center space-x-3 cursor-pointer">
                                    <input id="save-medical-data" name="save-medical-data" type="checkbox" x-model="medicalData.saveData" class="h-5 w-5 text-cannabis-green rounded focus:ring-cannabis-green" aria-describedby="save-data-desc">
                                    <div>
                                        <div class="font-medium text-gray-900">Save customer data</div>
                                        <div class="text-sm text-gray-600">Retain information for future transactions and compliance</div>
                                    </div>
                                </label>
                            </div>

                            <div x-show="medicalData.saveData" class="space-y-3">
                                <div>
                                    <label for="medical-customer-name" class="block text-sm font-medium text-gray-700 mb-2">Customer Name</label>
                                    <input id="medical-customer-name" name="medical-customer-name" type="text" x-model="medicalData.customerName" placeholder="Enter customer name" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-describedby="customer-name-help">
                                </div>
                                <div>
                                    <label for="medical-customer-email" class="block text-sm font-medium text-gray-700 mb-2">Email (Optional)</label>
                                    <input id="medical-customer-email" name="medical-customer-email" type="email" x-model="medicalData.email" placeholder="customer@example.com" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-describedby="customer-email-help">
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-6 flex gap-3">
                            <button @click="cancelNewSale()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                                Cancel
                            </button>
                            <button @click="confirmMedicalSale()" :disabled="!medicalData.cardNumber || !medicalData.type || !medicalData.issueDate || !medicalData.expirationDate || (medicalData.type === 'caregiver' && !medicalData.patientCardNumber)" class="flex-1 px-4 py-2 bg-cannabis-green text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed">
                                Start Sale
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Customer Selection Modal -->
            <div x-show="showCustomerModal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" @keydown.escape="showCustomerModal = false" x-init="showCustomerModal && $el.focus()" tabindex="0">
                <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900">Select Customer</h3>
                            <button @click="showCustomerModal = false" class="text-gray-400 hover:text-gray-600">×</button>
                        </div>
                        <div class="space-y-3">
                            <button @click="selectCustomer(null); showCustomerModal = false" class="w-full text-left p-3 border rounded-lg hover:bg-gray-50">
                                <div class="font-medium">Walk-in Customer</div>
                                <div class="text-sm text-gray-500">No customer account needed</div>
                            </button>
                            <template x-for="customer in customers" :key="customer.id">
                                <button @click="selectCustomer(customer); showCustomerModal = false" class="w-full text-left p-3 border rounded-lg hover:bg-gray-50" :class="customer.isMedical ? 'border-green-300 bg-green-50' : ''">
                                    <div class="font-medium" x-text="customer.name"></div>
                                    <div class="text-sm text-gray-500" x-text="customer.email"></div>
                                    <div x-show="customer.isMedical" class="text-xs text-green-700 font-medium">Medical Patient/Caregiver</div>
                                    <div x-show="customer.loyaltyPoints" class="text-xs text-blue-600" x-text="`${customer.loyaltyPoints} loyalty points`"></div>
                                </button>
                            </template>
                        </div>
                    </div>
                </div>
            </div>

            <!-- METRC Data Modal -->
            <div x-show="showMetrcModal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition @keydown.escape="showMetrcModal = false" x-init="showMetrcModal && $el.focus()" tabindex="0">
                <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-xl font-semibold text-gray-900">METRC Tracking Data</h3>
                            <button @click="showMetrcModal = false" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                        </div>
                        
                        <div x-show="selectedProduct" class="space-y-4">
                            <!-- Product Name -->
                            <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                                <h4 class="font-semibold text-purple-900" x-text="selectedProduct?.name"></h4>
                                <p class="text-sm text-purple-700" x-text="`METRC Tag: ${selectedProduct?.metrcTag || 'Not assigned'}`"></p>
                            </div>

                            <!-- Detailed METRC Information -->
                            <div class="grid grid-cols-2 gap-4">
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Amount Received</label>
                                        <p class="text-gray-900" x-text="selectedProduct?.metrcData?.amountReceived || '3.5g'"></p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Amount Left</label>
                                        <p class="text-gray-900" x-text="selectedProduct?.metrcData?.amountLeft || '3.5g'"></p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Package Date</label>
                                        <p class="text-gray-900" x-text="selectedProduct?.metrcData?.packageDate || '2024-01-15'"></p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Vendor</label>
                                        <p class="text-gray-900" x-text="selectedProduct?.vendor || 'Oregon Cannabis Co.'"></p>
                                    </div>
                                </div>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Grower</label>
                                        <p class="text-gray-900" x-text="selectedProduct?.metrcData?.grower || 'Green Valley Farms'"></p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Supplier</label>
                                        <p class="text-gray-900" x-text="selectedProduct?.supplier || 'Northwest Distribution'"></p>
                                    </div>
                                </div>
                            </div>

                            <!-- Cannabinoid Profile -->
                            <div x-show="selectedProduct && !['Paraphernalia', 'Accessories', 'Glass', 'Accessories/Paraphernalia'].includes(selectedProduct.category)" class="bg-green-50 p-4 rounded-lg border border-green-200">
                                <h5 class="font-medium text-green-900 mb-3">Cannabinoid Profile</h5>
                                <div class="grid grid-cols-3 gap-4 text-sm">
                                    <div>
                                        <span class="font-medium text-gray-700">THC:</span>
                                        <span x-text="getCannabinoidDisplay(selectedProduct, 'thc', selectedProduct?.thc)" class="text-gray-900"></span>
                                    </div>
                                    <div>
                                        <span class="font-medium text-gray-700">CBD:</span>
                                        <span x-text="getCannabinoidDisplay(selectedProduct, 'cbd', selectedProduct?.cbd)" class="text-gray-900"></span>
                                    </div>
                                    <div>
                                        <span class="font-medium text-gray-700">CBN:</span>
                                        <span x-text="getCannabinoidDisplay(selectedProduct, 'cbn', selectedProduct?.metrcData?.cbn)" class="text-gray-900"></span>
                                    </div>
                                    <div>
                                        <span class="font-medium text-gray-700">CBG:</span>
                                        <span x-text="getCannabinoidDisplay(selectedProduct, 'cbg', selectedProduct?.metrcData?.cbg)" class="text-gray-900"></span>
                                    </div>
                                    <div>
                                        <span class="font-medium text-gray-700">CBC:</span>
                                        <span x-text="getCannabinoidDisplay(selectedProduct, 'cbc', selectedProduct?.metrcData?.cbc)" class="text-gray-900"></span>
                                    </div>
                                    <div>
                                        <span class="font-medium text-gray-700">THCV:</span>
                                        <span x-text="getCannabinoidDisplay(selectedProduct, 'thcv', selectedProduct?.metrcData?.thcv)" class="text-gray-900"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-6 flex justify-end">
                            <button @click="showMetrcModal = false" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700">
                                Close
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Transfer Room Modal -->
            <div x-show="showTransferModal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition @keydown.escape="showTransferModal = false" @keydown.enter="(!transferData.destinationRoom || !transferData.quantity) ? null : executeTransfer()" x-init="showTransferModal && $el.focus()" tabindex="0">
                <div class="bg-white rounded-lg shadow-xl max-w-lg w-full mx-4">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900">Transfer Product to Room</h3>
                            <button @click="showTransferModal = false" class="text-gray-400 hover:text-gray-600">×</button>
                        </div>

                        <div x-show="selectedProduct" class="space-y-4">
                            <!-- Product Information -->
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <p class="text-sm text-gray-600">Product:</p>
                                <p class="font-medium text-gray-900" x-text="selectedProduct?.name"></p>
                                <div class="grid grid-cols-2 gap-4 mt-2 text-sm">
                                    <div>
                                        <span class="text-gray-500">Current Room:</span>
                                        <span class="font-medium ml-2" x-text="selectedProduct?.room || 'Unknown'"></span>
                                    </div>
                                    <div>
                                        <span class="text-gray-500">Stock:</span>
                                        <span class="font-medium ml-2" x-text="selectedProduct?.stock || 0"></span>
                                    </div>
                                    <div>
                                        <span class="text-gray-500">Status:</span>
                                        <span class="ml-2" :class="selectedProduct?.onSalesFloor ? 'text-green-600 font-medium' : 'text-red-600 font-medium'" x-text="selectedProduct?.onSalesFloor ? 'On Sales Floor' : 'Not on Sales Floor'"></span>
                                    </div>
                                    <div>
                                        <span class="text-gray-500">SKU:</span>
                                        <span class="font-medium ml-2" x-text="selectedProduct?.sku || 'N/A'"></span>
                                    </div>
                                </div>
                            </div>

                            <!-- Special notice for non-sales floor items -->
                            <div x-show="selectedProduct && !selectedProduct.onSalesFloor" class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                <div class="flex items-center">
                                    <svg class="w-5 h-5 text-yellow-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"/>
                                    </svg>
                                    <div>
                                        <p class="text-yellow-800 font-medium">Item Not Available for Sale</p>
                                        <p class="text-yellow-700 text-sm">This item is not currently on the sales floor. Moving it to a sales floor room will make it available for customers.</p>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <label for="transfer-quantity" class="block text-sm font-medium text-gray-700 mb-2">Quantity to Transfer</label>
                                <input id="transfer-quantity" name="transfer-quantity" type="number" x-model="transferData.quantity" :max="selectedProduct?.stock || 0" min="1" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-required="true" aria-describedby="quantity-help">
                                <p class="text-xs text-gray-500 mt-1">Maximum available: <span x-text="selectedProduct?.stock || 0"></span> units</p>
                            </div>

                            <div>
                                <label for="destination-room" class="block text-sm font-medium text-gray-700 mb-2">Select Destination Room</label>
                                <select id="destination-room" name="destination-room" x-model="transferData.destinationRoom" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-required="true" aria-describedby="room-help">
                                    <option value="">Select Room...</option>
                                    <optgroup label="Sales Floor Rooms">
                                        <option value="sales-floor-main">Main Sales Floor</option>
                                        <option value="sales-floor-premium">Premium Display</option>
                                        <option value="flower-room-1">Flower Room 1 (Sales Floor)</option>
                                    </optgroup>
                                    <optgroup label="Storage & Processing">
                                        <option value="flower-room-2">Flower Room 2 (Storage)</option>
                                        <option value="packaging-room">Packaging Room</option>
                                        <option value="storage-room">Storage Room</option>
                                        <option value="curing-room">Curing Room</option>
                                        <option value="vault">Secure Vault</option>
                                        <option value="quarantine">Quarantine Area</option>
                                    </optgroup>
                                </select>
                                <p class="text-xs text-gray-500 mt-1">
                                    <span class="text-green-600">Sales Floor Rooms:</span> Items will be available for customer purchase
                                </p>
                            </div>

                            <!-- Toggle Sales Floor Status -->
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <label for="sales-floor-status" class="flex items-center">
                                    <input id="sales-floor-status" name="sales-floor-status" type="checkbox" x-model="transferData.setSalesFloorStatus" class="h-4 w-4 text-cannabis-green rounded focus:ring-cannabis-green" aria-describedby="sales-floor-help">
                                    <div class="ml-3">
                                        <div class="font-medium text-blue-900">Update Sales Floor Status</div>
                                        <div class="text-sm text-blue-700">
                                            <span x-show="!selectedProduct?.onSalesFloor">Make this item available for sale after transfer</span>
                                            <span x-show="selectedProduct?.onSalesFloor">Remove this item from sales availability</span>
                                        </div>
                                    </div>
                                </label>
                            </div>

                            <div>
                                <label for="transfer-reason" class="block text-sm font-medium text-gray-700 mb-2">Reason for Transfer</label>
                                <textarea id="transfer-reason" name="transfer-reason" x-model="transferData.reason" placeholder="Enter reason for transfer (e.g., restocking, quality check, storage reorganization)..." class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green h-20" aria-describedby="reason-help"></textarea>
                            </div>
                        </div>

                        <div class="mt-6 flex gap-3">
                            <button @click="showTransferModal = false" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                                Cancel
                            </button>
                            <button @click="executeTransfer()" :disabled="!transferData.destinationRoom || !transferData.quantity" class="flex-1 px-4 py-2 bg-cannabis-green text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed">
                                <span>Transfer Product</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Edit Product Modal -->
            <div x-show="showEditModal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition @keydown.escape="showEditModal = false" @keydown.enter="!editData.name ? null : saveProductEdit()" x-init="showEditModal && $el.focus()" tabindex="0">
                <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[80vh] overflow-y-auto">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900">Edit Product</h3>
                            <button @click="showEditModal = false" class="text-gray-400 hover:text-gray-600">×</button>
                        </div>
                        
                        <div x-show="selectedProduct" class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label for="edit-product-name" class="block text-sm font-medium text-gray-700 mb-2">Product Name</label>
                                    <input id="edit-product-name" name="edit-product-name" type="text" x-model="editData.name" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-required="true">
                                </div>

                                <div>
                                    <label for="edit-stock" class="block text-sm font-medium text-gray-700 mb-2">Stock Quantity</label>
                                    <input id="edit-stock" name="edit-stock" type="number" x-model="editData.stock" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" min="0" aria-describedby="stock-help">
                                </div>

                                <div>
                                    <label for="edit-cost" class="block text-sm font-medium text-gray-700 mb-2">Cost ($)</label>
                                    <input id="edit-cost" name="edit-cost" type="number" step="0.01" x-model="editData.cost" placeholder="0.00" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" min="0" aria-describedby="cost-help">
                                </div>

                                <div>
                                    <label for="edit-price" class="block text-sm font-medium text-gray-700 mb-2">Sale Price ($)</label>
                                    <input id="edit-price" name="edit-price" type="number" step="0.01" x-model="editData.price" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" min="0" aria-describedby="price-help">
                                </div>

                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Upload Product Picture</label>
                                    <input id="product-image-upload" name="product-image-upload" type="file" accept="image/*" @change="handleFileUpload($event)" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-describedby="image-help">
                                    <p class="text-xs text-gray-500 mt-1">Supported formats: JPG, PNG, GIF (Max 5MB)</p>
                                </div>
                            </div>

                            <!-- Primary Cannabinoids -->
                            <div>
                                <h4 class="text-sm font-medium text-gray-700 mb-3 border-b border-gray-200 pb-2">Primary Cannabinoids</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label for="edit-thc" class="block text-sm font-medium text-gray-700 mb-2">THC %</label>
                                        <input id="edit-thc" name="edit-thc" type="number" step="0.1" min="0" max="100" x-model="editData.thc" placeholder="0.0" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-describedby="thc-help">
                                    </div>

                                    <div>
                                        <label for="edit-cbd" class="block text-sm font-medium text-gray-700 mb-2">CBD %</label>
                                        <input id="edit-cbd" name="edit-cbd" type="number" step="0.1" min="0" max="100" x-model="editData.cbd" placeholder="0.0" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-describedby="cbd-help">
                                    </div>
                                </div>
                            </div>

                            <!-- Additional Cannabinoids -->
                            <div>
                                <h4 class="text-sm font-medium text-gray-700 mb-3 border-b border-gray-200 pb-2">Additional Cannabinoids</h4>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div>
                                        <label for="edit-cbn" class="block text-sm font-medium text-gray-700 mb-2">CBN %</label>
                                        <input id="edit-cbn" name="edit-cbn" type="number" step="0.1" min="0" max="100" x-model="editData.cbn" placeholder="0.0" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-describedby="cbn-help">
                                        <p class="text-xs text-gray-500 mt-1">Cannabinol (sedating effects)</p>
                                    </div>
                                    <div>
                                        <label for="edit-cbg" class="block text-sm font-medium text-gray-700 mb-2">CBG %</label>
                                        <input id="edit-cbg" name="edit-cbg" type="number" step="0.1" min="0" max="100" x-model="editData.cbg" placeholder="0.0" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-describedby="cbg-help">
                                        <p class="text-xs text-gray-500 mt-1">Cannabigerol (potential benefits)</p>
                                    </div>
                                    <div>
                                        <label for="edit-cbc" class="block text-sm font-medium text-gray-700 mb-2">CBC %</label>
                                        <input id="edit-cbc" name="edit-cbc" type="number" step="0.1" min="0" max="100" x-model="editData.cbc" placeholder="0.0" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-describedby="cbc-help">
                                        <p class="text-xs text-gray-500 mt-1">Cannabichromene (wellness)</p>
                                    </div>
                                </div>
                                <p class="text-xs text-gray-500 mt-2 bg-blue-50 p-2 rounded">💡 Optional: Enter percentages for additional cannabinoids if available from lab testing results</p>
                            </div>

                            <!-- Price Tier Selection (Flower Products Only) -->
                            <div x-show="selectedProduct && selectedProduct.category === 'Flower'">
                                <h4 class="text-sm font-medium text-gray-700 mb-3 border-b border-gray-200 pb-2">Price Tier (Flower Products)</h4>
                                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                    <div>
                                        <label for="edit-price-tier" class="block text-sm font-medium text-gray-700 mb-2">Assign Price Tier</label>
                                        <select id="edit-price-tier" name="edit-price-tier" x-model="editData.priceTier" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" aria-describedby="price-tier-help">
                                            <option value="">No price tier (use individual pricing)</option>
                                            <template x-for="tier in priceTiers.filter(t => t.isActive)" :key="tier.id">
                                                <option :value="tier.id" x-text="(tier && tier.name) ? tier.name : 'Tier ' + (tier ? tier.id : '')"></option>
                                            </template>
                                        </select>
                                        <p class="text-xs text-gray-500 mt-1">Price tiers allow customers to choose different quantities with preset pricing</p>
                                    </div>

                                    <!-- Show current tier info if one is selected -->
                                    <div x-show="editData.priceTier" class="mt-3 p-3 bg-white border border-green-300 rounded">
                                        <p class="text-sm font-medium text-green-800 mb-2">Selected Tier Pricing:</p>
                                        <template x-for="tier in priceTiers.filter(t => t.id == editData.priceTier)" :key="tier.id">
                                            <div class="space-y-1">
                                                <template x-if="tier.weights">
                                                    <template x-for="weight in tier.weights" :key="weight.weight">
                                                        <div class="flex justify-between text-xs">
                                                            <span x-text="weight.weight + 'g:'"></span>
                                                            <span x-text="'$' + weight.price.toFixed(2)"></span>
                                                        </div>
                                                    </template>
                                                </template>
                                                <template x-if="!tier.weights && tier.weight">
                                                    <div class="flex justify-between text-xs">
                                                        <span x-text="tier.weight + 'g:'"></span>
                                                        <span x-text="'$' + tier.finalPrice.toFixed(2)"></span>
                                                    </div>
                                                </template>
                                            </div>
                                        </template>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-6 flex gap-3">
                            <button @click="showEditModal = false" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                                Cancel
                            </button>
                            <button @click="saveProductEdit()" class="flex-1 px-4 py-2 bg-cannabis-green text-white rounded-lg hover:bg-green-700">
                                Save Changes
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Print Dialog Modal -->
            <div x-show="showPrintModal" class="modal fixed inset-0 z-50 flex items-center justify-center print-dialog" x-transition @keydown.escape="showPrintModal = false" @keydown.enter="executePrint()" x-init="showPrintModal && $el.focus()" tabindex="0">
                <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-xl font-semibold text-gray-900">Advanced Print Options</h3>
                            <button @click="showPrintModal = false" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                        </div>

                        <div class="space-y-6">
                            <!-- Product Information -->
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-sm text-blue-600 font-medium">Printing:</p>
                                        <p class="font-semibold text-blue-900" x-text="printData.type === 'barcode' ? 'QR Code Label' : 'Exit Label'"></p>
                                        <p class="text-sm text-blue-700" x-text="printData.product?.name"></p>
                                    </div>
                                    <div class="text-right text-sm text-blue-600">
                                        <div x-text="`Category: ${printData.product?.category}`"></div>
                                        <div x-text="`SKU: ${printData.product?.sku || 'N/A'}`"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <!-- Basic Print Settings -->
                                <div class="space-y-4">
                                    <h4 class="font-medium text-gray-900 border-b border-gray-200 pb-2">Basic Settings</h4>

                                    <div>
                                        <label for="printer-select" class="block text-sm font-medium text-gray-700 mb-2">Select Printer</label>
                                        <select id="printer-select" name="printer-select" x-model="printData.selectedPrinter" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-describedby="printer-help">
                                            <option value="">Default Printer</option>
                                            <option value="zebra-1">Zebra Label Printer 1</option>
                                            <option value="zebra-2">Zebra Label Printer 2</option>
                                            <option value="dymo-1">Dymo LabelWriter</option>
                                            <option value="hp-office">HP Office Printer</option>
                                            <option value="thermal-1">Thermal Receipt Printer</option>
                                            <option value="desktop-1">Desktop Inkjet Printer</option>
                                        </select>
                                    </div>

                                    <div>
                                        <label for="print-copies" class="block text-sm font-medium text-gray-700 mb-2">Number of Copies</label>
                                        <input id="print-copies" name="print-copies" type="number" min="1" max="50" x-model="printData.copies" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-describedby="copies-help">
                                        <p class="text-xs text-gray-500 mt-1">Maximum 50 copies per print job</p>
                                    </div>

                                    <div>
                                        <label for="print-quality" class="block text-sm font-medium text-gray-700 mb-2">Print Quality</label>
                                        <select id="print-quality" name="print-quality" x-model="printData.quality" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-describedby="quality-help">
                                            <option value="draft">Draft (Fast, Low Ink)</option>
                                            <option value="normal" selected>Normal (Balanced)</option>
                                            <option value="high">High Quality (Best, Slow)</option>
                                            <option value="photo">Photo Quality (Highest)</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Advanced Customization -->
                                <div class="space-y-4">
                                    <h4 class="font-medium text-gray-900 border-b border-gray-200 pb-2">Size & Scaling</h4>

                                    <div>
                                        <label for="label-size" class="block text-sm font-medium text-gray-700 mb-2">Label Size</label>
                                        <select id="label-size" name="label-size" x-model="printData.labelSize" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-describedby="label-size-help">
                                            <option value="small">Small (2" x 1")</option>
                                            <option value="medium" selected>Medium (3" x 2")</option>
                                            <option value="large">Large (4" x 3")</option>
                                            <option value="extra-large">Extra Large (6" x 4")</option>
                                            <option value="custom">Custom Size</option>
                                        </select>
                                    </div>

                                    <!-- Custom Size Options -->
                                    <div x-show="printData.labelSize === 'custom'" class="grid grid-cols-2 gap-3">
                                        <div>
                                            <label for="custom-width" class="block text-xs font-medium text-gray-700 mb-1">Width (inches)</label>
                                            <input id="custom-width" name="custom-width" type="number" step="0.1" min="1" max="8" x-model="printData.customWidth" placeholder="3.0" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-cannabis-green">
                                        </div>
                                        <div>
                                            <label for="custom-height" class="block text-xs font-medium text-gray-700 mb-1">Height (inches)</label>
                                            <input id="custom-height" name="custom-height" type="number" step="0.1" min="1" max="8" x-model="printData.customHeight" placeholder="2.0" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-cannabis-green">
                                        </div>
                                    </div>

                                    <div>
                                        <label for="scale-percentage" class="block text-sm font-medium text-gray-700 mb-2">Scale Percentage</label>
                                        <div class="space-y-2">
                                            <input id="scale-percentage" name="scale-percentage" type="range" min="25" max="200" step="25" x-model="printData.scale" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                                            <div class="flex justify-between text-xs text-gray-500">
                                                <span>25%</span>
                                                <span>50%</span>
                                                <span>75%</span>
                                                <span>100%</span>
                                                <span>125%</span>
                                                <span>150%</span>
                                                <span>175%</span>
                                                <span>200%</span>
                                            </div>
                                            <div class="text-center">
                                                <span class="px-2 py-1 bg-cannabis-green text-white rounded text-sm font-medium" x-text="`${printData.scale}%`"></span>
                                            </div>
                                        </div>
                                    </div>

                                    <div>
                                        <label for="orientation" class="block text-sm font-medium text-gray-700 mb-2">Orientation</label>
                                        <div class="grid grid-cols-2 gap-3">
                                            <button @click="printData.orientation = 'portrait'" :class="printData.orientation === 'portrait' ? 'bg-cannabis-green text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'" class="p-3 rounded-lg border transition-colors">
                                                <svg class="w-6 h-6 mx-auto mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <rect x="6" y="2" width="12" height="20" rx="2" ry="2"/>
                                                </svg>
                                                <div class="text-xs">Portrait</div>
                                            </button>
                                            <button @click="printData.orientation = 'landscape'" :class="printData.orientation === 'landscape' ? 'bg-cannabis-green text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'" class="p-3 rounded-lg border transition-colors">
                                                <svg class="w-6 h-6 mx-auto mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <rect x="2" y="6" width="20" height="12" rx="2" ry="2"/>
                                                </svg>
                                                <div class="text-xs">Landscape</div>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Advanced Options -->
                            <div class="border-t border-gray-200 pt-4">
                                <h4 class="font-medium text-gray-900 mb-4">Additional Options</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <label class="flex items-center space-x-3">
                                        <input id="border-enabled" name="border-enabled" type="checkbox" x-model="printData.borderEnabled" class="h-4 w-4 text-cannabis-green focus:ring-cannabis-green border-gray-300 rounded" aria-describedby="border-help">
                                        <span class="text-sm text-gray-700">Add border around label</span>
                                    </label>
                                    <label class="flex items-center space-x-3">
                                        <input id="timestamp-enabled" name="timestamp-enabled" type="checkbox" x-model="printData.timestampEnabled" class="h-4 w-4 text-cannabis-green focus:ring-cannabis-green border-gray-300 rounded" aria-describedby="timestamp-help">
                                        <span class="text-sm text-gray-700">Include timestamp</span>
                                    </label>
                                    <label class="flex items-center space-x-3">
                                        <input id="company-logo-enabled" name="company-logo-enabled" type="checkbox" x-model="printData.companyLogoEnabled" class="h-4 w-4 text-cannabis-green focus:ring-cannabis-green border-gray-300 rounded" aria-describedby="logo-help">
                                        <span class="text-sm text-gray-700">Include company logo</span>
                                    </label>
                                    <label class="flex items-center space-x-3">
                                        <input id="batch-print" name="batch-print" type="checkbox" x-model="printData.batchPrint" class="h-4 w-4 text-cannabis-green focus:ring-cannabis-green border-gray-300 rounded" aria-describedby="batch-help">
                                        <span class="text-sm text-gray-700">Batch print mode</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Preview Summary -->
                            <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                                <h5 class="font-medium text-gray-900 mb-2">Print Summary</h5>
                                <div class="grid grid-cols-2 gap-4 text-sm">
                                    <div>
                                        <span class="text-gray-600">Label Size:</span>
                                        <span class="font-medium ml-2" x-text="getLabelSizeDisplay()"></span>
                                    </div>
                                    <div>
                                        <span class="text-gray-600">Scale:</span>
                                        <span class="font-medium ml-2" x-text="`${printData.scale}%`"></span>
                                    </div>
                                    <div>
                                        <span class="text-gray-600">Copies:</span>
                                        <span class="font-medium ml-2" x-text="printData.copies"></span>
                                    </div>
                                    <div>
                                        <span class="text-gray-600">Orientation:</span>
                                        <span class="font-medium ml-2 capitalize" x-text="printData.orientation"></span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="mt-6 flex gap-3">
                            <button @click="showPrintModal = false" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                                Cancel
                            </button>
                            <button @click="previewPrintSettings()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                Preview
                            </button>
                            <button @click="executePrint()" class="flex-1 px-4 py-2 bg-cannabis-green text-white rounded-lg hover:bg-green-700 transition-colors">
                                Print Now
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Print Settings Preview Modal -->
            <div x-show="showPrintSettingsPreviewModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" @keydown.escape="closePrintSettingsPreview()" @keydown.enter="printFromPreview()" tabindex="0" x-init="showPrintSettingsPreviewModal && $el.focus()">
                <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-xl font-semibold text-gray-900">Print Preview with Custom Settings</h3>
                            <button @click="closePrintSettingsPreview()" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                        </div>

                        <div x-show="printData.product" class="space-y-6">
                            <!-- Settings Summary -->
                            <div class="bg-gradient-to-r from-blue-50 to-green-50 border border-blue-200 rounded-lg p-4">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h4 class="font-semibold text-blue-900">Print Configuration</h4>
                                        <p class="text-sm text-blue-700" x-text="printData.product?.name"></p>
                                    </div>
                                    <div class="text-right text-sm">
                                        <div class="text-blue-600" x-text="`${printData.type === 'barcode' ? 'QR Code Label' : 'Exit Label'}`"></div>
                                        <div class="text-green-600" x-text="`${printData.copies} copies`"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Current Settings Display -->
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 bg-gray-50 p-4 rounded-lg">
                                <div class="text-center">
                                    <div class="font-medium text-gray-900" x-text="getLabelSizeDisplay()"></div>
                                    <div class="text-xs text-gray-600">Label Size</div>
                                </div>
                                <div class="text-center">
                                    <div class="font-medium text-gray-900" x-text="`${printData.scale}%`"></div>
                                    <div class="text-xs text-gray-600">Scale</div>
                                </div>
                                <div class="text-center">
                                    <div class="font-medium text-gray-900 capitalize" x-text="printData.orientation"></div>
                                    <div class="text-xs text-gray-600">Orientation</div>
                                </div>
                                <div class="text-center">
                                    <div class="font-medium text-gray-900 capitalize" x-text="printData.quality"></div>
                                    <div class="text-xs text-gray-600">Quality</div>
                                </div>
                            </div>

                            <!-- Preview Area with Applied Settings -->
                            <div class="border-2 border-dashed border-gray-300 p-8 bg-gray-50 rounded-lg">
                                <div class="text-center mb-6">
                                    <h5 class="text-lg font-medium text-gray-900 mb-2">Live Preview</h5>
                                    <p class="text-sm text-gray-600">Label shown with your custom settings applied</p>
                                    <div class="text-xs text-gray-500 mt-1">
                                        Scale: <span x-text="`${printData.scale}%`"></span> •
                                        Size: <span x-text="getLabelSizeDisplay()"></span> •
                                        Orientation: <span x-text="printData.orientation"></span>
                                    </div>
                                </div>

                                <!-- Preview Container with Dynamic Sizing -->
                                <div class="flex justify-center">
                                    <div class="preview-container"
                                         :style="`transform: scale(${printData.scale / 100}); ${printData.orientation === 'landscape' ? 'transform: scale(' + (printData.scale / 100) + ') rotate(90deg);' : ''}`">

                                        <!-- QR Code Label Preview -->
                                        <div x-show="printData.type === 'barcode'"
                                             class="bg-white border-2 border-gray-600 p-4 shadow-lg"
                                             :class="printData.borderEnabled ? 'border-4 border-black' : 'border-2 border-gray-600'"
                                             :style="getPreviewLabelStyle()" x-init="generateProductQRCode(printData.product)">
                                            <div class="text-center space-y-2">
                                                <!-- Company Header -->
                                                <div x-show="printData.companyLogoEnabled" class="text-xs font-bold text-green-700">🌿 CANNABEST DISPENSARY</div>
                                                <div class="text-xs font-bold" x-text="printData.companyLogoEnabled ? 'Licensed Cannabis Retailer' : 'CANNABEST DISPENSARY'"></div>
                                                <div x-show="!printData.companyLogoEnabled" class="text-xs">Licensed Cannabis Retailer</div>

                                                <!-- Product Info -->
                                                <div class="border-t border-gray-300 pt-2 space-y-1">
                                                    <div class="text-sm font-bold" x-text="printData.product?.name?.substring(0, 25) + (printData.product?.name?.length > 25 ? '...' : '')"></div>
                                                    <div class="text-xs" x-text="printData.product?.category"></div>
                                                    <div class="text-xs" x-text="`SKU: ${printData.product?.sku || 'N/A'}`"></div>
                                                </div>

                                                <!-- QR Code -->
                                                <div class="border-t border-gray-300 pt-2">
                                                    <div class="text-xs mb-1">QR CODE</div>
                                                    <div class="flex justify-center">
                                                        <canvas x-ref="previewQrCanvas" width="80" height="80" class="border border-gray-300"></canvas>
                                                    </div>
                                                    <div class="text-xs mt-1" x-text="`Product ID: ${printData.product?.id || 'N/A'}`"></div>
                                                </div>

                                                <!-- Bottom Info -->
                                                <div class="border-t border-gray-300 pt-2 text-xs">
                                                    <div x-text="`Price: $${(printData.product?.price || 0).toFixed(2)}`"></div>
                                                    <div x-text="`Stock: ${printData.product?.stock || 0}`"></div>
                                                    <div x-show="printData.timestampEnabled" x-text="`Printed: ${new Date().toLocaleDateString()}`"></div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Exit Label Preview -->
                                        <div x-show="printData.type === 'exitLabel'"
                                             class="bg-white border-2 border-black p-4 shadow-lg"
                                             :class="printData.borderEnabled ? 'border-4 border-black' : 'border-2 border-black'"
                                             :style="getPreviewLabelStyle()">
                                            <div class="space-y-2 text-xs">
                                                <!-- Header with Logo option -->
                                                <div class="text-center border-b border-gray-400 pb-2">
                                                    <div x-show="printData.companyLogoEnabled" class="font-bold text-green-700">🌿 CANNABEST DISPENSARY</div>
                                                    <div class="font-bold" x-text="printData.companyLogoEnabled ? 'Oregon OLCC Exit Label' : 'CANNABEST DISPENSARY'"></div>
                                                    <div x-show="!printData.companyLogoEnabled" class="text-xs">Oregon OLCC Exit Label</div>
                                                </div>

                                                <!-- Customer Info -->
                                                <div class="border-b border-gray-400 pb-2">
                                                    <div class="font-bold">CUSTOMER:</div>
                                                    <div x-text="selectedCustomer ? selectedCustomer.name : 'Walk-in Customer'"></div>
                                                    <div x-text="selectedCustomer && selectedCustomer.isMedical ? 'Medical Patient/Caregiver' : 'Recreational Customer'"></div>
                                                </div>

                                                <!-- Product Info -->
                                                <div class="border-b border-gray-400 pb-2">
                                                    <div class="font-bold">PRODUCT:</div>
                                                    <div x-text="printData.product?.name"></div>
                                                    <div x-text="`Category: ${printData.product?.category}`"></div>
                                                    <div x-text="`Weight: ${printData.product?.weight || '1g'}`"></div>
                                                </div>

                                                <!-- Cannabinoid Info -->
                                                <div class="border-b border-gray-400 pb-2" x-show="printData.product && !['Paraphernalia', 'Accessories', 'Glass'].includes(printData.product.category)">
                                                    <div class="font-bold">CANNABINOIDS:</div>
                                                    <div x-text="`THC: ${printData.product?.thc || 0}%`"></div>
                                                    <div x-text="`CBD: ${printData.product?.cbd || 0}%`"></div>
                                                </div>

                                                <!-- METRC Info -->
                                                <div class="border-b border-gray-400 pb-2">
                                                    <div class="font-bold">METRC TAG:</div>
                                                    <div x-text="printData.product?.metrcTag || '1A4060300001234000000001'"></div>
                                                </div>

                                                <!-- Date and Price -->
                                                <div class="text-center">
                                                    <div x-show="printData.timestampEnabled" x-text="`Date: ${new Date().toLocaleDateString()}`"></div>
                                                    <div x-show="printData.timestampEnabled" x-text="`Time: ${new Date().toLocaleTimeString()}`"></div>
                                                    <div x-text="`Price: $${(printData.product?.price || 0).toFixed(2)}`"></div>
                                                </div>

                                                <!-- QR Code for Exit Label -->
                                                <div class="text-center">
                                                    <div class="mx-auto bg-black" style="width: 60px; height: 60px; background-image: radial-gradient(circle, white 1px, black 1px); background-size: 3px 3px;"></div>
                                                    <div class="text-xs mt-1">QR Code for Verification</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Additional Options Summary -->
                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                <h5 class="font-medium text-yellow-900 mb-2">Additional Options Applied</h5>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-2 text-sm">
                                    <div class="flex items-center">
                                        <span class="w-3 h-3 rounded-full mr-2" :class="printData.borderEnabled ? 'bg-green-500' : 'bg-gray-300'"></span>
                                        <span>Border</span>
                                    </div>
                                    <div class="flex items-center">
                                        <span class="w-3 h-3 rounded-full mr-2" :class="printData.timestampEnabled ? 'bg-green-500' : 'bg-gray-300'"></span>
                                        <span>Timestamp</span>
                                    </div>
                                    <div class="flex items-center">
                                        <span class="w-3 h-3 rounded-full mr-2" :class="printData.companyLogoEnabled ? 'bg-green-500' : 'bg-gray-300'"></span>
                                        <span>Company Logo</span>
                                    </div>
                                    <div class="flex items-center">
                                        <span class="w-3 h-3 rounded-full mr-2" :class="printData.batchPrint ? 'bg-green-500' : 'bg-gray-300'"></span>
                                        <span>Batch Mode</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="mt-8 flex gap-4">
                            <button @click="backToOptions()" class="flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium">
                                ← Back to Options
                            </button>
                            <button @click="printFromPreview()" class="flex-1 px-6 py-3 bg-cannabis-green text-white rounded-lg hover:bg-green-700 transition-colors font-medium">
                                Print Now
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cash Payment Modal -->
            <div x-show="showCashModal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition @keydown.escape="showCashModal = false" @keydown.enter="(cashPayment.changeDue < 0 || !cashPayment.employeePin) ? null : completeCashPayment()" tabindex="0" x-init="showCashModal && $el.focus()">
                <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900">Cash Payment</h3>
                            <button @click="showCashModal = false" class="text-gray-400 hover:text-gray-600">×</button>
                        </div>
                        
                        <div class="space-y-4">
                            <div class="bg-green-50 p-4 rounded-lg">
                                <div class="flex justify-between text-lg font-semibold">
                                    <span>Total Due:</span>
                                    <span x-text="`$${total.toFixed(2)}`"></span>
                                </div>
                            </div>
                            
                            <div>
                                <label for="cash-amount-given" class="block text-sm font-medium text-gray-700 mb-2">Amount Given</label>
                                <input id="cash-amount-given" name="cash-amount-given" type="number" step="0.01" x-model="cashPayment.amountGiven" @input="calculateChange()" placeholder="Enter amount received from customer" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green text-lg" min="0" aria-required="true" aria-describedby="cash-amount-help">
                            </div>
                            
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <div class="flex justify-between text-lg font-semibold">
                                    <span>Change Due:</span>
                                    <span x-text="`$${cashPayment.changeDue.toFixed(2)}`" :class="cashPayment.changeDue < 0 ? 'text-red-600' : 'text-green-600'"></span>
                                </div>
                            </div>
                            
                            <div>
                                <label for="cash-employee-pin" class="block text-sm font-medium text-gray-700 mb-2">Employee PIN <span class="text-red-500">*Required</span></label>
                                <input id="cash-employee-pin" name="cash-employee-pin" type="password" x-model="cashPayment.employeePin" placeholder="Enter your 4-digit PIN" maxlength="4" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" required aria-required="true" aria-describedby="pin-help">
                                <p class="text-xs text-gray-500 mt-1">PIN required for transaction authorization</p>
                            </div>
                        </div>
                        
                        <div class="mt-6 flex gap-3">
                            <button @click="showCashModal = false" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                                Cancel
                            </button>
                            <button @click="completeCashPayment()" :disabled="cashPayment.changeDue < 0 || !cashPayment.employeePin" class="flex-1 px-4 py-2 bg-cannabis-green text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed">
                                Complete Sale
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Debit Payment Modal -->
            <div x-show="showDebitModal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition @keydown.escape="showDebitModal = false" @keydown.enter="(debitPayment.changeDue < 0 || !debitPayment.employeePin || !debitPayment.lastFour) ? null : completeDebitPayment()" tabindex="0" x-init="showDebitModal && $el.focus()">
                <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900">Debit Payment</h3>
                            <button @click="showDebitModal = false" class="text-gray-400 hover:text-gray-600">×</button>
                        </div>
                        
                        <div class="space-y-4">
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <div class="flex justify-between text-lg font-semibold">
                                    <span>Total Due:</span>
                                    <span x-text="`$${total.toFixed(2)}`"></span>
                                </div>
                            </div>
                            
                            <div>
                                <label for="debit-amount" class="block text-sm font-medium text-gray-700 mb-2">Amount to Charge</label>
                                <input id="debit-amount" name="debit-amount" type="number" step="0.01" x-model="debitPayment.amount" @input="calculateDebitChange()" placeholder="Enter amount to charge" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green text-lg" min="0" aria-required="true" aria-describedby="debit-amount-help">
                            </div>
                            
                            <div class="bg-green-50 p-4 rounded-lg">
                                <div class="flex justify-between text-lg font-semibold">
                                    <span>Change Due:</span>
                                    <span x-text="`$${debitPayment.changeDue.toFixed(2)}`" :class="debitPayment.changeDue < 0 ? 'text-red-600' : 'text-green-600'"></span>
                                </div>
                            </div>
                            
                            <div>
                                <label for="card-last-four" class="block text-sm font-medium text-gray-700 mb-2">Last 4 Digits of Card <span class="text-red-500">*Required</span></label>
                                <input id="card-last-four" name="card-last-four" type="text" maxlength="4" x-model="debitPayment.lastFour" placeholder="****" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" required aria-required="true" aria-describedby="card-help" pattern="[0-9]{4}">
                                <p class="text-xs text-gray-500 mt-1">Required for debit card transactions</p>
                            </div>
                            
                            <div>
                                <label for="debit-employee-pin" class="block text-sm font-medium text-gray-700 mb-2">Employee PIN <span class="text-red-500">*Required</span></label>
                                <input id="debit-employee-pin" name="debit-employee-pin" type="password" x-model="debitPayment.employeePin" placeholder="Enter your 4-digit PIN" maxlength="4" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" required aria-required="true" aria-describedby="debit-pin-help">
                                <p class="text-xs text-gray-500 mt-1">PIN required for transaction authorization</p>
                            </div>
                        </div>
                        
                        <div class="mt-6 flex gap-3">
                            <button @click="showDebitModal = false" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                                Cancel
                            </button>
                            <button @click="completeDebitPayment()" :disabled="debitPayment.changeDue < 0 || !debitPayment.employeePin || !debitPayment.lastFour" class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed">
                                Process Payment
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cart Discount Modal -->
            <div x-show="showDiscountModal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition @keydown.escape="showDiscountModal = false" @keydown.enter="(!discountForm.value || discountForm.calculatedAmount <= 0 || !discountForm.reason || discountForm.reason.trim() === '') ? null : applyCartDiscount()" x-init="showDiscountModal && $el.focus()" tabindex="0">
                <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900">Apply Cart Discount</h3>
                            <button @click="showDiscountModal = false" class="text-gray-400 hover:text-gray-600">×</button>
                        </div>

                        <div class="space-y-4">
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <div class="flex justify-between text-lg font-semibold">
                                    <span>Cart Subtotal:</span>
                                    <span x-text="`$${(subtotal - getTotalItemDiscounts()).toFixed(2)}`"></span>
                                </div>
                            </div>

                            <div>
                                <label for="discount-type" class="block text-sm font-medium text-gray-700 mb-2">Discount Type</label>
                                <select id="discount-type" name="discount-type" x-model="discountForm.type" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" aria-describedby="discount-type-help">
                                    <option value="percentage">Percentage (%)</option>
                                    <option value="fixed">Fixed Amount ($)</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <span x-text="discountForm.type === 'percentage' ? 'Discount Percentage' : 'Discount Amount'"></span>
                                </label>
                                <input id="discount-value" name="discount-value" type="number" step="0.01" min="0" aria-required="true" aria-describedby="discount-value-help"
                                       :max="discountForm.type === 'percentage' ? 100 : (subtotal - getTotalItemDiscounts())"
                                       x-model="discountForm.value"
                                       @input="calculateCartDiscount()"
                                       class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green">
                            </div>

                            <div>
                                <label for="discount-reason" class="block text-sm font-medium text-gray-700 mb-2">Reason <span class="text-red-500">*Required</span></label>
                                <input id="discount-reason" name="discount-reason" type="text" x-model="discountForm.reason" placeholder="e.g., Senior discount, Store promotion" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" required aria-required="true" aria-describedby="discount-reason-help">
                                <p class="text-xs text-gray-500 mt-1">All discounts must include a reason for audit purposes</p>
                            </div>

                            <div x-show="discountForm.calculatedAmount > 0" class="bg-green-50 p-4 rounded-lg">
                                <div class="flex justify-between text-lg font-semibold text-green-700">
                                    <span>Discount Amount:</span>
                                    <span x-text="`$${discountForm.calculatedAmount.toFixed(2)}`"></span>
                                </div>
                                <div class="flex justify-between text-sm text-green-600 mt-1">
                                    <span>New Cart Total:</span>
                                    <span x-text="`$${((subtotal - getTotalItemDiscounts()) - discountForm.calculatedAmount).toFixed(2)}`"></span>
                                </div>
                            </div>
                        </div>

                        <div class="mt-6 flex gap-3">
                            <button @click="showDiscountModal = false" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                                Cancel
                            </button>
                            <button @click="applyCartDiscount()" :disabled="!discountForm.value || discountForm.calculatedAmount <= 0 || !discountForm.reason || discountForm.reason.trim() === ''" class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed">
                                Apply Discount
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Item Discount Modal -->
            <div x-show="showItemDiscountModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" @keydown.escape="showItemDiscountModal = false" @keydown.enter="(!itemDiscountForm.value || itemDiscountForm.calculatedAmount <= 0 || !itemDiscountForm.reason || itemDiscountForm.reason.trim() === '') ? null : applyItemDiscount()" x-init="showItemDiscountModal && $el.focus()" tabindex="0">
                <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900">Apply Item Discount</h3>
                            <button @click="showItemDiscountModal = false" class="text-gray-400 hover:text-gray-600">��</button>
                        </div>

                        <div class="space-y-4" x-show="selectedCartItem">
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <div class="font-medium" x-text="selectedCartItem?.name"></div>
                                <div class="text-sm text-gray-600">
                                    <span x-text="`$${selectedCartItem?.price.toFixed(2)} �� ${selectedCartItem?.quantity} = $${(selectedCartItem?.price * selectedCartItem?.quantity).toFixed(2)}`"></span>
                                </div>
                            </div>

                            <div>
                                <label for="item-discount-type" class="block text-sm font-medium text-gray-700 mb-2">Discount Type</label>
                                <select id="item-discount-type" name="item-discount-type" x-model="itemDiscountForm.type" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green">
                                    <option value="percentage">Percentage (%)</option>
                                    <option value="fixed">Fixed Amount ($)</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <span x-text="itemDiscountForm.type === 'percentage' ? 'Discount Percentage' : 'Discount Amount (per item)'"></span>
                                </label>
                                <input type="number" step="0.01" min="0"
                                       :max="itemDiscountForm.type === 'percentage' ? 100 : selectedCartItem?.price"
                                       x-model="itemDiscountForm.value"
                                       @input="calculateItemDiscount()"
                                       class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green">
                            </div>

                            <div>
                                <label for="item-discount-reason" class="block text-sm font-medium text-gray-700 mb-2">Reason <span class="text-red-500">*Required</span></label>
                                <input id="item-discount-reason" name="item-discount-reason" type="text" x-model="itemDiscountForm.reason" placeholder="e.g., Damaged packaging, Loyalty discount" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cannabis-green" required>
                                <p class="text-xs text-gray-500 mt-1">All discounts must include a reason for audit purposes</p>
                            </div>

                            <div x-show="itemDiscountForm.calculatedAmount > 0" class="bg-green-50 p-4 rounded-lg">
                                <div class="flex justify-between text-lg font-semibold text-green-700">
                                    <span>Discount per Item:</span>
                                    <span x-text="`$${itemDiscountForm.calculatedAmount.toFixed(2)}`"></span>
                                </div>
                                <div class="flex justify-between text-sm text-green-600 mt-1">
                                    <span>Total Item Discount:</span>
                                    <span x-text="`$${(itemDiscountForm.calculatedAmount * selectedCartItem?.quantity).toFixed(2)}`"></span>
                                </div>
                                <div class="flex justify-between text-sm text-green-600 mt-1">
                                    <span>New Item Total:</span>
                                    <span x-text="`$${((selectedCartItem?.price - itemDiscountForm.calculatedAmount) * selectedCartItem?.quantity).toFixed(2)}`"></span>
                                </div>
                            </div>
                        </div>

                        <div class="mt-6 flex gap-3">
                            <button @click="showItemDiscountModal = false" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                                Cancel
                            </button>
                            <button @click="applyItemDiscount()" :disabled="!itemDiscountForm.value || itemDiscountForm.calculatedAmount <= 0 || !itemDiscountForm.reason || itemDiscountForm.reason.trim() === ''" class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed">
                                Apply Discount
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Enroll Customer Modal -->
            <div x-show="showEnrollCustomerModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" @keydown.escape="showEnrollCustomerModal = false" x-init="showEnrollCustomerModal && $el.focus()" tabindex="0">
                <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-lg font-semibold text-gray-900">Enroll Customer in Loyalty Program</h3>
                            <button @click="showEnrollCustomerModal = false" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                        </div>

                        <form @submit.prevent="enrollCustomerInLoyalty()">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Select Customer *</label>
                                    <select x-model="enrollForm.customerId" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                                        <option value="">Choose a customer...</option>
                                        <template x-for="customer in customers.filter(c => !c.loyaltyPoints)" :key="customer.id">
                                            <option :value="customer.id" x-text="customer.name + ' (' + customer.email + ')'"></option>
                                        </template>
                                    </select>
                                    <p class="text-xs text-gray-500 mt-1">Only customers not yet enrolled are shown</p>
                                </div>

                                <div>
                                    <label for="loyalty-tier" class="block text-sm font-medium text-gray-700 mb-2">Starting Loyalty Tier</label>
                                    <select id="loyalty-tier" name="loyalty-tier" x-model="enrollForm.tier" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                                        <option value="Bronze">Bronze (Default)</option>
                                        <option value="Silver">Silver</option>
                                        <option value="Gold">Gold</option>
                                        <option value="Platinum">Platinum</option>
                                    </select>
                                </div>

                                <div>
                                    <label for="starting-points" class="block text-sm font-medium text-gray-700 mb-2">Starting Points</label>
                                    <input id="starting-points" name="starting-points" type="number" x-model="enrollForm.startingPoints" min="0" placeholder="0" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                                    <p class="text-xs text-gray-500 mt-1">Optional welcome bonus points</p>
                                </div>

                                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                    <h4 class="font-medium text-yellow-800 mb-2">Loyalty Program Benefits</h4>
                                    <ul class="text-sm text-yellow-700 space-y-1">
                                        <li>• Earn 1 point per $1 spent</li>
                                        <li>• Redeem 100 points = $5 discount</li>
                                        <li>��� Birthday bonuses and special offers</li>
                                        <li>• Tier upgrades based on annual spending</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="mt-6 flex gap-3">
                                <button type="button" @click="showEnrollCustomerModal = false" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                                    Cancel
                                </button>
                                <button type="submit" :disabled="!enrollForm.customerId" class="flex-1 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:opacity-50 disabled:cursor-not-allowed">
                                    Enroll Customer
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Adjust Customer Points Modal -->
            <div x-show="showAdjustPointsModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" @keydown.escape="showAdjustPointsModal = false" x-init="showAdjustPointsModal && $el.focus()" tabindex="0">
                <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-lg font-semibold text-gray-900">Adjust Customer Points</h3>
                            <button @click="showAdjustPointsModal = false" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                        </div>

                        <div x-show="selectedLoyaltyCustomer" class="space-y-4">
                            <!-- Customer Info -->
                            <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                                <h4 class="font-medium text-gray-900" x-text="selectedLoyaltyCustomer?.name"></h4>
                                <p class="text-sm text-gray-600" x-text="selectedLoyaltyCustomer?.email"></p>
                                <div class="mt-2 flex items-center justify-between">
                                    <span class="text-sm text-gray-600">Current Points:</span>
                                    <span class="font-semibold text-yellow-600" x-text="selectedLoyaltyCustomer?.points?.toLocaleString() || '0'"></span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm text-gray-600">Tier:</span>
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium" :class="getLoyaltyTierClass(selectedLoyaltyCustomer?.tier)" x-text="selectedLoyaltyCustomer?.tier"></span>
                                </div>
                            </div>

                            <form @submit.prevent="savePointsAdjustment()">
                                <div class="space-y-4">
                                    <div>
                                        <label for="points-adjustment-type" class="block text-sm font-medium text-gray-700 mb-2">Adjustment Type</label>
                                        <select id="points-adjustment-type" name="points-adjustment-type" x-model="pointsForm.type" @change="pointsForm.amount = ''" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                                            <option value="add">Add Points</option>
                                            <option value="subtract">Subtract Points</option>
                                            <option value="set">Set Total Points</option>
                                        </select>
                                    </div>

                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">
                                            <span x-text="pointsForm.type === 'set' ? 'New Point Total' : 'Points Amount'"></span> *
                                        </label>
                                        <input id="points-amount" name="points-amount" type="number" x-model="pointsForm.amount" :min="pointsForm.type === 'subtract' ? 0 : 0" :max="pointsForm.type === 'subtract' ? selectedLoyaltyCustomer?.points : ''" required placeholder="Enter amount" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                                        <p x-show="pointsForm.type === 'subtract'" class="text-xs text-gray-500 mt-1" x-text="'Maximum: ' + (selectedLoyaltyCustomer?.points?.toLocaleString() || '0') + ' points'"></p>
                                    </div>

                                    <div>
                                        <label for="points-reason" class="block text-sm font-medium text-gray-700 mb-2">Reason for Adjustment *</label>
                                        <select id="points-reason" name="points-reason" x-model="pointsForm.reason" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                                            <option value="">Select reason...</option>
                                            <option value="manual-bonus">Manual Bonus Award</option>
                                            <option value="birthday-bonus">Birthday Bonus</option>
                                            <option value="complaint-resolution">Complaint Resolution</option>
                                            <option value="store-promotion">Store Promotion</option>
                                            <option value="system-error">System Error Correction</option>
                                            <option value="manager-discretion">Manager Discretion</option>
                                            <option value="loyalty-challenge">Loyalty Challenge Reward</option>
                                            <option value="referral-bonus">Referral Bonus</option>
                                            <option value="other">Other</option>
                                        </select>
                                    </div>

                                    <div x-show="pointsForm.reason === 'other'">
                                        <label for="custom-reason" class="block text-sm font-medium text-gray-700 mb-2">Please Specify *</label>
                                        <input id="custom-reason" name="custom-reason" type="text" x-model="pointsForm.customReason" :required="pointsForm.reason === 'other'" placeholder="Describe the reason" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                                    </div>

                                    <!-- Preview -->
                                    <div x-show="pointsForm.amount" class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                        <h4 class="font-medium text-blue-800 mb-2">Preview</h4>
                                        <div class="text-sm text-blue-700">
                                            <div class="flex justify-between">
                                                <span>Current Points:</span>
                                                <span x-text="selectedLoyaltyCustomer?.points?.toLocaleString() || '0'"></span>
                                            </div>
                                            <div class="flex justify-between" x-show="pointsForm.type !== 'set'">
                                                <span x-text="pointsForm.type === 'add' ? 'Adding:' : 'Subtracting:'"></span>
                                                <span x-text="pointsForm.type === 'add' ? '+' + (pointsForm.amount || 0) : '-' + (pointsForm.amount || 0)"></span>
                                            </div>
                                            <div class="flex justify-between font-medium border-t border-blue-300 pt-2 mt-2">
                                                <span>New Total:</span>
                                                <span x-text="calculateNewPointsTotal().toLocaleString()"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-6 flex gap-3">
                                    <button type="button" @click="showAdjustPointsModal = false" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                                        Cancel
                                    </button>
                                    <button type="submit" :disabled="!pointsForm.amount || !pointsForm.reason" class="flex-1 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:opacity-50 disabled:cursor-not-allowed">
                                        Apply Adjustment
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Aging Analysis Details Modal -->
            <div x-show="showAgingModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" @keydown.escape="showAgingModal = false" x-init="showAgingModal && $el.focus()" tabindex="0">
                <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[80vh] overflow-y-auto">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-xl font-semibold text-gray-900" x-text="'Inventory Aging: ' + (agingModalData.title || '')"></h3>
                            <button @click="showAgingModal = false" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                        </div>

                        <div x-show="agingModalData.items && agingModalData.items.length > 0" class="space-y-4">
                            <!-- Summary -->
                            <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 text-center">
                                    <div>
                                        <p class="text-sm text-gray-600">Total Items</p>
                                        <p class="text-2xl font-bold text-gray-900" x-text="agingModalData.items.length"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-600">Total Cost Value</p>
                                        <p class="text-2xl font-bold text-blue-600" x-text="'$' + agingModalData.totalCost.toFixed(2)"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-600">Total Retail Value</p>
                                        <p class="text-2xl font-bold text-green-600" x-text="'$' + agingModalData.totalRetail.toFixed(2)"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-600">Potential Profit</p>
                                        <p class="text-2xl font-bold text-purple-600" x-text="'$' + agingModalData.totalProfit.toFixed(2)"></p>
                                    </div>
                                </div>
                            </div>

                            <!-- Items Table -->
                            <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                <div class="overflow-x-auto">
                                    <table class="w-full text-sm">
                                        <thead class="bg-gray-100">
                                            <tr>
                                                <th class="px-4 py-3 text-left font-medium text-gray-700">Product</th>
                                                <th class="px-4 py-3 text-left font-medium text-gray-700">Category</th>
                                                <th class="px-4 py-3 text-right font-medium text-gray-700">Days Old</th>
                                                <th class="px-4 py-3 text-right font-medium text-gray-700">Stock</th>
                                                <th class="px-4 py-3 text-right font-medium text-gray-700">Cost/Unit</th>
                                                <th class="px-4 py-3 text-right font-medium text-gray-700">Retail/Unit</th>
                                                <th class="px-4 py-3 text-right font-medium text-gray-700">Total Cost</th>
                                                <th class="px-4 py-3 text-right font-medium text-gray-700">Total Retail</th>
                                                <th class="px-4 py-3 text-left font-medium text-gray-700">Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-gray-200">
                                            <template x-for="item in agingModalData.items" :key="item.id">
                                                <tr class="hover:bg-gray-50">
                                                    <td class="px-4 py-3">
                                                        <div>
                                                            <p class="font-medium text-gray-900" x-text="item.name"></p>
                                                            <p class="text-xs text-gray-500" x-text="'SKU: ' + (item.sku || 'N/A')"></p>
                                                            <p class="text-xs text-gray-500" x-text="'Room: ' + (item.room || 'Main')"></p>
                                                        </div>
                                                    </td>
                                                    <td class="px-4 py-3">
                                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800" x-text="item.category"></span>
                                                    </td>
                                                    <td class="px-4 py-3 text-right">
                                                        <span class="font-medium" x-text="item.daysOld"></span>
                                                        <p class="text-xs text-gray-500" x-text="'Added: ' + new Date(item.dateAdded).toLocaleDateString()"></p>
                                                    </td>
                                                    <td class="px-4 py-3 text-right font-medium" x-text="item.stock"></td>
                                                    <td class="px-4 py-3 text-right" x-text="'$' + (item.cost || 0).toFixed(2)"></td>
                                                    <td class="px-4 py-3 text-right" x-text="'$' + item.price.toFixed(2)"></td>
                                                    <td class="px-4 py-3 text-right font-medium text-blue-600" x-text="'$' + ((item.cost || 0) * item.stock).toFixed(2)"></td>
                                                    <td class="px-4 py-3 text-right font-medium text-green-600" x-text="'$' + (item.price * item.stock).toFixed(2)"></td>
                                                    <td class="px-4 py-3">
                                                        <div class="flex space-x-2">
                                                            <button @click="viewProduct(item)" class="text-blue-600 hover:text-blue-900 text-xs">View</button>
                                                            <button @click="editProduct(item)" class="text-green-600 hover:text-green-900 text-xs">Edit</button>
                                                            <button @click="applyDiscountToAgedItem(item)" class="text-orange-600 hover:text-orange-900 text-xs">Discount</button>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </template>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="flex justify-between items-center pt-4 border-t border-gray-200">
                                <div class="flex space-x-2">
                                    <button @click="exportAgingData()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm">
                                        Export to Excel
                                    </button>
                                    <button @click="printAgingReport()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors text-sm">
                                        Print Report
                                    </button>
                                </div>
                                <div class="flex space-x-2">
                                    <button @click="bulkDiscountAgedItems()" class="bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition-colors text-sm">
                                        Apply Bulk Discount
                                    </button>
                                    <button @click="showAgingModal = false" class="bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors text-sm">
                                        Close
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Empty State -->
                        <div x-show="!agingModalData.items || agingModalData.items.length === 0" class="text-center py-12">
                            <svg class="w-16 h-16 mx-auto mb-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"/>
                            </svg>
                            <h3 class="text-lg font-medium text-gray-900 mb-2">No Items Found</h3>
                            <p class="text-gray-500">There are no items in this aging category.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Print Type Selection Modal -->
            <div x-show="showPrintTypeModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" @keydown.escape="showPrintTypeModal = false" @keydown.enter="selectPrintType('barcode')" x-init="showPrintTypeModal && $el.focus()" tabindex="0">
                <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-xl font-semibold text-gray-900">Select Print Type</h3>
                            <button @click="showPrintTypeModal = false" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                        </div>

                        <div x-show="printData.product" class="space-y-4">
                            <!-- Product Info -->
                            <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                                <h4 class="font-medium text-gray-900" x-text="printData.product?.name"></h4>
                                <p class="text-sm text-gray-500" x-text="`${printData.product?.category} • METRC: ${printData.product?.metrcTag || 'N/A'}`"></p>
                            </div>

                            <!-- Print Options -->
                            <div class="space-y-3">
                                <h4 class="font-medium text-gray-700">Choose print type:</h4>

                                <!-- QR Code Option -->
                                <button @click="selectPrintType('barcode')" class="w-full p-4 border-2 border-gray-200 rounded-lg hover:border-blue-300 hover:bg-blue-50 transition-all text-left">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h5 class="font-medium text-gray-900">QR Code Label</h5>
                                            <p class="text-sm text-gray-600">Advanced QR code with comprehensive product data</p>
                                        </div>
                                        <svg class="w-6 h-6 text-blue-500" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M3 3h6v6H3V3zm2 2v2h2V5H5zm6-2h6v6h-6V3zm2 2v2h2V5h-2zM3 15h6v6H3v-6zm2 2v2h2v-2H5zm8 0h2v2h-2v-2zm0-4h2v2h-2v-2zm2 0h2v2h-2v-2zm0-2h2v2h-2v-2zm-2 0h2v2h-2v-2zm4 0h2v2h-2v-2zm0 4h2v2h-2v-2zm0 2h2v2h-2v-2z"/>
                                        </svg>
                                    </div>
                                </button>

                                <!-- Exit Label Option -->
                                <button @click="selectPrintType('exitLabel')" class="w-full p-4 border-2 border-gray-200 rounded-lg hover:border-green-300 hover:bg-green-50 transition-all text-left">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h5 class="font-medium text-gray-900">Oregon OLCC Exit Label</h5>
                                            <p class="text-sm text-gray-600">Compliant 4x2 exit label with all required OLCC information</p>
                                            <div class="text-xs text-green-600 mt-1">
                                                Includes: METRC tag, batch info, test results, cannabinoid content
                                            </div>
                                        </div>
                                        <svg class="w-6 h-6 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                        </svg>
                                    </div>
                                </button>
                            </div>
                        </div>

                        <div class="mt-6 flex gap-3">
                            <button @click="showPrintTypeModal = false" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                                Cancel
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Print Preview Modal -->
            <div x-show="showPrintPreviewModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" @keydown.escape="cancelPrintPreview()" @keydown.enter="proceedToPrint()" x-init="showPrintPreviewModal && $el.focus()" tabindex="0">
                <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-xl font-semibold text-gray-900">Print Preview</h3>
                            <button @click="cancelPrintPreview()" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                        </div>

                        <div x-show="printData.product" class="space-y-6">
                            <!-- Preview Info -->
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h4 class="font-medium text-blue-900" x-text="printData.product?.name"></h4>
                                        <p class="text-sm text-blue-700" x-text="`Print Type: ${printData.type === 'barcode' ? 'Barcode Label' : 'Oregon OLCC Exit Label'}`"></p>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-sm text-blue-600" x-text="`Category: ${printData.product?.category}`"></p>
                                        <p class="text-sm text-blue-600" x-text="`SKU: ${printData.product?.sku || 'N/A'}`"></p>
                                    </div>
                                </div>
                            </div>

                            <!-- Print Preview Area -->
                            <div class="border-2 border-dashed border-gray-300 p-6 bg-gray-50 rounded-lg">
                                <div class="text-center mb-4">
                                    <p class="text-sm text-gray-600 font-medium">PRINT PREVIEW</p>
                                    <p class="text-xs text-gray-500">Actual size may vary based on printer settings</p>
                                </div>

                                <!-- QR Code Label Preview -->
                                <div x-show="printData.type === 'barcode'" class="bg-white border border-gray-400 p-4 mx-auto" style="width: 300px; height: 200px; font-family: monospace;" x-init="generateProductQRCode(printData.product)">
                                    <div class="text-center space-y-2">
                                        <!-- Store Header -->
                                        <div class="text-xs font-bold">CANNABEST DISPENSARY</div>
                                        <div class="text-xs">Inventory Label</div>

                                        <!-- Product Info -->
                                        <div class="border-t border-gray-300 pt-2 space-y-1">
                                            <div class="text-sm font-bold" x-text="printData.product?.name?.substring(0, 25) + (printData.product?.name?.length > 25 ? '...' : '')"></div>
                                            <div class="text-xs" x-text="printData.product?.category"></div>
                                            <div class="text-xs" x-text="`SKU: ${printData.product?.sku || 'N/A'}`"></div>
                                        </div>

                                        <!-- QR Code -->
                                        <div class="border-t border-gray-300 pt-2">
                                            <div class="text-xs mb-1">QR CODE</div>
                                            <div class="flex justify-center">
                                                <canvas x-ref="qrCanvas" width="80" height="80" class="border border-gray-300"></canvas>
                                            </div>
                                            <div class="text-xs mt-1" x-text="`Product ID: ${printData.product?.id || 'N/A'}`"></div>
                                        </div>

                                        <!-- Bottom Info -->
                                        <div class="border-t border-gray-300 pt-2 text-xs">
                                            <div x-text="`Price: $${(printData.product?.price || 0).toFixed(2)}`"></div>
                                            <div x-text="`Stock: ${printData.product?.stock || 0}`"></div>
                                            <div x-text="`Printed: ${new Date().toLocaleDateString()}`"></div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Exit Label Preview -->
                                <div x-show="printData.type === 'exitLabel'" class="bg-white border-2 border-black p-4 mx-auto" style="width: 350px; height: 450px; font-family: monospace;">
                                    <div class="space-y-2 text-xs">
                                        <!-- OLCC Header -->
                                        <div class="text-center border-b-2 border-black pb-2">
                                            <div class="text-sm font-bold">OREGON OLCC</div>
                                            <div class="text-xs">CANNABIS EXIT LABEL</div>
                                            <div class="text-xs">ORS 475B.XXX</div>
                                        </div>

                                        <!-- Retailer Info -->
                                        <div class="border-b border-gray-400 pb-2">
                                            <div class="font-bold">RETAILER:</div>
                                            <div>Cannabest Dispensary</div>
                                            <div>123 Cannabis Ave</div>
                                            <div>Portland, OR 97201</div>
                                            <div>License: REC-123456</div>
                                        </div>

                                        <!-- Product Info -->
                                        <div class="border-b border-gray-400 pb-2">
                                            <div class="font-bold">PRODUCT:</div>
                                            <div x-text="printData.product?.name"></div>
                                            <div x-text="`Category: ${printData.product?.category}`"></div>
                                            <div x-text="`Weight: ${printData.product?.weight || '1g'}`"></div>
                                        </div>

                                        <!-- Cannabinoid Info -->
                                        <div class="border-b border-gray-400 pb-2" x-show="printData.product && !['Paraphernalia', 'Accessories', 'Glass'].includes(printData.product.category)">
                                            <div class="font-bold">CANNABINOIDS:</div>
                                            <div x-text="`THC: ${printData.product?.thc || 0}%`"></div>
                                            <div x-text="`CBD: ${printData.product?.cbd || 0}%`"></div>
                                        </div>

                                        <!-- METRC Info -->
                                        <div class="border-b border-gray-400 pb-2">
                                            <div class="font-bold">METRC TAG:</div>
                                            <div x-text="printData.product?.metrcTag || '1A4060300001234000000001'"></div>
                                        </div>

                                        <!-- Sale Info -->
                                        <div class="border-b border-gray-400 pb-2">
                                            <div class="font-bold">SALE INFO:</div>
                                            <div x-text="`Date: ${new Date().toLocaleDateString()}`"></div>
                                            <div x-text="`Time: ${new Date().toLocaleTimeString()}`"></div>
                                            <div x-text="`Price: $${(printData.product?.price || 0).toFixed(2)}`"></div>
                                        </div>

                                        <!-- Warning -->
                                        <div class="border-2 border-black p-1 text-center">
                                            <div class="font-bold text-xs">⚠️ WARNING ⚠️</div>
                                            <div class="text-xs">FOR USE BY ADULTS 21+</div>
                                            <div class="text-xs">KEEP OUT OF REACH OF CHILDREN</div>
                                            <div class="text-xs">NOT FOR RESALE</div>
                                        </div>

                                        <!-- QR Code Simulation -->
                                        <div class="text-center">
                                            <div class="mx-auto bg-black" style="width: 60px; height: 60px; background-image: radial-gradient(circle, white 1px, black 1px); background-size: 3px 3px;"></div>
                                            <div class="text-xs mt-1">QR Code for Verification</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="flex gap-3 pt-4 border-t border-gray-200">
                                <button @click="cancelPrintPreview()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                                    Cancel
                                </button>
                                <button @click="proceedToPrint()" class="flex-1 px-4 py-2 bg-cannabis-green text-white rounded-lg hover:bg-green-700 transition-colors">
                                    Continue to Print Options
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Other pages simplified -->
            <div x-show="currentPage !== 'pos'" class="fade-in">
                <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
                    <div class="bg-white rounded-lg shadow-sm p-6 min-h-[600px]">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center gap-3">
                                <h2 class="text-2xl font-bold text-gray-900" x-text="getCurrentPageTitle()"></h2>
                                <span class="px-3 py-1 bg-blue-100 text-blue-800 text-sm font-medium rounded-full">
                                    Laravel Integration Ready
                                </span>
                            </div>
                            <!-- Print and Export Options -->
                            <div class="flex items-center gap-2">
                                <button @click="printPage()" class="bg-gray-600 text-white px-3 py-2 rounded-lg hover:bg-gray-700 transition-colors flex items-center gap-2 text-sm">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V9a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                                    </svg>
                                    Print
                                </button>
                                <div class="relative" x-data="{ showExportMenu: false }">
                                    <button @click="showExportMenu = !showExportMenu" class="bg-green-600 text-white px-3 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2 text-sm">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a4 4 0 01-4-4V5a4 4 0 014-4h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a4 4 0 01-4 4z"/>
                                        </svg>
                                        Export
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                                        </svg>
                                    </button>
                                    <!-- Export Dropdown -->
                                    <div x-show="showExportMenu" @click.outside="showExportMenu = false" class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-50">
                                        <div class="py-1">
                                            <button @click="exportToPDF(); showExportMenu = false" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
                                                </svg>
                                                Export to PDF
                                            </button>
                                            <button @click="exportToExcel(); showExportMenu = false" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a4 4 0 01-4-4V5a4 4 0 014-4h10a4 4 0 014 4v14a4 4 0 01-4 4z"/>
                                                </svg>
                                                Export to Excel
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Page Content with Better Error Handling -->
                        <template x-if="currentPage === 'customers'">
                            <div class="space-y-6">
                                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <svg class="w-5 h-5 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                            </svg>
                                            <span class="text-green-800 font-medium">Customer Management System</span>
                                        </div>
                                        <button @click="showAddCustomerModal = true" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                            </svg>
                                            Add Customer
                                        </button>
                                    </div>
                                    <p class="text-green-700 text-sm mt-1">Full customer database with search, edit, and medical card management capabilities.</p>
                                </div>

                                <!-- Customer List -->
                                <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="p-6 border-b border-gray-200">
                                        <div class="flex items-center justify-between">
                                            <h3 class="text-lg font-semibold text-gray-900">Customer Database</h3>
                                            <div class="flex items-center gap-2">
                                                <span class="text-sm text-gray-500" x-text="'Total customers: ' + customers.length"></span>
                                            </div>
                                        </div>
                                        <div class="mt-4">
                                            <input id="customer-search-filter" name="customer-search-filter" type="text" placeholder="Search customers by name, email, phone, or medical card..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" aria-label="Search customers by name, email, phone, or medical card">
                                        </div>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="w-full">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Customer</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Loyalty</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <template x-for="customer in customers" :key="customer.id">
                                                    <tr class="hover:bg-gray-50">
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <div>
                                                                <div class="text-sm font-medium text-gray-900" x-text="customer.name"></div>
                                                                <div x-show="customer.isMedical" class="text-xs text-green-600">
                                                                    Medical Card: <span x-text="customer.medicalCard"></span>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <div class="text-sm text-gray-900" x-text="customer.email"></div>
                                                            <div class="text-sm text-gray-500" x-text="customer.phone || 'No phone'"></div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                                                  :class="customer.isMedical ? 'bg-green-100 text-green-800' : 'bg-blue-100 text-blue-800'"
                                                                  x-text="customer.isMedical ? 'Medical' : 'Recreational'">
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                                                            <span x-text="customer.loyaltyPoints || 0"></span> points
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <div class="flex items-center gap-2">
                                                                <button @click="viewCustomer(customer)" class="text-blue-600 hover:text-blue-900">View</button>
                                                                <button @click="editCustomer(customer)" class="text-green-600 hover:text-green-900">Edit</button>
                                                                <button @click="startSaleForCustomer(customer)" class="text-purple-600 hover:text-purple-900 font-medium">Start Sale</button>
                                                                <button @click="deleteCustomer(customer)" class="text-red-600 hover:text-red-900">Delete</button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <h3 class="font-medium text-gray-900">Search & Filter</h3>
                                        <p class="text-sm text-gray-600 mt-1">Search by name, email, phone, or medical card number</p>
                                    </div>
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <h3 class="font-medium text-gray-900">Customer Actions</h3>
                                        <p class="text-sm text-gray-600 mt-1">View, edit, start sale, activate/deactivate, delete</p>
                                    </div>
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <h3 class="font-medium text-gray-900">Medical Integration</h3>
                                        <p class="text-sm text-gray-600 mt-1">Medical card validation and compliance tracking</p>
                                    </div>
                                </div>
                                <div class="border border-gray-200 rounded-lg p-4">
                                    <p class="text-gray-600 mb-2">Laravel Implementation: <code class="bg-gray-100 px-2 py-1 rounded text-sm">/customers</code></p>
                                    <p class="text-sm text-gray-500">����� Enhanced search functionality implemented</p>
                                    <p class="text-sm text-gray-500">��� Customer action buttons added</p>
                                    <p class="text-sm text-gray-500">✅ Medical card number search enabled</p>
                                </div>
                            </div>
                        </template>

                        <template x-if="currentPage === 'employees'">
                            <div class="space-y-6">
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <svg class="w-5 h-5 text-blue-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                                            </svg>
                                            <span class="text-blue-800 font-medium">Employee Management System</span>
                                        </div>
                                        <button @click="showAddEmployeeModal = true" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                            </svg>
                                            Add Employee
                                        </button>
                                    </div>
                                    <p class="text-blue-700 text-sm mt-1">Manage staff roles, permissions, and cannabis industry compliance requirements.</p>
                                </div>

                                <!-- Employee Statistics -->
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <p class="text-sm font-medium text-gray-600">Total Employees</p>
                                                <p class="text-2xl font-bold text-blue-600" x-text="employees.length"></p>
                                            </div>
                                            <div class="h-8 w-8 bg-blue-100 rounded-full flex items-center justify-center">
                                                <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"/>
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <p class="text-sm font-medium text-gray-600">Active</p>
                                                <p class="text-2xl font-bold text-green-600" x-text="employees.filter(e => e.status === 'active').length"></p>
                                            </div>
                                            <div class="h-8 w-8 bg-green-100 rounded-full flex items-center justify-center">
                                                <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <p class="text-sm font-medium text-gray-600">Managers</p>
                                                <p class="text-2xl font-bold text-purple-600" x-text="employees.filter(e => e.role === 'manager').length"></p>
                                            </div>
                                            <div class="h-8 w-8 bg-purple-100 rounded-full flex items-center justify-center">
                                                <svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <p class="text-sm font-medium text-gray-600">This Week Hours</p>
                                                <p class="text-2xl font-bold text-orange-600" x-text="employees.reduce((sum, e) => sum + (e.hoursWorked || 0), 0)"></p>
                                            </div>
                                            <div class="h-8 w-8 bg-orange-100 rounded-full flex items-center justify-center">
                                                <svg class="w-4 h-4 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Employee Table -->
                                <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="p-6 border-b border-gray-200">
                                        <div class="flex items-center justify-between">
                                            <h3 class="text-lg font-semibold text-gray-900">Employee Directory</h3>
                                            <div class="flex items-center gap-2">
                                                <span class="text-sm text-gray-500" x-text="'Total employees: ' + employees.length"></span>
                                            </div>
                                        </div>
                                        <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4">
                                            <input id="employee-search" name="employee-search" type="text" x-model="employeeSearchQuery" placeholder="Search employees..." class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" aria-label="Search employees">
                                            <select id="employee-role-filter" name="employee-role-filter" x-model="employeeRoleFilter" class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" aria-label="Filter employees by role">
                                                <option value="">All Roles</option>
                                                <option value="manager">Manager</option>
                                                <option value="budtender">Budtender</option>
                                                <option value="security">Security</option>
                                                <option value="admin">Admin</option>
                                            </select>
                                            <select id="employee-status-filter" name="employee-status-filter" x-model="employeeStatusFilter" class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" aria-label="Filter employees by status">
                                                <option value="">All Status</option>
                                                <option value="active">Active</option>
                                                <option value="inactive">Inactive</option>
                                                <option value="terminated">Terminated</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="w-full">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Employee</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Role</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Compliance</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Hours/Pay</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <template x-for="employee in filteredEmployees" :key="employee.id">
                                                    <tr class="hover:bg-gray-50" :class="{'bg-red-50': employee.status === 'inactive'}">
                                                        <td class="px-6 py-4">
                                                            <div>
                                                                <div class="text-sm font-medium text-gray-900" x-text="employee.name"></div>
                                                                <div class="text-sm text-gray-500" x-text="'Hired: ' + employee.hireDate"></div>
                                                                <div class="text-xs text-gray-400" x-text="'ID: ' + employee.id"></div>
                                                            </div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                                                  :class="{
                                                                      'bg-purple-100 text-purple-800': employee.role === 'manager',
                                                                      'bg-blue-100 text-blue-800': employee.role === 'budtender',
                                                                      'bg-gray-100 text-gray-800': employee.role === 'security',
                                                                      'bg-green-100 text-green-800': employee.role === 'admin'
                                                                  }"
                                                                  x-text="employee.role.charAt(0).toUpperCase() + employee.role.slice(1)"></span>
                                                        </td>
                                                        <td class="px-6 py-4">
                                                            <div class="text-sm text-gray-900" x-text="employee.email"></div>
                                                            <div class="text-sm text-gray-500" x-text="employee.phone"></div>
                                                        </td>
                                                        <td class="px-6 py-4">
                                                            <div class="text-xs">
                                                                <div class="mb-1">
                                                                    <span class="text-gray-600">Permit:</span>
                                                                    <span :class="employee.workerPermit ? 'text-green-600' : 'text-red-600'"
                                                                          x-text="employee.workerPermit ? 'Valid' : 'Missing'"></span>
                                                                </div>
                                                                <div>
                                                                    <span class="text-gray-600">METRC:</span>
                                                                    <span :class="employee.metrcApiKey ? 'text-green-600' : 'text-red-600'"
                                                                          x-text="employee.metrcApiKey ? 'Active' : 'None'"></span>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td class="px-6 py-4">
                                                            <div class="text-sm text-gray-900" x-text="(employee.hoursWorked || 0) + 'h this week'"></div>
                                                            <div class="text-sm text-gray-500" x-text="'$' + (employee.payRate || 0).toFixed(2) + '/hr'"></div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                                                  :class="{
                                                                      'bg-green-100 text-green-800': employee.status === 'active',
                                                                      'bg-red-100 text-red-800': employee.status === 'inactive',
                                                                      'bg-gray-100 text-gray-800': employee.status === 'terminated'
                                                                  }"
                                                                  x-text="employee.status.charAt(0).toUpperCase() + employee.status.slice(1)"></span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <div class="relative" x-data="{ openDropdown: false }">
                                                                <button @click="openDropdown = !openDropdown" class="bg-gray-100 text-gray-700 px-3 py-1 rounded text-sm hover:bg-gray-200 transition-colors flex items-center gap-1">
                                                                    Actions
                                                                    <svg class="w-4 h-4 transition-transform" :class="openDropdown ? 'rotate-180' : ''" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                                                                    </svg>
                                                                </button>

                                                                <div x-show="openDropdown" @click.away="openDropdown = false" x-cloak class="absolute right-0 mt-1 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-10">
                                                                    <div class="py-1">
                                                                        <button @click="viewEmployee(employee); openDropdown = false" class="w-full text-left px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 transition-colors">
                                                                            <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                                                                            </svg>
                                                                            View Details
                                                                        </button>
                                                                        <button @click="editEmployee(employee); openDropdown = false" class="w-full text-left px-4 py-2 text-sm text-green-600 hover:bg-green-50 transition-colors">
                                                                            <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                                                            </svg>
                                                                            Edit Employee
                                                                        </button>
                                                                        <hr class="my-1">
                                                                        <button @click="resetPassword(employee); openDropdown = false" class="w-full text-left px-4 py-2 text-sm text-purple-600 hover:bg-purple-50 transition-colors">
                                                                            <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/>
                                                                            </svg>
                                                                            Reset Password
                                                                        </button>
                                                                        <button @click="resetPIN(employee); openDropdown = false" class="w-full text-left px-4 py-2 text-sm text-indigo-600 hover:bg-indigo-50 transition-colors">
                                                                            <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"/>
                                                                            </svg>
                                                                            Reset PIN
                                                                        </button>
                                                                        <hr class="my-1">
                                                                        <button @click="toggleEmployeeStatus(employee); openDropdown = false"
                                                                                :class="employee.status === 'active' ? 'text-orange-600 hover:bg-orange-50' : 'text-green-600 hover:bg-green-50'"
                                                                                class="w-full text-left px-4 py-2 text-sm transition-colors">
                                                                            <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-show="employee.status === 'active'">
                                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L5.636 5.636"/>
                                                                            </svg>
                                                                            <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-show="employee.status !== 'active'">
                                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                                                            </svg>
                                                                            <span x-text="employee.status === 'active' ? 'Deactivate' : 'Activate'"></span>
                                                                        </button>
                                                                        <hr class="my-1">
                                                                        <button @click="deleteEmployee(employee); openDropdown = false" class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors">
                                                                            <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                                                            </svg>
                                                                            Delete Employee
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <h3 class="font-medium text-gray-900">Role Management</h3>
                                        <p class="text-sm text-gray-600 mt-1">Assign roles with specific permissions and access levels</p>
                                    </div>
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <h3 class="font-medium text-gray-900">Compliance Tracking</h3>
                                        <p class="text-sm text-gray-600 mt-1">Track worker permits and METRC API key assignments</p>
                                    </div>
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <h3 class="font-medium text-gray-900">Payroll Integration</h3>
                                        <p class="text-sm text-gray-600 mt-1">Monitor hours worked and pay rates for payroll processing</p>
                                    </div>
                                </div>
                                <div class="border border-gray-200 rounded-lg p-4">
                                    <p class="text-gray-600">Laravel Implementation: <code class="bg-gray-100 px-2 py-1 rounded text-sm">/employees</code></p>
                                    <p class="text-sm text-gray-500 mt-1">✅ Complete employee management with cannabis industry compliance requirements</p>
                                    <p class="text-sm text-gray-500">✅ Full CRUD operations with role-based permissions and data retention</p>
                                    <p class="text-sm text-gray-500">✅ Worker permit and METRC API key tracking for regulatory compliance</p>
                                </div>
                            </div>
                        </template>

                        <template x-if="currentPage === 'products'">
                            <div class="space-y-6">
                                <div class="bg-cannabis-green bg-opacity-10 border border-cannabis-green rounded-lg p-4">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <svg class="w-5 h-5 text-cannabis-green mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                                            </svg>
                                            <span class="text-cannabis-green font-medium">Product Catalog Management</span>
                                        </div>
                                        <div class="flex items-center gap-3">
                                            <!-- CSV Import Button -->
                                            <button @click="showCsvImportModal = true" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"/>
                                                </svg>
                                                Import CSV
                                            </button>

                                            <!-- Template Download Button -->
                                            <button @click="showTemplateModal = true" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                                </svg>
                                                Download Templates
                                            </button>

                                            <!-- Add Product Button -->
                                            <button @click="showAddProductModal = true" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                                </svg>
                                                Add Product
                                            </button>
                                        </div>
                                    </div>
                                    <p class="text-green-700 text-sm mt-1">Complete inventory management with METRC integration and data retention.</p>
                                </div>

                                <!-- Product Catalogue Overview -->
                                <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="p-6 border-b border-gray-200">
                                        <div class="flex items-center justify-between">
                                            <h3 class="text-lg font-semibold text-gray-900">Product Catalogue</h3>
                                            <div class="flex items-center gap-2">
                                                <span class="text-sm text-gray-500" x-text="'Total products: ' + products.length"></span>
                                            </div>
                                        </div>
                                        <div class="mt-4 grid grid-cols-1 md:grid-cols-4 gap-4">
                                            <input id="product-search-filter" name="product-search-filter" type="text" placeholder="Search products..." class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" aria-label="Search products">
                                            <select id="product-category-filter" name="product-category-filter" class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" aria-label="Filter products by category">
                                                <option value="">All Categories</option>
                                                <option value="Flower">Flower</option>
                                                <option value="Edibles">Edibles</option>
                                                <option value="Concentrates">Concentrates</option>
                                                <option value="Pre-Rolls">Pre-Rolls</option>
                                                <option value="Tinctures">Tinctures</option>
                                                <option value="Hemp">Hemp</option>
                                                <option value="Paraphernalia">Accessories</option>
                                            </select>
                                            <select id="product-room-filter" name="product-room-filter" class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" aria-label="Filter products by room">
                                                <option value="">All Rooms</option>
                                                <option value="flower-room-1">Flower Room 1</option>
                                                <option value="flower-room-2">Flower Room 2</option>
                                                <option value="packaging-room">Packaging Room</option>
                                                <option value="storage-room">Storage Room</option>
                                                <option value="vault">Vault</option>
                                            </select>
                                            <select id="product-status-filter" name="product-status-filter" class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" aria-label="Filter products by status">
                                                <option value="">All Status</option>
                                                <option value="active">On Sales Floor</option>
                                                <option value="inactive">Not on Sales Floor</option>
                                                <option value="low-stock">Low Stock</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="w-full">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Product</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Pricing</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stock</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">METRC</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <template x-for="product in products.slice(0, 10)" :key="product.id">
                                                    <tr class="hover:bg-gray-50">
                                                        <td class="px-6 py-4">
                                                            <div>
                                                                <div class="text-sm font-medium text-gray-900" x-text="product.name"></div>
                                                                <div class="text-sm text-gray-500" x-text="`SKU: ${product.sku || 'N/A'} • ${product.weight || 'N/A'}`"></div>
                                                                <div class="text-xs text-gray-400" x-text="`Vendor: ${product.vendor || 'N/A'}`"></div>
                                                            </div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800" x-text="product.category"></span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <div class="text-sm text-gray-900" x-text="'$' + product.price.toFixed(2)"></div>
                                                            <div class="text-xs text-gray-500" x-text="'Cost: $' + (product.cost || 0).toFixed(2)"></div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <div class="text-sm text-gray-900" x-text="product.stock + ' units'"></div>
                                                            <div class="text-xs text-gray-500" x-text="'Room: ' + (product.room || 'Main')"></div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <div class="text-xs font-mono text-purple-700 bg-purple-50 px-2 py-1 rounded" x-text="product.metrcTag || 'No Tag'"></div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <div class="flex items-center gap-2">
                                                                <button @click="editProduct(product)" class="text-blue-600 hover:text-blue-900">Edit</button>
                                                                <button @click="viewMetrcData(product)" class="text-purple-600 hover:text-purple-900">METRC</button>
                                                                <button class="text-red-600 hover:text-red-900">Delete</button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <h3 class="font-medium text-gray-900">Data Retention</h3>
                                        <p class="text-sm text-gray-600 mt-1">All product catalogue data is automatically saved and retained for future use</p>
                                    </div>
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <h3 class="font-medium text-gray-900">METRC Integration</h3>
                                        <p class="text-sm text-gray-600 mt-1">Seamless integration with Oregon OLCC tracking system</p>
                                    </div>
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <h3 class="font-medium text-gray-900">Compliance Ready</h3>
                                        <p class="text-sm text-gray-600 mt-1">Cannabis industry compliant with required and optional fields</p>
                                    </div>
                                </div>
                                <div class="border border-gray-200 rounded-lg p-4">
                                    <p class="text-gray-600">Laravel Implementation: <code class="bg-gray-100 px-2 py-1 rounded text-sm">/products</code></p>
                                    <p class="text-sm text-gray-500 mt-1">✅ Enhanced product catalogue with comprehensive field requirements</p>
                                    <p class="text-sm text-gray-500">✅ Data retention and METRC integration implemented</p>
                                    <p class="text-sm text-gray-500">������ Full CRUD operations with image upload capabilities</p>
                                </div>
                            </div>
                        </template>

                        <template x-if="currentPage === 'metrc-vendors'">
                            <div class="space-y-6">
                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <svg class="w-5 h-5 text-purple-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3a4 4 0 118 0v4h1a2 2 0 012 2v9a2 2 0 01-2 2H7a2 2 0 01-2-2V9a2 2 0 012-2h1z"/>
                                            </svg>
                                            <span class="text-purple-800 font-medium">Incoming METRC Vendor Shipments</span>
                                        </div>
                                        <button @click="refreshVendorData()" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                                            </svg>
                                            Refresh METRC Data
                                        </button>
                                    </div>
                                    <p class="text-purple-700 text-sm mt-1">View incoming vendor shipments with ETA, package details, and inventory import functionality.</p>
                                </div>

                                <!-- Vendor Shipments Overview -->
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <p class="text-sm font-medium text-gray-600">Expected Today</p>
                                                <p class="text-2xl font-bold text-purple-600" x-text="incomingVendors.filter(v => v.eta === 'today').length"></p>
                                            </div>
                                            <div class="h-8 w-8 bg-purple-100 rounded-full flex items-center justify-center">
                                                <svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <p class="text-sm font-medium text-gray-600">This Week</p>
                                                <p class="text-2xl font-bold text-blue-600" x-text="incomingVendors.filter(v => v.eta === 'this-week').length"></p>
                                            </div>
                                            <div class="h-8 w-8 bg-blue-100 rounded-full flex items-center justify-center">
                                                <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3a4 4 0 118 0v4h1a2 2 0 012 2v9a2 2 0 01-2 2H7a2 2 0 01-2-2V9a2 2 0 012-2h1z"/>
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <p class="text-sm font-medium text-gray-600">Total Packages</p>
                                                <p class="text-2xl font-bold text-green-600" x-text="incomingVendors.reduce((sum, v) => sum + v.packages.length, 0)"></p>
                                            </div>
                                            <div class="h-8 w-8 bg-green-100 rounded-full flex items-center justify-center">
                                                <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <p class="text-sm font-medium text-gray-600">Ready to Import</p>
                                                <p class="text-2xl font-bold text-orange-600" x-text="incomingVendors.filter(v => v.status === 'ready-to-import').length"></p>
                                            </div>
                                            <div class="h-8 w-8 bg-orange-100 rounded-full flex items-center justify-center">
                                                <svg class="w-4 h-4 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"/>
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Vendor Shipments Table -->
                                <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="p-6 border-b border-gray-200">
                                        <div class="flex items-center justify-between">
                                            <h3 class="text-lg font-semibold text-gray-900">Incoming Vendor Shipments</h3>
                                            <div class="flex items-center gap-2">
                                                <span class="text-sm text-gray-500" x-text="'Total vendors: ' + incomingVendors.length"></span>
                                            </div>
                                        </div>
                                        <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4">
                                            <input id="vendor-search" name="vendor-search" type="text" x-model="vendorSearchQuery" placeholder="Search vendors..." class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" aria-label="Search vendors">
                                            <select id="vendor-status-filter" name="vendor-status-filter" x-model="vendorStatusFilter" class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" aria-label="Filter vendors by status">
                                                <option value="">All Status</option>
                                                <option value="in-transit">In Transit</option>
                                                <option value="ready-to-import">Ready to Import</option>
                                                <option value="imported">Imported</option>
                                                <option value="delayed">Delayed</option>
                                            </select>
                                            <select id="vendor-eta-filter" name="vendor-eta-filter" x-model="vendorETAFilter" class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" aria-label="Filter vendors by ETA">
                                                <option value="">All ETA</option>
                                                <option value="today">Today</option>
                                                <option value="this-week">This Week</option>
                                                <option value="next-week">Next Week</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="w-full">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Vendor</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ETA</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Packages</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Value</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <template x-for="vendor in filteredVendors" :key="vendor.id">
                                                    <tr class="hover:bg-gray-50" :class="{'bg-purple-50': vendor.status === 'ready-to-import'}">
                                                        <td class="px-6 py-4">
                                                            <div>
                                                                <div class="text-sm font-medium text-gray-900" x-text="vendor.name"></div>
                                                                <div class="text-sm text-gray-500" x-text="`License: ${vendor.license}`"></div>
                                                                <div class="text-xs text-gray-400" x-text="`METRC ID: ${vendor.metrcId}`"></div>
                                                            </div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <div class="text-sm text-gray-900" x-text="vendor.etaDate"></div>
                                                            <div class="text-xs text-gray-500" x-text="vendor.etaTime"></div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <div class="text-sm text-gray-900" x-text="vendor.packages.length + ' packages'"></div>
                                                            <div class="text-xs text-gray-500" x-text="vendor.packages.reduce((sum, p) => sum + p.quantity, 0) + ' total items'"></div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <div class="text-sm text-gray-900" x-text="'$' + vendor.totalValue.toFixed(2)"></div>
                                                            <div class="text-xs text-gray-500" x-text="'Cost: $' + vendor.totalCost.toFixed(2)"></div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                                                  :class="{
                                                                      'bg-green-100 text-green-800': vendor.status === 'ready-to-import',
                                                                      'bg-blue-100 text-blue-800': vendor.status === 'in-transit',
                                                                      'bg-gray-100 text-gray-800': vendor.status === 'imported',
                                                                      'bg-red-100 text-red-800': vendor.status === 'delayed'
                                                                  }"
                                                                  x-text="vendor.status.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())"></span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <div class="flex items-center gap-2">
                                                                <button @click="viewVendorPackages(vendor)" class="text-purple-600 hover:text-purple-900">View Packages</button>
                                                                <button @click="importVendorInventory(vendor)"
                                                                        :disabled="vendor.status !== 'ready-to-import'"
                                                                        :class="vendor.status === 'ready-to-import' ? 'text-green-600 hover:text-green-900' : 'text-gray-400'"
                                                                        class="disabled:cursor-not-allowed">Import</button>
                                                                <button @click="downloadManifest(vendor)" class="text-blue-600 hover:text-blue-900">Manifest</button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <h3 class="font-medium text-gray-900">Real-time Tracking</h3>
                                        <p class="text-sm text-gray-600 mt-1">Live updates from METRC system with vendor notifications</p>
                                    </div>
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <h3 class="font-medium text-gray-900">Package Details</h3>
                                        <p class="text-sm text-gray-600 mt-1">Complete manifests with strain, quantity, and compliance data</p>
                                    </div>
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <h3 class="font-medium text-gray-900">Auto Import</h3>
                                        <p class="text-sm text-gray-600 mt-1">One-click inventory import with METRC tag validation</p>
                                    </div>
                                </div>
                                <div class="border border-gray-200 rounded-lg p-4">
                                    <p class="text-gray-600">Laravel Implementation: <code class="bg-gray-100 px-2 py-1 rounded text-sm">/metrc-vendors</code></p>
                                    <p class="text-sm text-gray-500 mt-1">✅ Real-time METRC vendor shipment tracking with ETA monitoring</p>
                                    <p class="text-sm text-gray-500">✅ Package detail viewing and inventory import functionality</p>
                                    <p class="text-sm text-gray-500">✅ Manifest downloads and vendor communication system</p>
                                </div>
                            </div>
                        </template>

                        <template x-if="currentPage === 'rooms-drawers'">
                            <div class="space-y-6">
                                <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 text-orange-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-4m-5 0H3m2 0h2M7 7h10M7 11h10M7 15h10"/>
                                        </svg>
                                        <span class="text-orange-800 font-medium">Facility Room & Drawer Management</span>
                                    </div>
                                    <p class="text-orange-700 text-sm mt-1">Comprehensive facility management with room inventory tracking and cash drawer operations.</p>
                                </div>

                                <!-- Tab Navigation -->
                                <div class="bg-white border border-gray-200 rounded-lg">
                                    <div class="border-b border-gray-200">
                                        <nav class="flex space-x-8 px-6 py-3">
                                            <button @click="roomsTab = 'overview'"
                                                    :class="roomsTab === 'overview' ? 'border-orange-500 text-orange-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                                                    class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm">
                                                Overview
                                            </button>
                                            <button @click="roomsTab = 'rooms'"
                                                    :class="roomsTab === 'rooms' ? 'border-orange-500 text-orange-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                                                    class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm">
                                                Rooms
                                            </button>
                                            <button @click="roomsTab = 'drawers'"
                                                    :class="roomsTab === 'drawers' ? 'border-orange-500 text-orange-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                                                    class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm">
                                                Cash Drawers
                                            </button>
                                            <button @click="roomsTab = 'activity'"
                                                    :class="roomsTab === 'activity' ? 'border-orange-500 text-orange-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                                                    class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm">
                                                Activity Log
                                            </button>
                                        </nav>
                                    </div>

                                    <!-- Overview Tab -->
                                    <div x-show="roomsTab === 'overview'" class="p-6">
                                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Facility Overview</h3>

                                        <!-- Room Statistics -->
                                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                                <div class="flex items-center">
                                                    <div class="h-8 w-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                                                        <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-4m-5 0H3m2 0h2M7 7h10M7 11h10M7 15h10"/>
                                                        </svg>
                                                    </div>
                                                    <div>
                                                        <p class="text-sm font-medium text-blue-800">Total Rooms</p>
                                                        <p class="text-xl font-bold text-blue-900" x-text="facilityRooms.length"></p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                                <div class="flex items-center">
                                                    <div class="h-8 w-8 bg-green-100 rounded-full flex items-center justify-center mr-3">
                                                        <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                                                        </svg>
                                                    </div>
                                                    <div>
                                                        <p class="text-sm font-medium text-green-800">Products</p>
                                                        <p class="text-xl font-bold text-green-900" x-text="products.length"></p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                                <div class="flex items-center">
                                                    <div class="h-8 w-8 bg-purple-100 rounded-full flex items-center justify-center mr-3">
                                                        <svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v2a2 2 0 002 2z"/>
                                                        </svg>
                                                    </div>
                                                    <div>
                                                        <p class="text-sm font-medium text-purple-800">Cash Drawers</p>
                                                        <p class="text-xl font-bold text-purple-900" x-text="cashDrawers.length"></p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                                <div class="flex items-center">
                                                    <div class="h-8 w-8 bg-yellow-100 rounded-full flex items-center justify-center mr-3">
                                                        <svg class="w-4 h-4 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                                        </svg>
                                                    </div>
                                                    <div>
                                                        <p class="text-sm font-medium text-yellow-800">Open Drawers</p>
                                                        <p class="text-xl font-bold text-yellow-900" x-text="cashDrawers.filter(d => d.status === 'open').length"></p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Room Capacity Chart -->
                                        <div class="bg-gray-50 rounded-lg p-4">
                                            <h4 class="text-md font-semibold text-gray-900 mb-3">Room Utilization</h4>
                                            <div class="space-y-3">
                                                <template x-for="room in facilityRooms" :key="room.id">
                                                    <div class="flex items-center justify-between">
                                                        <span class="text-sm font-medium text-gray-700" x-text="room.name"></span>
                                                        <div class="flex items-center gap-2">
                                                            <div class="w-32 bg-gray-200 rounded-full h-2">
                                                                <div class="bg-orange-500 h-2 rounded-full" :style="`width: ${(room.currentCapacity / room.maxCapacity) * 100}%`"></div>
                                                            </div>
                                                            <span class="text-sm text-gray-600" x-text="`${room.currentCapacity}/${room.maxCapacity}`"></span>
                                                        </div>
                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Rooms Tab -->
                                    <div x-show="roomsTab === 'rooms'" class="p-6">
                                        <div class="flex items-center justify-between mb-4">
                                            <h3 class="text-lg font-semibold text-gray-900">Room Management</h3>
                                            <button @click="showAddRoomModal = true" class="bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition-colors flex items-center gap-2">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                                </svg>
                                                Add Room
                                            </button>
                                        </div>

                                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                            <template x-for="room in facilityRooms" :key="room.id">
                                                <div class="bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                                                    <div class="flex items-center justify-between mb-3">
                                                        <h4 class="text-md font-semibold text-gray-900" x-text="room.name"></h4>
                                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                                              :class="{
                                                                  'bg-green-100 text-green-800': room.status === 'active',
                                                                  'bg-red-100 text-red-800': room.status === 'maintenance',
                                                                  'bg-yellow-100 text-yellow-800': room.status === 'restricted'
                                                              }"
                                                              x-text="room.status.charAt(0).toUpperCase() + room.status.slice(1)"></span>
                                                    </div>
                                                    <div class="space-y-2 text-sm text-gray-600">
                                                        <div class="flex justify-between">
                                                            <span>Type:</span>
                                                            <span x-text="room.type"></span>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span>Capacity:</span>
                                                            <span x-text="`${room.currentCapacity}/${room.maxCapacity}`"></span>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span>Temperature:</span>
                                                            <span x-text="room.temperature + '°F'"></span>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span>Humidity:</span>
                                                            <span x-text="room.humidity + '%'"></span>
                                                        </div>
                                                    </div>
                                                    <div class="mt-4 flex gap-2">
                                                        <button @click="viewRoomDetails(room)" class="flex-1 bg-blue-100 text-blue-700 px-3 py-2 rounded text-xs hover:bg-blue-200 transition-colors">
                                                            View Details
                                                        </button>
                                                        <button @click="editRoom(room)" class="flex-1 bg-orange-100 text-orange-700 px-3 py-2 rounded text-xs hover:bg-orange-200 transition-colors">
                                                            Edit
                                                        </button>
                                                        <button @click="deleteRoomWithPin(room)" class="flex-1 bg-red-100 text-red-700 px-3 py-2 rounded text-xs hover:bg-red-200 transition-colors">
                                                            Delete
                                                        </button>
                                                    </div>
                                                </div>
                                            </template>
                                        </div>
                                    </div>

                                    <!-- Drawers Tab -->
                                    <div x-show="roomsTab === 'drawers'" class="p-6">
                                        <div class="flex items-center justify-between mb-4">
                                            <h3 class="text-lg font-semibold text-gray-900">Cash Drawer Management</h3>
                                            <button @click="showAddDrawerModal = true" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                                </svg>
                                                Add Drawer
                                            </button>
                                        </div>

                                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                            <template x-for="drawer in cashDrawers" :key="drawer.id">
                                                <div class="bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                                                    <div class="flex items-center justify-between mb-3">
                                                        <h4 class="text-md font-semibold text-gray-900" x-text="drawer.name"></h4>
                                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                                              :class="{
                                                                  'bg-green-100 text-green-800': drawer.status === 'open',
                                                                  'bg-gray-100 text-gray-800': drawer.status === 'closed',
                                                                  'bg-red-100 text-red-800': drawer.status === 'counting'
                                                              }"
                                                              x-text="drawer.status.charAt(0).toUpperCase() + drawer.status.slice(1)"></span>
                                                    </div>
                                                    <div class="space-y-2 text-sm text-gray-600">
                                                        <div class="flex justify-between">
                                                            <span>Assigned To:</span>
                                                            <span x-text="drawer.assignedEmployee"></span>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span>Starting Amount:</span>
                                                            <span x-text="'$' + drawer.startingAmount.toFixed(2)"></span>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span>Current Amount:</span>
                                                            <span x-text="'$' + drawer.currentAmount.toFixed(2)"></span>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span>Opened:</span>
                                                            <span x-text="drawer.openedAt"></span>
                                                        </div>
                                                    </div>
                                                    <div class="mt-4 space-y-2">
                                                        <div class="flex gap-2">
                                                            <button @click="openDrawer(drawer)"
                                                                    :disabled="drawer.status === 'open'"
                                                                    :class="drawer.status === 'open' ? 'bg-gray-100 text-gray-400 cursor-not-allowed' : 'bg-green-100 text-green-700 hover:bg-green-200'"
                                                                    class="flex-1 px-3 py-2 rounded text-xs transition-colors">
                                                                Open
                                                            </button>
                                                            <button @click="closeDrawer(drawer)"
                                                                    :disabled="drawer.status !== 'open'"
                                                                    :class="drawer.status !== 'open' ? 'bg-gray-100 text-gray-400 cursor-not-allowed' : 'bg-red-100 text-red-700 hover:bg-red-200'"
                                                                    class="flex-1 px-3 py-2 rounded text-xs transition-colors">
                                                                Close
                                                            </button>
                                                            <button @click="countDrawer(drawer)" class="flex-1 bg-purple-100 text-purple-700 px-3 py-2 rounded text-xs hover:bg-purple-200 transition-colors">
                                                                Count
                                                            </button>
                                                        </div>
                                                        <button @click="deleteDrawerWithPin(drawer)" class="w-full bg-red-100 text-red-700 px-3 py-2 rounded text-xs hover:bg-red-200 transition-colors">
                                                            Delete Drawer
                                                        </button>
                                                        <button @click="assignEmployeeToDrawer(drawer)" class="w-full bg-blue-100 text-blue-700 px-3 py-2 rounded text-xs hover:bg-blue-200 transition-colors">
                                                            Assign Employee
                                                        </button>
                                                    </div>
                                                </div>
                                            </template>
                                        </div>
                                    </div>

                                    <!-- Activity Log Tab -->
                                    <div x-show="roomsTab === 'activity'" class="p-6">
                                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Activity Log</h3>

                                        <div class="bg-white overflow-hidden">
                                            <div class="overflow-x-auto">
                                                <table class="w-full">
                                                    <thead class="bg-gray-50">
                                                        <tr>
                                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Time</th>
                                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Action</th>
                                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Location</th>
                                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Employee</th>
                                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Details</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="bg-white divide-y divide-gray-200">
                                                        <template x-for="activity in activityLog.slice(0, 20)" :key="activity.id">
                                                            <tr class="hover:bg-gray-50">
                                                                <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900" x-text="activity.timestamp"></td>
                                                                <td class="px-4 py-3 whitespace-nowrap">
                                                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                                                          :class="{
                                                                              'bg-blue-100 text-blue-800': activity.type === 'room',
                                                                              'bg-purple-100 text-purple-800': activity.type === 'drawer',
                                                                              'bg-green-100 text-green-800': activity.type === 'transfer'
                                                                          }"
                                                                          x-text="activity.action"></span>
                                                                </td>
                                                                <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900" x-text="activity.location"></td>
                                                                <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900" x-text="activity.employee"></td>
                                                                <td class="px-4 py-3 text-sm text-gray-500" x-text="activity.details"></td>
                                                            </tr>
                                                        </template>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="border border-gray-200 rounded-lg p-4">
                                    <p class="text-gray-600">Laravel Implementation: <code class="bg-gray-100 px-2 py-1 rounded text-sm">/rooms-drawers</code></p>
                                    <p class="text-sm text-gray-500 mt-1">✅ Complete facility management with room tracking and cash drawer operations</p>
                                    <p class="text-sm text-gray-500">✅ Activity logging, capacity management, and environmental monitoring</p>
                                    <p class="text-sm text-gray-500">✅ Cash drawer functionality with employee assignment and counting procedures</p>
                                </div>
                            </div>
                        </template>

                        <template x-if="currentPage === 'price-tiers'">
                            <div class="space-y-6">
                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <svg class="w-5 h-5 text-purple-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
                                            </svg>
                                            <span class="text-purple-800 font-medium">Price Tier Management</span>
                                        </div>
                                        <button @click="showAddTierModal = true" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                            </svg>
                                            Add Tier
                                        </button>
                                    </div>
                                    <p class="text-purple-700 text-sm mt-1">Configure pricing tiers and volume discounts for cannabis products.</p>
                                </div>

                                <!-- Weight Threshold Configuration -->
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
                                    <h3 class="text-lg font-semibold text-blue-900 mb-4">Weight Threshold Settings</h3>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-blue-900 mb-2">Weight Threshold (grams)</label>
                                            <input id="weight-threshold" name="weight-threshold" type="number" step="0.01" x-model="weightThreshold" class="w-full border border-blue-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" aria-describedby="weight-threshold-help">
                                            <p class="text-xs text-blue-700 mt-1">Allows adding this weight amount without changing prices</p>
                                        </div>
                                        <div class="flex items-end">
                                            <button @click="saveWeightThreshold()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                                Save Threshold
                                            </button>
                                        </div>
                                    </div>
                                    <div class="mt-4 p-3 bg-blue-100 rounded-lg">
                                        <p class="text-sm text-blue-800">
                                            <strong>Current Threshold:</strong> <span x-text="weightThreshold || '0.00'"></span>g
                                            - Any weight additions up to this amount will not change item pricing
                                        </p>
                                    </div>
                                </div>

                                <!-- Price Tiers List -->
                                <div class="bg-white border border-gray-200 rounded-lg">
                                    <div class="p-6 border-b border-gray-200">
                                        <h3 class="text-lg font-semibold text-gray-900">Current Price Tiers</h3>
                                        <p class="text-sm text-gray-600 mt-1">Manage custom pricing for different weight increments</p>
                                    </div>
                                    <div x-show="priceTiers.length > 0" class="space-y-4">
                                        <template x-for="tier in priceTiers" :key="tier.id">
                                            <div class="bg-gray-50 border border-gray-200 rounded-lg">
                                                <div class="px-6 py-4 border-b border-gray-200 bg-white rounded-t-lg">
                                                    <div class="flex justify-between items-center">
                                                        <div>
                                                            <h4 class="text-lg font-semibold text-gray-900" x-text="tier.name"></h4>
                                                            <p class="text-sm text-gray-600" x-text="`Tier ${tier.id} • ${tier.isActive ? 'Active' : 'Inactive'} • Created: ${new Date(tier.createdAt).toLocaleDateString()}`"></p>
                                                        </div>
                                                        <div class="flex space-x-2">
                                                            <button @click="editTier(tier)" class="text-blue-600 hover:text-blue-900 text-sm font-medium">Edit</button>
                                                            <button @click="toggleTierStatus(tier)"
                                                                    :class="tier.isActive ? 'text-orange-600 hover:text-orange-900' : 'text-green-600 hover:text-green-900'"
                                                                    class="text-sm font-medium"
                                                                    x-text="tier.isActive ? 'Deactivate' : 'Activate'"></button>
                                                            <button @click="deleteTier(tier.id)" class="text-red-600 hover:text-red-900 text-sm font-medium">Delete</button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="px-6 py-4">
                                                    <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                                                        <template x-for="weightOption in tier.weights" :key="weightOption.weight">
                                                            <div class="text-center p-3 bg-white border border-gray-200 rounded">
                                                                <div class="text-lg font-bold text-gray-900" x-text="weightOption.weight + 'g'"></div>
                                                                <div class="text-sm font-medium text-green-600" x-text="'$' + weightOption.price.toFixed(2)"></div>
                                                                <div class="text-xs text-gray-500" x-text="'$' + (weightOption.price / weightOption.weight).toFixed(2) + '/g'"></div>
                                                            </div>
                                                        </template>
                                                    </div>
                                                </div>
                                            </div>
                                        </template>
                                    </div>

                                    <div x-show="priceTiers.length === 0" class="text-center py-12">
                                        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                                        </svg>
                                        <h3 class="mt-2 text-sm font-medium text-gray-900">No Price Tiers</h3>
                                        <p class="mt-1 text-sm text-gray-500">Get started by creating your first price tier for flower products.</p>
                                        <div class="mt-6">
                                            <button @click="showAddTierModal = true" class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500">
                                                <svg class="-ml-1 mr-2 h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"></path>
                                                </svg>
                                                Add Price Tier
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="border border-gray-200 rounded-lg p-4">
                                    <p class="text-gray-600">Laravel Implementation: <code class="bg-gray-100 px-2 py-1 rounded text-sm">/price-tiers</code></p>
                                    <p class="text-sm text-gray-500 mt-1">Dynamic pricing engine with weight thresholds and custom tier management.</p>
                                </div>
                            </div>
                        </template>

                        <template x-if="currentPage === 'sales'">
                            <div class="space-y-6">
                                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                        </svg>
                                        <span class="text-green-800 font-medium">Sales Transaction History</span>
                                    </div>
                                    <p class="text-green-700 text-sm mt-1">Complete transaction history and receipt management.</p>
                                </div>

                                <!-- METRC Integration Section -->
                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-6">
                                    <div class="flex items-center justify-between mb-4">
                                        <div class="flex items-center">
                                            <svg class="w-6 h-6 text-purple-600 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.586 1.414A2 2 0 0018 10V9a2 2 0 00-2-2h-1.586l-1 1z"/>
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9H7a2 2 0 00-2 2v1a2 2 0 002 2h1v-4z"/>
                                            </svg>
                                            <h3 class="text-lg font-semibold text-purple-900">Oregon OLCC METRC Integration</h3>
                                        </div>
                                        <div class="flex items-center space-x-2 text-sm text-purple-700">
                                            <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                            <span>Connected</span>
                                        </div>
                                    </div>

                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                        <div>
                                            <label class="block text-sm font-medium text-purple-900 mb-2">Start Date</label>
                                            <input id="metrc-start-date" name="metrc-start-date" type="date" x-model="metrcPushSettings.startDate" class="w-full border border-purple-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500" aria-label="METRC push start date">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-purple-900 mb-2">End Date</label>
                                            <input id="metrc-end-date" name="metrc-end-date" type="date" x-model="metrcPushSettings.endDate" class="w-full border border-purple-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500" aria-label="METRC push end date">
                                        </div>
                                    </div>

                                    <div class="mb-4">
                                        <div class="flex items-center justify-between text-sm text-purple-800 mb-2">
                                            <span>Sales in Selected Period:</span>
                                            <span class="font-medium" x-text="getSalesCountForPeriod()"></span>
                                        </div>
                                        <div class="flex items-center justify-between text-sm text-purple-800">
                                            <span>Last METRC Push:</span>
                                            <span class="font-medium" x-text="lastMetrcPush || 'Never'"></span>
                                        </div>
                                    </div>

                                    <div class="flex space-x-3">
                                        <button @click="pushToMetrc()"
                                                :disabled="!metrcPushSettings.startDate || !metrcPushSettings.endDate || metrcPushInProgress"
                                                :class="metrcPushInProgress ? 'opacity-50 cursor-not-allowed' : ''"
                                                class="flex-1 bg-purple-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-purple-700 transition-colors flex items-center justify-center">
                                            <svg x-show="!metrcPushInProgress" class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                                            </svg>
                                            <svg x-show="metrcPushInProgress" class="animate-spin w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24">
                                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                            </svg>
                                            <span x-text="metrcPushInProgress ? 'Pushing to METRC...' : 'Push Sales to METRC'"></span>
                                        </button>

                                        <button @click="validateMetrcConnection()" class="px-4 py-3 border border-purple-300 text-purple-700 rounded-lg hover:bg-purple-50 transition-colors">
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                            </svg>
                                        </button>
                                    </div>

                                    <div x-show="metrcPushResult" class="mt-4 p-4 rounded-lg" :class="metrcPushSuccess ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'">
                                        <div class="flex items-center">
                                            <svg x-show="metrcPushSuccess" class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                            </svg>
                                            <svg x-show="!metrcPushSuccess" class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"/>
                                            </svg>
                                            <span class="font-medium" x-text="metrcPushResult"></span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Sales Search and Filters -->
                                <div class="bg-white border border-gray-200 rounded-lg p-6 mb-6">
                                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Search & Filter Sales</h3>
                                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Date Range</label>
                                            <select id="sales-date-range" name="sales-date-range" x-model="salesFilter.dateRange" @change="filterSales()" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" aria-label="Filter sales by date range">
                                                <option value="today">Today</option>
                                                <option value="yesterday">Yesterday</option>
                                                <option value="week">This Week</option>
                                                <option value="month">This Month</option>
                                                <option value="custom">Custom Range</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Customer</label>
                                            <input id="sales-customer-filter" name="sales-customer-filter" type="text" x-model="salesFilter.customer" @input="filterSales()" placeholder="Search by customer name" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" aria-label="Filter sales by customer name">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Amount Range</label>
                                            <select id="sales-amount-range" name="sales-amount-range" x-model="salesFilter.amountRange" @change="filterSales()" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" aria-label="Filter sales by amount range">
                                                <option value="">All Amounts</option>
                                                <option value="0-25">$0 - $25</option>
                                                <option value="25-50">$25 - $50</option>
                                                <option value="50-100">$50 - $100</option>
                                                <option value="100+">$100+</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Payment Method</label>
                                            <select id="sales-payment-method" name="sales-payment-method" x-model="salesFilter.paymentMethod" @change="filterSales()" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" aria-label="Filter sales by payment method">
                                                <option value="">All Methods</option>
                                                <option value="cash">Cash</option>
                                                <option value="debit">Debit</option>
                                                <option value="credit">Credit</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div x-show="salesFilter.dateRange === 'custom'" class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Start Date</label>
                                            <input id="sales-start-date" name="sales-start-date" type="date" x-model="salesFilter.startDate" @change="filterSales()" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" aria-label="Sales filter start date">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">End Date</label>
                                            <input id="sales-end-date" name="sales-end-date" type="date" x-model="salesFilter.endDate" @change="filterSales()" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" aria-label="Sales filter end date">
                                        </div>
                                    </div>
                                </div>

                                <!-- Sales Statistics -->
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M8 11v6h8v-6M8 11H6a2 2 0 00-2 2v6a2 2 0 002 2h12a2 2 0 002-2v-6a2 2 0 00-2-2h-2"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-blue-900">Total Sales</p>
                                                <p class="text-lg font-semibold text-blue-900" x-text="getFilteredSalesStats().totalSales"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-green-900">Total Revenue</p>
                                                <p class="text-lg font-semibold text-green-900" x-text="'$' + getFilteredSalesStats().totalRevenue.toFixed(2)"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-yellow-900">Avg Sale</p>
                                                <p class="text-lg font-semibold text-yellow-900" x-text="'$' + getFilteredSalesStats().avgSale.toFixed(2)"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-purple-900">Customers</p>
                                                <p class="text-lg font-semibold text-purple-900" x-text="getFilteredSalesStats().uniqueCustomers"></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- End of Day Report -->
                                <div class="bg-white border border-gray-200 rounded-lg p-6 mb-6">
                                    <div class="flex items-center justify-between mb-6">
                                        <div class="flex items-center">
                                            <svg class="w-6 h-6 text-indigo-600 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                            </svg>
                                            <h3 class="text-lg font-semibold text-indigo-900">End of Day Report</h3>
                                        </div>
                                        <div class="flex space-x-2">
                                            <button @click="printEndOfDayReport()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors text-sm">
                                                <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                                                </svg>
                                                Print Report
                                            </button>
                                            <button @click="generateEndOfDayReport()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors text-sm">
                                                <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                                                </svg>
                                                Generate Report
                                            </button>
                                        </div>
                                    </div>

                                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                        <!-- Sales Summary -->
                                        <div class="space-y-4">
                                            <h4 class="font-semibold text-gray-900 text-base border-b border-gray-200 pb-2">Sales Summary</h4>
                                            <div class="space-y-3">
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm text-gray-600">Total Sales:</span>
                                                    <span class="font-semibold text-gray-900" x-text="getEndOfDayStats().totalSales"></span>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm text-gray-600">Total Revenue:</span>
                                                    <span class="font-semibold text-green-600" x-text="'$' + getEndOfDayStats().totalRevenue.toFixed(2)"></span>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm text-gray-600">Cash Sales:</span>
                                                    <span class="font-semibold text-gray-900" x-text="'$' + getEndOfDayStats().cashSales.toFixed(2)"></span>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm text-gray-600">Debit Sales:</span>
                                                    <span class="font-semibold text-gray-900" x-text="'$' + getEndOfDayStats().debitSales.toFixed(2)"></span>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm text-gray-600">Credit Sales:</span>
                                                    <span class="font-semibold text-gray-900" x-text="'$' + getEndOfDayStats().creditSales.toFixed(2)"></span>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm text-gray-600">Customer Count:</span>
                                                    <span class="font-semibold text-gray-900" x-text="getEndOfDayStats().customerCount"></span>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm text-gray-600">Average Sale:</span>
                                                    <span class="font-semibold text-gray-900" x-text="'$' + getEndOfDayStats().averageSale.toFixed(2)"></span>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm text-gray-600">Total Discounts:</span>
                                                    <span class="font-semibold text-red-600" x-text="'-$' + getEndOfDayStats().totalDiscounts.toFixed(2)"></span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Till Breakdown & Pace Report -->
                                        <div class="space-y-4">
                                            <h4 class="font-semibold text-gray-900 text-base border-b border-gray-200 pb-2">Till Breakdown & Projections</h4>
                                            <div class="space-y-3">
                                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                                                    <h5 class="font-medium text-blue-900 mb-2">Cash Till Summary</h5>
                                                    <div class="space-y-1 text-sm">
                                                        <div class="flex justify-between">
                                                            <span class="text-blue-700">Opening Amount:</span>
                                                            <span class="font-medium" x-text="'$' + getEndOfDayStats().tillBreakdown.opening.toFixed(2)"></span>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span class="text-blue-700">Cash Sales:</span>
                                                            <span class="font-medium" x-text="'$' + getEndOfDayStats().cashSales.toFixed(2)"></span>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span class="text-blue-700">Expected Total:</span>
                                                            <span class="font-semibold" x-text="'$' + (getEndOfDayStats().tillBreakdown.opening + getEndOfDayStats().cashSales).toFixed(2)"></span>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="bg-green-50 border border-green-200 rounded-lg p-3">
                                                    <h5 class="font-medium text-green-900 mb-2">Sales Pace Report</h5>
                                                    <div class="space-y-1 text-sm">
                                                        <div class="flex justify-between">
                                                            <span class="text-green-700">Current Month Sales:</span>
                                                            <span class="font-medium" x-text="'$' + getEndOfDayStats().paceReport.currentMonthSales.toFixed(2)"></span>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span class="text-green-700">Daily Average:</span>
                                                            <span class="font-medium" x-text="'$' + getEndOfDayStats().paceReport.dailyAverage.toFixed(2)"></span>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span class="text-green-700">Month Projection:</span>
                                                            <span class="font-semibold" x-text="'$' + getEndOfDayStats().paceReport.monthProjection.toFixed(2)"></span>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-3">
                                                    <h5 class="font-medium text-purple-900 mb-2">Customer Pace Report</h5>
                                                    <div class="space-y-1 text-sm">
                                                        <div class="flex justify-between">
                                                            <span class="text-purple-700">Month Customers:</span>
                                                            <span class="font-medium" x-text="getEndOfDayStats().customerPaceReport.currentMonthCustomers"></span>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span class="text-purple-700">Daily Average:</span>
                                                            <span class="font-medium" x-text="getEndOfDayStats().customerPaceReport.dailyAverage.toFixed(1)"></span>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span class="text-purple-700">Month Projection:</span>
                                                            <span class="font-semibold" x-text="Math.round(getEndOfDayStats().customerPaceReport.monthProjection)"></span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Report Info -->
                                    <div class="mt-6 pt-4 border-t border-gray-200">
                                        <div class="flex justify-between items-center text-sm text-gray-600">
                                            <div>
                                                <span>Report generated by: </span>
                                                <span class="font-medium" x-text="getCurrentEmployee()"></span>
                                                <span class="mx-2">•</span>
                                                <span x-text="'Date: ' + new Date().toLocaleDateString()"></span>
                                                <span class="mx-2">•</span>
                                                <span x-text="'Time: ' + new Date().toLocaleTimeString()"></span>
                                            </div>
                                            <div x-show="endOfDayReportGenerated" class="text-green-600 font-medium">
                                                ✓ Report Generated
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Sales Table -->
                                <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="p-6 border-b border-gray-200">
                                        <div class="flex items-center justify-between">
                                            <h3 class="text-lg font-semibold text-gray-900">Sales Transactions</h3>
                                            <div class="flex items-center gap-2">
                                                <span class="text-sm text-gray-500" x-text="'Showing ' + filteredSales.length + ' transactions'"></span>
                                                <button @click="refreshSales()" class="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                                    Refresh
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="w-full">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date/Time</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Transaction ID</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Customer</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Items</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Discounts</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Payment</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Employee</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <template x-for="sale in filteredSales.slice(0, 50)" :key="sale.id">
                                                    <tr class="hover:bg-gray-50">
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" x-text="new Date(sale.date).toLocaleString()"></td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600" x-text="sale.id"></td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <div class="text-sm font-medium text-gray-900" x-text="sale.customer"></div>
                                                            <div x-show="sale.isMedical" class="text-xs text-green-600">Medical</div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" x-text="sale.itemCount + ' items'"></td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900" x-text="'$' + sale.total.toFixed(2)"></td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <div x-show="sale.discounts && sale.discounts.length > 0" class="space-y-1">
                                                                <template x-for="discount in sale.discounts" :key="discount.id">
                                                                    <div class="text-xs">
                                                                        <span class="inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800" x-text="discount.type"></span>
                                                                        <span class="text-green-600 font-medium" x-text="'-$' + discount.amount.toFixed(2)"></span>
                                                                    </div>
                                                                </template>
                                                                <div class="text-xs text-gray-500" x-text="'Total: -$' + sale.discounts.reduce((sum, d) => sum + d.amount, 0).toFixed(2)"></div>
                                                            </div>
                                                            <div x-show="!sale.discounts || sale.discounts.length === 0" class="text-xs text-gray-400">
                                                                No discounts
                                                            </div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                                                  :class="sale.paymentMethod === 'cash' ? 'bg-green-100 text-green-800' : 'bg-blue-100 text-blue-800'"
                                                                  x-text="sale.paymentMethod.charAt(0).toUpperCase() + sale.paymentMethod.slice(1)">
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" x-text="sale.employee"></td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <button @click="viewSaleDetails(sale)" class="text-blue-600 hover:text-blue-900 mr-2">View</button>
                                                            <button @click="reprintReceipt(sale)" class="text-green-600 hover:text-green-900 mr-2">Reprint</button>
                                                            <button @click="voidSale(sale)" class="text-orange-600 hover:text-orange-900 mr-2" :disabled="sale.isVoided">
                                                                <span x-text="sale.isVoided ? 'Voided' : 'Void'"></span>
                                                            </button>
                                                            <button @click="refundSale(sale)" class="text-red-600 hover:text-red-900">Refund</button>
                                                        </td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div x-show="filteredSales.length === 0" class="p-8 text-center text-gray-500">
                                        <svg class="w-12 h-12 mx-auto text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                        </svg>
                                        <p>No sales found matching your criteria</p>
                                    </div>
                                </div>
                                <div class="border border-gray-200 rounded-lg p-4">
                                    <p class="text-gray-600">Laravel Implementation: <code class="bg-gray-100 px-2 py-1 rounded text-sm">/sales</code></p>
                                    <p class="text-sm text-gray-500 mt-1">Comprehensive sales tracking with audit trail and METRC integration.</p>
                                </div>
                            </div>
                        </template>

                        <template x-if="currentPage === 'order-queue'">
                            <div class="space-y-6">
                                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <svg class="w-5 h-5 text-yellow-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"/>
                                            </svg>
                                            <span class="text-yellow-800 font-medium">Order Queue Management</span>
                                        </div>
                                        <button @click="refreshOrderQueue()" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 transition-colors text-sm flex items-center gap-2">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                                            </svg>
                                            Refresh Queue
                                        </button>
                                    </div>
                                    <p class="text-yellow-700 text-sm mt-1">Manage pending orders, hold orders, and customer pickup queue.</p>
                                </div>

                                <!-- Order Queue Analytics -->
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-blue-900">Pending Orders</p>
                                                <p class="text-lg font-semibold text-blue-900" x-text="getOrderQueueStats().pendingOrders"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-orange-900">Hold Orders</p>
                                                <p class="text-lg font-semibold text-orange-900" x-text="getOrderQueueStats().holdOrders"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-green-900">Ready for Pickup</p>
                                                <p class="text-lg font-semibold text-green-900" x-text="getOrderQueueStats().readyOrders"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-purple-900">Total Value</p>
                                                <p class="text-lg font-semibold text-purple-900" x-text="'$' + getOrderQueueStats().totalValue.toFixed(2)"></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Queue Filters -->
                                <div class="bg-white border border-gray-200 rounded-lg p-6">
                                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Filter Orders</h3>
                                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                            <select x-model="orderQueueFilter.status" @change="filterOrderQueue()" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                                                <option value="">All Orders</option>
                                                <option value="pending">Pending</option>
                                                <option value="hold">On Hold</option>
                                                <option value="ready">Ready</option>
                                                <option value="processing">Processing</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Order Type</label>
                                            <select x-model="orderQueueFilter.orderType" @change="filterOrderQueue()" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                                                <option value="">All Types</option>
                                                <option value="online">Online Orders</option>
                                                <option value="phone">Phone Orders</option>
                                                <option value="pos-hold">POS Hold</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Customer</label>
                                            <input type="text" x-model="orderQueueFilter.customer" @input="filterOrderQueue()" placeholder="Search by customer name" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Date Range</label>
                                            <select x-model="orderQueueFilter.dateRange" @change="filterOrderQueue()" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                                                <option value="today">Today</option>
                                                <option value="yesterday">Yesterday</option>
                                                <option value="week">This Week</option>
                                                <option value="all">All Time</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <!-- Order Queue List -->
                                <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="p-6 border-b border-gray-200">
                                        <div class="flex items-center justify-between">
                                            <h3 class="text-lg font-semibold text-gray-900">Order Queue</h3>
                                            <span class="text-sm text-gray-500" x-text="'Showing ' + filteredOrderQueue.length + ' orders'"></span>
                                        </div>
                                    </div>
                                    <div class="space-y-0">
                                        <template x-for="order in filteredOrderQueue" :key="order.id">
                                            <div class="border-b border-gray-200 p-6 hover:bg-gray-50 transition-colors">
                                                <div class="flex items-start justify-between">
                                                    <!-- Order Info -->
                                                    <div class="flex-1">
                                                        <div class="flex items-center justify-between mb-3">
                                                            <div class="flex items-center space-x-3">
                                                                <h4 class="text-lg font-semibold text-gray-900" x-text="'Order #' + order.id"></h4>
                                                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                                                      :class="getOrderStatusClass(order.status)"
                                                                      x-text="order.status.charAt(0).toUpperCase() + order.status.slice(1)">
                                                                </span>
                                                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"
                                                                      x-text="order.orderType">
                                                                </span>
                                                            </div>
                                                            <div class="text-right">
                                                                <p class="text-lg font-semibold text-gray-900" x-text="'$' + order.total.toFixed(2)"></p>
                                                                <p class="text-sm text-gray-500" x-text="order.itemCount + ' items'"></p>
                                                            </div>
                                                        </div>

                                                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                                            <!-- Customer Information -->
                                                            <div>
                                                                <h5 class="font-medium text-gray-900 mb-2">Customer Information</h5>
                                                                <div class="space-y-1 text-sm">
                                                                    <p><span class="text-gray-600">Name:</span> <span class="font-medium" x-text="order.customer.name"></span></p>
                                                                    <p><span class="text-gray-600">Phone:</span> <span x-text="order.customer.phone"></span></p>
                                                                    <p><span class="text-gray-600">Email:</span> <span x-text="order.customer.email"></span></p>
                                                                    <div x-show="order.customer.isMedical" class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                                                        Medical Patient
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <!-- Order Details -->
                                                            <div>
                                                                <h5 class="font-medium text-gray-900 mb-2">Order Details</h5>
                                                                <div class="space-y-1 text-sm">
                                                                    <p><span class="text-gray-600">Placed:</span> <span x-text="new Date(order.placedAt).toLocaleString()"></span></p>
                                                                    <p><span class="text-gray-600">Type:</span> <span x-text="order.orderType"></span></p>
                                                                    <p><span class="text-gray-600">Payment:</span> <span x-text="order.paymentMethod || 'Not processed'"></span></p>
                                                                    <div x-show="order.notes" class="mt-2">
                                                                        <span class="text-gray-600">Notes:</span>
                                                                        <p class="text-gray-800 mt-1" x-text="order.notes"></p>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <!-- Items -->
                                                            <div>
                                                                <h5 class="font-medium text-gray-900 mb-2">Items</h5>
                                                                <div class="space-y-2 max-h-32 overflow-y-auto">
                                                                    <template x-for="item in order.items" :key="item.id">
                                                                        <div class="flex justify-between items-center text-sm">
                                                                            <span class="text-gray-900" x-text="item.quantity + 'x ' + item.name"></span>
                                                                            <span class="font-medium" x-text="'$' + item.price.toFixed(2)"></span>
                                                                        </div>
                                                                    </template>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <!-- Actions -->
                                                    <div class="ml-6 flex flex-col space-y-2 flex-shrink-0">
                                                        <button @click="moveToActiveCart(order)"
                                                                :disabled="order.status === 'processing'"
                                                                class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm">
                                                            Move to Cart
                                                        </button>
                                                        <button @click="printOrderReceipt(order)" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 text-sm">
                                                            Print Receipt
                                                        </button>
                                                        <button @click="updateOrderStatus(order, 'ready')"
                                                                x-show="order.status === 'pending'"
                                                                class="bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 text-sm">
                                                            Mark Ready
                                                        </button>
                                                        <button @click="updateOrderStatus(order, 'hold')"
                                                                x-show="order.status === 'pending'"
                                                                class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 text-sm">
                                                            Put on Hold
                                                        </button>
                                                        <button @click="cancelOrder(order)"
                                                                :disabled="order.status === 'processing'"
                                                                class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm">
                                                            Cancel
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </template>
                                    </div>

                                    <div x-show="filteredOrderQueue.length === 0" class="p-8 text-center text-gray-500">
                                        <svg class="w-12 h-12 mx-auto text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"/>
                                        </svg>
                                        <p>No orders found in the queue</p>
                                    </div>
                                </div>

                                <div class="border border-gray-200 rounded-lg p-4">
                                    <p class="text-gray-600">Laravel Implementation: <code class="bg-gray-100 px-2 py-1 rounded text-sm">/order-queue</code></p>
                                    <p class="text-sm text-gray-500 mt-1">Queue management with status tracking, customer info, and receipt printing.</p>
                                </div>
                            </div>
                        </template>

                        <template x-if="currentPage === 'inventory-evaluation'">
                            <div class="space-y-6">
                                <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <svg class="w-5 h-5 text-indigo-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a4 4 0 01-4-4V5a4 4 0 014-4h10a4 4 0 014 4v14a4 4 0 01-4 4z"/>
                                            </svg>
                                            <span class="text-indigo-800 font-medium">Inventory Evaluation Report</span>
                                        </div>
                                        <div class="flex space-x-2">
                                            <button @click="exportInventoryReport()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors text-sm">
                                                <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                                </svg>
                                                Export Report
                                            </button>
                                            <button @click="refreshInventoryEvaluation()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors text-sm">
                                                <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                                                </svg>
                                                Refresh
                                            </button>
                                        </div>
                                    </div>
                                    <p class="text-indigo-700 text-sm mt-1">Comprehensive inventory valuation and aging reports with cost breakdowns and profit analysis.</p>
                                </div>

                                <!-- Overall Summary Cards -->
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-blue-900">Total Cost Value</p>
                                                <p class="text-lg font-semibold text-blue-900" x-text="'$' + getInventoryEvaluation().totalCost.toFixed(2)"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-green-900">Total Retail Value</p>
                                                <p class="text-lg font-semibold text-green-900" x-text="'$' + getInventoryEvaluation().totalRetail.toFixed(2)"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-purple-900">Potential Profit</p>
                                                <p class="text-lg font-semibold text-purple-900" x-text="'$' + getInventoryEvaluation().totalProfit.toFixed(2)"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-orange-900">Avg Margin</p>
                                                <p class="text-lg font-semibold text-orange-900" x-text="getInventoryEvaluation().averageMargin.toFixed(1) + '%'"></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Category Breakdown -->
                                <div class="bg-white border border-gray-200 rounded-lg">
                                    <div class="p-6 border-b border-gray-200">
                                        <h3 class="text-lg font-semibold text-gray-900">Inventory Breakdown by Category</h3>
                                        <p class="text-sm text-gray-600 mt-1">Click on categories to expand and view individual products</p>
                                    </div>
                                    <div class="space-y-0">
                                        <template x-for="(categoryData, categoryName) in getCategoryBreakdown()" :key="categoryName">
                                            <div class="border-b border-gray-200 last:border-b-0">
                                                <!-- Category Header -->
                                                <div @click="toggleCategoryExpansion(categoryName)"
                                                     class="p-6 hover:bg-gray-50 cursor-pointer transition-colors">
                                                    <div class="flex items-center justify-between">
                                                        <div class="flex items-center space-x-3">
                                                            <svg class="w-5 h-5 text-gray-400 transition-transform"
                                                                 :class="expandedCategories.includes(categoryName) ? 'rotate-90' : ''"
                                                                 fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                                            </svg>
                                                            <h4 class="text-lg font-semibold text-gray-900" x-text="categoryName"></h4>
                                                            <span class="text-sm text-gray-500" x-text="'(' + categoryData.productCount + ' products)'"></span>
                                                        </div>
                                                        <div class="grid grid-cols-4 gap-6 text-right">
                                                            <div>
                                                                <p class="text-sm text-gray-600">Cost Value</p>
                                                                <p class="font-semibold text-blue-600" x-text="'$' + categoryData.totalCost.toFixed(2)"></p>
                                                            </div>
                                                            <div>
                                                                <p class="text-sm text-gray-600">Retail Value</p>
                                                                <p class="font-semibold text-green-600" x-text="'$' + categoryData.totalRetail.toFixed(2)"></p>
                                                            </div>
                                                            <div>
                                                                <p class="text-sm text-gray-600">Potential Profit</p>
                                                                <p class="font-semibold text-purple-600" x-text="'$' + categoryData.totalProfit.toFixed(2)"></p>
                                                            </div>
                                                            <div>
                                                                <p class="text-sm text-gray-600">Margin</p>
                                                                <p class="font-semibold text-orange-600" x-text="categoryData.averageMargin.toFixed(1) + '%'"></p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- Expanded Category Products -->
                                                <div x-show="expandedCategories.includes(categoryName)"
                                                     x-transition:enter="transition ease-out duration-300"
                                                     x-transition:enter-start="opacity-0 max-h-0"
                                                     x-transition:enter-end="opacity-100 max-h-screen"
                                                     x-transition:leave="transition ease-in duration-200"
                                                     x-transition:leave-start="opacity-100 max-h-screen"
                                                     x-transition:leave-end="opacity-0 max-h-0"
                                                     class="bg-gray-50 overflow-hidden">
                                                    <div class="px-6 py-4">
                                                        <div class="overflow-x-auto">
                                                            <table class="w-full text-sm">
                                                                <thead class="bg-gray-100">
                                                                    <tr>
                                                                        <th class="px-4 py-2 text-left font-medium text-gray-700">Product</th>
                                                                        <th class="px-4 py-2 text-right font-medium text-gray-700">Stock</th>
                                                                        <th class="px-4 py-2 text-right font-medium text-gray-700">Cost/Unit</th>
                                                                        <th class="px-4 py-2 text-right font-medium text-gray-700">Total Cost</th>
                                                                        <th class="px-4 py-2 text-right font-medium text-gray-700">Retail/Unit</th>
                                                                        <th class="px-4 py-2 text-right font-medium text-gray-700">Total Retail</th>
                                                                        <th class="px-4 py-2 text-right font-medium text-gray-700">Profit/Unit</th>
                                                                        <th class="px-4 py-2 text-right font-medium text-gray-700">Total Profit</th>
                                                                        <th class="px-4 py-2 text-right font-medium text-gray-700">Margin %</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody class="divide-y divide-gray-200">
                                                                    <template x-for="product in categoryData.products" :key="product.id">
                                                                        <tr class="hover:bg-white">
                                                                            <td class="px-4 py-2">
                                                                                <div>
                                                                                    <p class="font-medium text-gray-900" x-text="product.name"></p>
                                                                                    <p class="text-xs text-gray-500" x-text="'SKU: ' + (product.sku || 'N/A')"></p>
                                                                                </div>
                                                                            </td>
                                                                            <td class="px-4 py-2 text-right" x-text="product.stock"></td>
                                                                            <td class="px-4 py-2 text-right" x-text="'$' + (product.cost || 0).toFixed(2)"></td>
                                                                            <td class="px-4 py-2 text-right font-medium text-blue-600" x-text="'$' + ((product.cost || 0) * product.stock).toFixed(2)"></td>
                                                                            <td class="px-4 py-2 text-right" x-text="'$' + product.price.toFixed(2)"></td>
                                                                            <td class="px-4 py-2 text-right font-medium text-green-600" x-text="'$' + (product.price * product.stock).toFixed(2)"></td>
                                                                            <td class="px-4 py-2 text-right" x-text="'$' + (product.price - (product.cost || 0)).toFixed(2)"></td>
                                                                            <td class="px-4 py-2 text-right font-medium text-purple-600" x-text="'$' + ((product.price - (product.cost || 0)) * product.stock).toFixed(2)"></td>
                                                                            <td class="px-4 py-2 text-right font-medium text-orange-600"
                                                                                x-text="(product.cost > 0 ? (((product.price - product.cost) / product.price) * 100).toFixed(1) : '0.0') + '%'"></td>
                                                                        </tr>
                                                                    </template>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                </div>

                                <!-- Aging Analysis -->
                                <div class="bg-white border border-gray-200 rounded-lg p-6">
                                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Inventory Aging Analysis</h3>
                                    <p class="text-sm text-gray-600 mb-4">Click on any aging category to view the specific items in that time period</p>
                                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                        <button @click="openAgingModal('fresh', '0-30 Days')" class="bg-green-50 border border-green-200 rounded-lg p-4 hover:bg-green-100 transition-colors cursor-pointer text-left">
                                            <h4 class="font-medium text-green-900 flex items-center justify-between">
                                                0-30 Days
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                                </svg>
                                            </h4>
                                            <p class="text-2xl font-bold text-green-900" x-text="getAgingAnalysis().fresh + ' items'"></p>
                                            <p class="text-sm text-green-700">Fresh inventory</p>
                                        </button>
                                        <button @click="openAgingModal('moderate', '31-60 Days')" class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 hover:bg-yellow-100 transition-colors cursor-pointer text-left">
                                            <h4 class="font-medium text-yellow-900 flex items-center justify-between">
                                                31-60 Days
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                                </svg>
                                            </h4>
                                            <p class="text-2xl font-bold text-yellow-900" x-text="getAgingAnalysis().moderate + ' items'"></p>
                                            <p class="text-sm text-yellow-700">Moderate aging</p>
                                        </button>
                                        <button @click="openAgingModal('aging', '61-90 Days')" class="bg-orange-50 border border-orange-200 rounded-lg p-4 hover:bg-orange-100 transition-colors cursor-pointer text-left">
                                            <h4 class="font-medium text-orange-900 flex items-center justify-between">
                                                61-90 Days
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                                </svg>
                                            </h4>
                                            <p class="text-2xl font-bold text-orange-900" x-text="getAgingAnalysis().aging + ' items'"></p>
                                            <p class="text-sm text-orange-700">Aging inventory</p>
                                        </button>
                                        <button @click="openAgingModal('stale', '90+ Days')" class="bg-red-50 border border-red-200 rounded-lg p-4 hover:bg-red-100 transition-colors cursor-pointer text-left">
                                            <h4 class="font-medium text-red-900 flex items-center justify-between">
                                                90+ Days
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                                </svg>
                                            </h4>
                                            <p class="text-2xl font-bold text-red-900" x-text="getAgingAnalysis().stale + ' items'"></p>
                                            <p class="text-sm text-red-700">Stale inventory</p>
                                        </button>
                                    </div>
                                </div>

                                <div class="border border-gray-200 rounded-lg p-4">
                                    <p class="text-gray-600">Laravel Implementation: <code class="bg-gray-100 px-2 py-1 rounded text-sm">/reports/inventory-evaluation</code></p>
                                    <p class="text-sm text-gray-500 mt-1">Advanced reporting with cost breakdowns, profit margins, and expandable category views.</p>
                                </div>
                            </div>
                        </template>

                        <template x-if="currentPage === 'analytics'">
                            <div class="space-y-6">
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <svg class="w-5 h-5 text-blue-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                                            </svg>
                                            <span class="text-blue-800 font-medium">Business Analytics Dashboard</span>
                                        </div>
                                        <div class="flex items-center space-x-3">
                                            <select x-model="analyticsView" @change="refreshAnalytics()" class="px-3 py-2 text-sm border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                                <option value="company">Company-Wide View</option>
                                                <option value="store1">Downtown Store</option>
                                                <option value="store2">Eastside Store</option>
                                                <option value="store3">Westport Store</option>
                                            </select>
                                            <button @click="exportAnalyticsReport()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm">
                                                Export Report
                                            </button>
                                        </div>
                                    </div>
                                    <p class="text-blue-700 text-sm mt-1">Comprehensive business intelligence and performance metrics with company-wide and individual store analysis.</p>
                                </div>

                                <!-- Key Performance Indicators -->
                                <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-green-900">Total Sales</p>
                                                <p class="text-lg font-semibold text-green-900" x-text="'$' + getAnalyticsData().totalSales.toFixed(2)"></p>
                                                <p class="text-xs text-green-700" x-text="getAnalyticsData().salesGrowth >= 0 ? '+' + getAnalyticsData().salesGrowth.toFixed(1) + '% from last month' : getAnalyticsData().salesGrowth.toFixed(1) + '% from last month'"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-blue-900">Customer Count</p>
                                                <p class="text-lg font-semibold text-blue-900" x-text="getAnalyticsData().customerCount"></p>
                                                <p class="text-xs text-blue-700" x-text="getAnalyticsData().customerGrowth >= 0 ? '+' + getAnalyticsData().customerGrowth.toFixed(1) + '% from last month' : getAnalyticsData().customerGrowth.toFixed(1) + '% from last month'"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M8 11v6h8v-6M8 11H6a2 2 0 00-2 2v6a2 2 0 002 2h12a2 2 0 002-2v-6a2 2 0 00-2-2h-2"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-purple-900">Avg Transaction</p>
                                                <p class="text-lg font-semibold text-purple-900" x-text="'$' + getAnalyticsData().avgTransaction.toFixed(2)"></p>
                                                <p class="text-xs text-purple-700" x-text="getAnalyticsData().avgItems.toFixed(1) + ' items per transaction'"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-orange-900">Growth Rate</p>
                                                <p class="text-lg font-semibold text-orange-900" x-text="getAnalyticsData().overallGrowth >= 0 ? '+' + getAnalyticsData().overallGrowth.toFixed(1) + '%' : getAnalyticsData().overallGrowth.toFixed(1) + '%'"></p>
                                                <p class="text-xs text-orange-700">Monthly growth trend</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v13m0-13V6a2 2 0 112 0v1m-2 0V6a2 2 0 00-2 0v1m2 0h.01M12 21h.01"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-yellow-900">Top Discounts</p>
                                                <p class="text-lg font-semibold text-yellow-900" x-text="'$' + getAnalyticsData().totalDiscounts.toFixed(2)"></p>
                                                <p class="text-xs text-yellow-700" x-text="getAnalyticsData().discountPercentage.toFixed(1) + '% of total sales'"></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Top Products and Vendors -->
                                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                    <!-- Top Selling Products -->
                                    <div class="bg-white border border-gray-200 rounded-lg">
                                        <div class="p-6 border-b border-gray-200">
                                            <h3 class="text-lg font-semibold text-gray-900">Top Selling Products</h3>
                                            <p class="text-sm text-gray-600 mt-1">Best performing products by revenue</p>
                                        </div>
                                        <div class="p-6">
                                            <div class="space-y-4">
                                                <template x-for="(product, index) in getTopProducts()" :key="product.name">
                                                    <div class="flex items-center justify-between">
                                                        <div class="flex items-center space-x-3">
                                                            <div class="w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-semibold" x-text="index + 1"></div>
                                                            <div>
                                                                <p class="font-medium text-gray-900" x-text="product.name"></p>
                                                                <p class="text-sm text-gray-500" x-text="product.category"></p>
                                                            </div>
                                                        </div>
                                                        <div class="text-right">
                                                            <p class="font-semibold text-gray-900" x-text="'$' + product.revenue.toFixed(2)"></p>
                                                            <p class="text-sm text-gray-500" x-text="product.units + ' units sold'"></p>
                                                        </div>
                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Top Vendors -->
                                    <div class="bg-white border border-gray-200 rounded-lg">
                                        <div class="p-6 border-b border-gray-200">
                                            <h3 class="text-lg font-semibold text-gray-900">Top Vendors</h3>
                                            <p class="text-sm text-gray-600 mt-1">Best performing vendors by sales volume</p>
                                        </div>
                                        <div class="p-6">
                                            <div class="space-y-4">
                                                <template x-for="(vendor, index) in getTopVendors()" :key="vendor.name">
                                                    <div class="flex items-center justify-between">
                                                        <div class="flex items-center space-x-3">
                                                            <div class="w-8 h-8 bg-green-100 text-green-600 rounded-full flex items-center justify-center text-sm font-semibold" x-text="index + 1"></div>
                                                            <div>
                                                                <p class="font-medium text-gray-900" x-text="vendor.name"></p>
                                                                <p class="text-sm text-gray-500" x-text="vendor.productCount + ' products'"></p>
                                                            </div>
                                                        </div>
                                                        <div class="text-right">
                                                            <p class="font-semibold text-gray-900" x-text="'$' + vendor.revenue.toFixed(2)"></p>
                                                            <p class="text-sm text-gray-500" x-text="vendor.units + ' units sold'"></p>
                                                        </div>
                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Store Comparison (Company-wide view only) -->
                                <div x-show="analyticsView === 'company'" class="bg-white border border-gray-200 rounded-lg">
                                    <div class="p-6 border-b border-gray-200">
                                        <h3 class="text-lg font-semibold text-gray-900">Store Performance Comparison</h3>
                                        <p class="text-sm text-gray-600 mt-1">Performance metrics across all store locations</p>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="w-full">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Store</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Revenue</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Customers</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Avg Transaction</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Growth</th>
                                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Performance</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <template x-for="store in getStoreComparison()" :key="store.id">
                                                    <tr class="hover:bg-gray-50">
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <div>
                                                                <div class="text-sm font-medium text-gray-900" x-text="store.name"></div>
                                                                <div class="text-sm text-gray-500" x-text="store.location"></div>
                                                            </div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium text-gray-900" x-text="'$' + store.revenue.toFixed(2)"></td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900" x-text="store.customers"></td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900" x-text="'$' + store.avgTransaction.toFixed(2)"></td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm"
                                                            :class="store.growth >= 0 ? 'text-green-600' : 'text-red-600'"
                                                            x-text="(store.growth >= 0 ? '+' : '') + store.growth.toFixed(1) + '%'"></td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-right">
                                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                                                  :class="store.performance === 'Excellent' ? 'bg-green-100 text-green-800' :
                                                                          store.performance === 'Good' ? 'bg-blue-100 text-blue-800' :
                                                                          store.performance === 'Average' ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800'"
                                                                  x-text="store.performance">
                                                            </span>
                                                        </td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <!-- Discount Analysis -->
                                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                    <!-- Most Used Discounts -->
                                    <div class="bg-white border border-gray-200 rounded-lg">
                                        <div class="p-6 border-b border-gray-200">
                                            <h3 class="text-lg font-semibold text-gray-900">Most Used Discounts</h3>
                                            <p class="text-sm text-gray-600 mt-1">Popular discount types and usage frequency</p>
                                        </div>
                                        <div class="p-6">
                                            <div class="space-y-4">
                                                <template x-for="discount in getTopDiscounts()" :key="discount.type">
                                                    <div class="flex items-center justify-between">
                                                        <div>
                                                            <p class="font-medium text-gray-900" x-text="discount.type"></p>
                                                            <p class="text-sm text-gray-500" x-text="discount.count + ' times used'"></p>
                                                        </div>
                                                        <div class="text-right">
                                                            <p class="font-semibold text-gray-900" x-text="'$' + discount.totalSaved.toFixed(2)"></p>
                                                            <p class="text-sm text-gray-500" x-text="discount.avgDiscount.toFixed(1) + '% avg'"></p>
                                                        </div>
                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Performance Metrics -->
                                    <div class="bg-white border border-gray-200 rounded-lg">
                                        <div class="p-6 border-b border-gray-200">
                                            <h3 class="text-lg font-semibold text-gray-900">Key Performance Metrics</h3>
                                            <p class="text-sm text-gray-600 mt-1">Important business indicators and trends</p>
                                        </div>
                                        <div class="p-6">
                                            <div class="space-y-6">
                                                <div>
                                                    <div class="flex justify-between items-center mb-2">
                                                        <span class="text-sm font-medium text-gray-700">Customer Retention Rate</span>
                                                        <span class="text-sm font-semibold text-green-600" x-text="getAnalyticsData().retentionRate.toFixed(1) + '%'"></span>
                                                    </div>
                                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                                        <div class="bg-green-600 h-2 rounded-full" :style="`width: ${getAnalyticsData().retentionRate}%`"></div>
                                                    </div>
                                                </div>
                                                <div>
                                                    <div class="flex justify-between items-center mb-2">
                                                        <span class="text-sm font-medium text-gray-700">Inventory Turnover</span>
                                                        <span class="text-sm font-semibold text-blue-600" x-text="getAnalyticsData().inventoryTurnover.toFixed(1) + 'x/month'"></span>
                                                    </div>
                                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                                        <div class="bg-blue-600 h-2 rounded-full" :style="`width: ${Math.min(getAnalyticsData().inventoryTurnover * 20, 100)}%`"></div>
                                                    </div>
                                                </div>
                                                <div>
                                                    <div class="flex justify-between items-center mb-2">
                                                        <span class="text-sm font-medium text-gray-700">Profit Margin</span>
                                                        <span class="text-sm font-semibold text-purple-600" x-text="getAnalyticsData().profitMargin.toFixed(1) + '%'"></span>
                                                    </div>
                                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                                        <div class="bg-purple-600 h-2 rounded-full" :style="`width: ${getAnalyticsData().profitMargin}%`"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="border border-gray-200 rounded-lg p-4">
                                    <p class="text-gray-600">Laravel Implementation: <code class="bg-gray-100 px-2 py-1 rounded text-sm">/analytics</code></p>
                                    <p class="text-sm text-gray-500 mt-1">Interactive charts and KPI dashboards with multi-store support and growth analysis.</p>
                                </div>
                            </div>
                        </template>

                        <template x-if="currentPage === 'reports'">
                            <div class="space-y-6">
                                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 text-gray-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                        </svg>
                                        <span class="text-gray-800 font-medium">Pre-Generated Reports</span>
                                    </div>
                                    <p class="text-gray-700 text-sm mt-1">Cannabis business and compliance reports with customizable filters.</p>
                                </div>

                                <!-- Report Filters -->
                                <div class="bg-white border border-gray-200 rounded-lg p-6">
                                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Report Filters</h3>
                                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Store</label>
                                            <select x-model="reportFilters.store" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                                <option value="all">All Stores</option>
                                                <option value="main">Main Store</option>
                                                <option value="north">North Location</option>
                                                <option value="downtown">Downtown</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Date Range</label>
                                            <select x-model="reportFilters.dateRange" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                                <option value="today">Today</option>
                                                <option value="week">This Week</option>
                                                <option value="month">This Month</option>
                                                <option value="quarter">This Quarter</option>
                                                <option value="year">This Year</option>
                                                <option value="custom">Custom Range</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Category</label>
                                            <select x-model="reportFilters.category" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                                <option value="all">All Categories</option>
                                                <option value="flower">Flower</option>
                                                <option value="edibles">Edibles</option>
                                                <option value="concentrates">Concentrates</option>
                                                <option value="topicals">Topicals</option>
                                                <option value="accessories">Accessories</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Room</label>
                                            <select x-model="reportFilters.room" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                                <option value="all">All Rooms</option>
                                                <option value="rec">Recreational</option>
                                                <option value="medical">Medical</option>
                                                <option value="storage">Storage</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <!-- Pre-Generated Reports -->
                                <div class="bg-white border border-gray-200 rounded-lg p-6">
                                    <h3 class="text-lg font-semibold text-gray-900 mb-6">Available Reports</h3>
                                    <div class="space-y-4">
                                        <!-- Daily Sales Report -->
                                        <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors">
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center">
                                                    <svg class="w-8 h-8 text-green-600 mr-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                                    </svg>
                                                    <div>
                                                        <h4 class="font-semibold text-gray-900">Daily Sales Report</h4>
                                                        <p class="text-sm text-gray-600">Complete daily sales summary with payment breakdowns and pace calculations</p>
                                                    </div>
                                                </div>
                                                <div class="flex space-x-2">
                                                    <button @click="generateReport('daily-sales')" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors text-sm">
                                                        <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                                        </svg>
                                                        Generate
                                                    </button>
                                                    <button @click="printReport('daily-sales')" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors text-sm">
                                                        <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                                                        </svg>
                                                        Print
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Inventory Report -->
                                        <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors">
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center">
                                                    <svg class="w-8 h-8 text-blue-600 mr-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                                                    </svg>
                                                    <div>
                                                        <h4 class="font-semibold text-gray-900">Inventory Report</h4>
                                                        <p class="text-sm text-gray-600">Current stock levels, low stock alerts, and inventory valuation</p>
                                                    </div>
                                                </div>
                                                <div class="flex space-x-2">
                                                    <button @click="generateReport('inventory')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm">
                                                        <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                                        </svg>
                                                        Generate
                                                    </button>
                                                    <button @click="printReport('inventory')" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors text-sm">
                                                        <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                                                        </svg>
                                                        Print
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Compliance Report -->
                                        <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors">
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center">
                                                    <svg class="w-8 h-8 text-purple-600 mr-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                                                    </svg>
                                                    <div>
                                                        <h4 class="font-semibold text-gray-900">Compliance Report (METRC)</h4>
                                                        <p class="text-sm text-gray-600">METRC vs inventory variances and Oregon OLCC compliance status</p>
                                                    </div>
                                                </div>
                                                <div class="flex space-x-2">
                                                    <button @click="generateReport('compliance')" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors text-sm">
                                                        <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                                        </svg>
                                                        Generate
                                                    </button>
                                                    <button @click="printReport('compliance')" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors text-sm">
                                                        <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                                                        </svg>
                                                        Print
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Penny Sale Report -->
                                        <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors">
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center">
                                                    <svg class="w-8 h-8 text-yellow-600 mr-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
                                                    </svg>
                                                    <div>
                                                        <h4 class="font-semibold text-gray-900">Penny Sale Report</h4>
                                                        <p class="text-sm text-gray-600">Items sold at discounted prices and promotional sale analysis</p>
                                                    </div>
                                                </div>
                                                <div class="flex space-x-2">
                                                    <button @click="generateReport('penny-sale')" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 transition-colors text-sm">
                                                        <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                                        </svg>
                                                        Generate
                                                    </button>
                                                    <button @click="printReport('penny-sale')" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors text-sm">
                                                        <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                                                        </svg>
                                                        Print
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Employee Performance Report -->
                                        <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors">
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center">
                                                    <svg class="w-8 h-8 text-red-600 mr-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                                                    </svg>
                                                    <div>
                                                        <h4 class="font-semibold text-gray-900">Employee Performance Report</h4>
                                                        <p class="text-sm text-gray-600">Sales metrics, transaction counts, and performance rankings by employee</p>
                                                    </div>
                                                </div>
                                                <div class="flex space-x-2">
                                                    <button @click="generateReport('employee-performance')" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors text-sm">
                                                        <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                                        </svg>
                                                        Generate
                                                    </button>
                                                    <button @click="printReport('employee-performance')" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors text-sm">
                                                        <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                                                        </svg>
                                                        Print
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Payroll Report -->
                                        <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors">
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center">
                                                    <svg class="w-8 h-8 text-indigo-600 mr-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
                                                    </svg>
                                                    <div>
                                                        <h4 class="font-semibold text-gray-900">Payroll Report</h4>
                                                        <p class="text-sm text-gray-600">Employee hours, wages, and payroll calculations with tax withholdings</p>
                                                    </div>
                                                </div>
                                                <div class="flex space-x-2">
                                                    <button @click="generateReport('payroll')" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors text-sm">
                                                        <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                                        </svg>
                                                        Generate
                                                    </button>
                                                    <button @click="printReport('payroll')" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors text-sm">
                                                        <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                                                        </svg>
                                                        Print
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Generated Report Display -->
                                <div x-show="currentReport" class="bg-white border border-gray-200 rounded-lg p-6">
                                    <div class="flex items-center justify-between mb-4">
                                        <h3 class="text-lg font-semibold text-gray-900" x-text="currentReport ? currentReport.title : ''"></h3>
                                        <button @click="currentReport = null" class="text-gray-400 hover:text-gray-600">
                                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                            </svg>
                                        </button>
                                    </div>
                                    <div class="border border-gray-200 rounded p-4 bg-gray-50">
                                        <pre x-html="currentReport ? currentReport.content : ''" class="whitespace-pre-wrap text-sm"></pre>
                                    </div>
                                </div>
                            </div>
                        </template>

                        <template x-if="currentPage === 'deals'">
                            <div class="space-y-6">
                                <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <svg class="w-5 h-5 text-red-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
                                            </svg>
                                            <span class="text-red-800 font-medium">Deals & Specials Management</span>
                                        </div>
                                        <button @click="showCreateDealModal = true" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors text-sm">
                                            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                                            </svg>
                                            Create New Deal
                                        </button>
                                    </div>
                                    <p class="text-red-700 text-sm mt-1">Create and manage promotional deals. Note: GLS (Green Leaf Special) items only accept manual discounts.</p>
                                </div>

                                <!-- Active Deals Summary -->
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-green-900">Active Deals</p>
                                                <p class="text-lg font-semibold text-green-900" x-text="getActiveDealsCount()"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-blue-900">Today's Savings</p>
                                                <p class="text-lg font-semibold text-blue-900" x-text="'$' + getTodaysSavings().toFixed(2)"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-purple-900">Customers Helped</p>
                                                <p class="text-lg font-semibold text-purple-900" x-text="getCustomersHelped()"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-orange-900">Most Popular</p>
                                                <p class="text-lg font-semibold text-orange-900" x-text="getMostPopularDeal()"></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Current Deals -->
                                <div class="bg-white border border-gray-200 rounded-lg">
                                    <div class="p-6 border-b border-gray-200">
                                        <div class="flex items-center justify-between">
                                            <h3 class="text-lg font-semibold text-gray-900">Current Deals</h3>
                                            <div class="flex space-x-2">
                                                <select x-model="dealFilter" @change="filterDeals()" class="px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500">
                                                    <option value="">All Deals</option>
                                                    <option value="active">Active Only</option>
                                                    <option value="inactive">Inactive Only</option>
                                                    <option value="expired">Expired</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="space-y-0">
                                        <template x-for="deal in filteredDeals" :key="deal.id">
                                            <div class="border-b border-gray-200 last:border-b-0 p-6 hover:bg-gray-50 transition-colors">
                                                <div class="flex items-start justify-between">
                                                    <div class="flex-1">
                                                        <div class="flex items-center space-x-3 mb-3">
                                                            <h4 class="text-lg font-semibold text-gray-900" x-text="deal.name"></h4>
                                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                                                  :class="getDealStatusClass(deal)"
                                                                  x-text="deal.isActive ? 'Active' : 'Inactive'">
                                                            </span>
                                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"
                                                                  x-text="deal.type">
                                                            </span>
                                                        </div>

                                                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                                            <!-- Deal Details -->
                                                            <div>
                                                                <h5 class="font-medium text-gray-900 mb-2">Deal Details</h5>
                                                                <div class="space-y-1 text-sm">
                                                                    <p><span class="text-gray-600">Type:</span> <span x-text="deal.type"></span></p>
                                                                    <p><span class="text-gray-600">Discount:</span> <span x-text="deal.discountType === 'percentage' ? deal.discountValue + '%' : '$' + deal.discountValue.toFixed(2)"></span></p>
                                                                    <p><span class="text-gray-600">Min Purchase:</span> <span x-text="deal.minPurchase ? '$' + deal.minPurchase.toFixed(2) : 'None'"></span></p>
                                                                    <div x-show="deal.description" class="mt-2">
                                                                        <span class="text-gray-600">Description:</span>
                                                                        <p class="text-gray-800 mt-1" x-text="deal.description"></p>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <!-- Applicable Items -->
                                                            <div>
                                                                <h5 class="font-medium text-gray-900 mb-2">Applies To</h5>
                                                                <div class="space-y-1 text-sm">
                                                                    <p><span class="text-gray-600">Categories:</span> <span x-text="deal.applicableCategories.length > 0 ? deal.applicableCategories.join(', ') : 'All Categories'"></span></p>
                                                                    <p><span class="text-gray-600">Products:</span> <span x-text="deal.applicableProducts.length > 0 ? deal.applicableProducts.length + ' specific products' : 'All Products'"></span></p>
                                                                    <div x-show="deal.excludeGLS" class="mt-2 text-xs text-orange-600 bg-orange-50 px-2 py-1 rounded">
                                                                        ���� Excludes GLS items (manual discount only)
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <!-- Schedule & Usage -->
                                                            <div>
                                                                <h5 class="font-medium text-gray-900 mb-2">Schedule & Usage</h5>
                                                                <div class="space-y-1 text-sm">
                                                                    <p><span class="text-gray-600">Start Date:</span> <span x-text="new Date(deal.startDate).toLocaleDateString()"></span></p>
                                                                    <p><span class="text-gray-600">End Date:</span> <span x-text="new Date(deal.endDate).toLocaleDateString()"></span></p>
                                                                    <p><span class="text-gray-600">Usage Count:</span> <span x-text="deal.usageCount"></span></p>
                                                                    <p x-show="deal.usageLimit"><span class="text-gray-600">Usage Limit:</span> <span x-text="deal.usageLimit"></span></p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <!-- Actions -->
                                                    <div class="ml-6 flex flex-col space-y-2 flex-shrink-0">
                                                        <button @click="toggleDealStatus(deal)"
                                                                :class="deal.isActive ? 'bg-orange-600 hover:bg-orange-700' : 'bg-green-600 hover:bg-green-700'"
                                                                class="text-white px-4 py-2 rounded-lg text-sm transition-colors"
                                                                x-text="deal.isActive ? 'Deactivate' : 'Activate'">
                                                        </button>
                                                        <button @click="editDeal(deal)" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 text-sm transition-colors">
                                                            Edit
                                                        </button>
                                                        <button @click="duplicateDeal(deal)" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 text-sm transition-colors">
                                                            Duplicate
                                                        </button>
                                                        <button @click="deleteDeal(deal.id)" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 text-sm transition-colors">
                                                            Delete
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </template>
                                    </div>

                                    <div x-show="filteredDeals.length === 0" class="p-8 text-center text-gray-500">
                                        <svg class="w-12 h-12 mx-auto text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
                                        </svg>
                                        <p>No deals found</p>
                                        <p class="text-sm mt-1">Create your first deal to get started</p>
                                    </div>
                                </div>

                                <div class="border border-gray-200 rounded-lg p-4">
                                    <p class="text-gray-600">Laravel Implementation: <code class="bg-gray-100 px-2 py-1 rounded text-sm">/deals</code></p>
                                    <p class="text-sm text-gray-500 mt-1">Comprehensive deal engine with automatic cart application, scheduling, and GLS exclusion logic.</p>
                                </div>
                            </div>
                        </template>

                        <template x-if="currentPage === 'loyalty'">
                            <div class="space-y-6">
                                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <svg class="w-5 h-5 text-yellow-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                            </svg>
                                            <span class="text-yellow-800 font-medium">Loyalty Program Management</span>
                                        </div>
                                        <button @click="showEnrollCustomerModal = true" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 transition-colors text-sm">
                                            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                                            </svg>
                                            Enroll Customer
                                        </button>
                                    </div>
                                    <p class="text-yellow-700 text-sm mt-1">Manage customer loyalty program enrollment, points, and tier benefits.</p>
                                </div>

                                <!-- Loyalty Program Stats -->
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-blue-900">Total Members</p>
                                                <p class="text-lg font-semibold text-blue-900" x-text="getLoyaltyStats().totalMembers"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v13m0-13V6a2 2 0 112 0v1m-2 0V6a2 2 0 00-2 0v1m2 0h.01M12 21h.01"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-green-900">Active Members</p>
                                                <p class="text-lg font-semibold text-green-900" x-text="getLoyaltyStats().activeMembers"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-purple-900">Points Redeemed</p>
                                                <p class="text-lg font-semibold text-purple-900" x-text="getLoyaltyStats().pointsRedeemed.toLocaleString()"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                                        <div class="flex items-center">
                                            <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
                                            </svg>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-orange-900">Avg Monthly Spend</p>
                                                <p class="text-lg font-semibold text-orange-900" x-text="'$' + getLoyaltyStats().avgMonthlySpend.toFixed(2)"></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Search and Filters -->
                                <div class="bg-white border border-gray-200 rounded-lg p-6">
                                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Customer Search & Filters</h3>
                                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Search Customer</label>
                                            <input type="text" x-model="loyaltyFilter.search" @input="filterLoyaltyCustomers()" placeholder="Name, phone, or email" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Tier Level</label>
                                            <select x-model="loyaltyFilter.tier" @change="filterLoyaltyCustomers()" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                                                <option value="">All Tiers</option>
                                                <option value="Bronze">Bronze</option>
                                                <option value="Silver">Silver</option>
                                                <option value="Gold">Gold</option>
                                                <option value="Platinum">Platinum</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                            <select x-model="loyaltyFilter.status" @change="filterLoyaltyCustomers()" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                                                <option value="">All Status</option>
                                                <option value="active">Active</option>
                                                <option value="inactive">Inactive</option>
                                                <option value="new">New Members</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Sort By</label>
                                            <select x-model="loyaltyFilter.sortBy" @change="filterLoyaltyCustomers()" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                                                <option value="name">Name</option>
                                                <option value="signupDate">Signup Date</option>
                                                <option value="totalSpent">Total Spent</option>
                                                <option value="points">Points Balance</option>
                                                <option value="visits">Visit Count</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <!-- Loyalty Members List -->
                                <div class="bg-white border border-gray-200 rounded-lg">
                                    <div class="p-6 border-b border-gray-200">
                                        <div class="flex items-center justify-between">
                                            <h3 class="text-lg font-semibold text-gray-900">Loyalty Program Members</h3>
                                            <span class="text-sm text-gray-500" x-text="'Showing ' + filteredLoyaltyCustomers.length + ' members'"></span>
                                        </div>
                                    </div>
                                    <div class="space-y-0">
                                        <template x-for="customer in filteredLoyaltyCustomers" :key="customer.id">
                                            <div class="border-b border-gray-200 last:border-b-0 p-6 hover:bg-gray-50 transition-colors">
                                                <div class="flex items-start justify-between">
                                                    <div class="flex-1">
                                                        <div class="flex items-center space-x-3 mb-3">
                                                            <h4 class="text-lg font-semibold text-gray-900" x-text="customer.name"></h4>
                                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                                                  :class="getLoyaltyTierClass(customer.tier)"
                                                                  x-text="customer.tier">
                                                            </span>
                                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                                                  :class="customer.isActive ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'"
                                                                  x-text="customer.isActive ? 'Active' : 'Inactive'">
                                                            </span>
                                                        </div>

                                                        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                                                            <!-- Contact Information -->
                                                            <div>
                                                                <h5 class="font-medium text-gray-900 mb-2">Contact Information</h5>
                                                                <div class="space-y-1 text-sm">
                                                                    <p><span class="text-gray-600">Phone:</span> <span x-text="customer.phone"></span></p>
                                                                    <p><span class="text-gray-600">Email:</span> <span x-text="customer.email"></span></p>
                                                                    <p><span class="text-gray-600">Signed Up:</span> <span x-text="new Date(customer.signupDate).toLocaleDateString()"></span></p>
                                                                </div>
                                                            </div>

                                                            <!-- Loyalty Status -->
                                                            <div>
                                                                <h5 class="font-medium text-gray-900 mb-2">Loyalty Status</h5>
                                                                <div class="space-y-1 text-sm">
                                                                    <p><span class="text-gray-600">Current Points:</span> <span class="font-semibold text-yellow-600" x-text="customer.points.toLocaleString()"></span></p>
                                                                    <p><span class="text-gray-600">Total Visits:</span> <span x-text="customer.totalVisits"></span></p>
                                                                    <p><span class="text-gray-600">Last Visit:</span> <span x-text="customer.lastVisit ? new Date(customer.lastVisit).toLocaleDateString() : 'Never'"></span></p>
                                                                </div>
                                                            </div>

                                                            <!-- Spending History -->
                                                            <div>
                                                                <h5 class="font-medium text-gray-900 mb-2">Spending History</h5>
                                                                <div class="space-y-1 text-sm">
                                                                    <p><span class="text-gray-600">Total Spent:</span> <span class="font-semibold text-green-600" x-text="'$' + customer.totalSpent.toFixed(2)"></span></p>
                                                                    <p><span class="text-gray-600">Avg Per Visit:</span> <span x-text="'$' + (customer.totalVisits > 0 ? (customer.totalSpent / customer.totalVisits).toFixed(2) : '0.00')"></span></p>
                                                                    <p><span class="text-gray-600">Points Earned:</span> <span x-text="customer.pointsEarned.toLocaleString()"></span></p>
                                                                </div>
                                                            </div>

                                                            <!-- Quick Actions -->
                                                            <div>
                                                                <h5 class="font-medium text-gray-900 mb-2">Quick Actions</h5>
                                                                <div class="space-y-2">
                                                                    <button @click="viewCustomerDetails(customer)" class="w-full text-left px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors">
                                                                        View Details
                                                                    </button>
                                                                    <button @click="startSaleForCustomer(customer)" class="w-full text-left px-3 py-2 text-sm bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors">
                                                                        Start Sale
                                                                    </button>
                                                                    <button @click="editLoyaltyCustomer(customer)" class="w-full text-left px-3 py-2 text-sm bg-orange-50 text-orange-700 rounded-lg hover:bg-orange-100 transition-colors">
                                                                        Edit Customer
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <!-- Tier Actions -->
                                                    <div class="ml-6 flex flex-col space-y-2 flex-shrink-0">
                                                        <button @click="openAdjustPointsModal(customer)" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 text-sm transition-colors">
                                                            Adjust Points
                                                        </button>
                                                        <button @click="toggleCustomerStatus(customer)"
                                                                :class="customer.isActive ? 'bg-red-600 hover:bg-red-700' : 'bg-green-600 hover:bg-green-700'"
                                                                class="text-white px-4 py-2 rounded-lg text-sm transition-colors"
                                                                x-text="customer.isActive ? 'Deactivate' : 'Activate'">
                                                        </button>
                                                        <button @click="deleteCustomerFromLoyalty(customer.id)" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 text-sm transition-colors">
                                                            Remove
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </template>
                                    </div>

                                    <div x-show="filteredLoyaltyCustomers.length === 0" class="p-8 text-center text-gray-500">
                                        <svg class="w-12 h-12 mx-auto text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                                        </svg>
                                        <p>No loyalty members found</p>
                                        <p class="text-sm mt-1">Enroll your first customer to get started</p>
                                    </div>
                                </div>

                                <div class="border border-gray-200 rounded-lg p-4">
                                    <p class="text-gray-600">Laravel Implementation: <code class="bg-gray-100 px-2 py-1 rounded text-sm">/loyalty</code></p>
                                    <p class="text-sm text-gray-500 mt-1">Comprehensive loyalty program management with automated point tracking, tier progression, and customer analytics.</p>
                                </div>
                            </div>
                        </template>

                        <template x-if="currentPage === 'settings'">
                            <div class="space-y-6">
                                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <svg class="w-5 h-5 text-gray-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                            </svg>
                                            <span class="text-gray-800 font-medium">System Settings & Configuration</span>
                                        </div>
                                        <button @click="saveAllSettings()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors text-sm">
                                            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"/>
                                            </svg>
                                            Save All Settings
                                        </button>
                                    </div>
                                    <p class="text-gray-700 text-sm mt-1">Configure cannabis POS system preferences, tax rates, and store information.</p>
                                </div>

                                <!-- Store Information -->
                                <div class="bg-white border border-gray-200 rounded-lg p-6">
                                    <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                        <svg class="w-5 h-5 text-blue-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                                        </svg>
                                        Store Information
                                    </h3>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Store Name</label>
                                            <input id="store-name" name="store-name" x-model="storeSettings.name" type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" aria-describedby="store-name-help">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Business License #</label>
                                            <input id="business-license" name="business-license" x-model="storeSettings.licenseNumber" type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" aria-describedby="license-help">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Address</label>
                                            <input id="store-address" name="store-address" x-model="storeSettings.address" type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" aria-describedby="address-help">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                                            <input id="store-phone" name="store-phone" x-model="storeSettings.phone" type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" aria-describedby="phone-help">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                                            <input id="store-email" name="store-email" x-model="storeSettings.email" type="email" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" aria-describedby="email-help">
                                        </div>
                                        <div class="md:col-span-2">
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Operating Hours (Day-by-Day Customization)</label>
                                            <div class="space-y-3">
                                                <template x-for="(day, index) in ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']" :key="day">
                                                    <div class="flex items-center space-x-4 p-3 bg-gray-50 rounded-lg">
                                                        <div class="w-20 text-sm font-medium text-gray-700" x-text="day"></div>
                                                        <label class="flex items-center">
                                                            <input :id="`open-${index}`" :name="`open-${index}`" type="checkbox" x-model="storeSettings.hoursPerDay[index].isOpen" class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded" :aria-label="`${day} open/closed toggle`">
                                                            <span class="ml-2 text-sm text-gray-700">Open</span>
                                                        </label>
                                                        <div x-show="storeSettings.hoursPerDay[index].isOpen" class="flex items-center space-x-2">
                                                            <input :id="`open-time-${index}`" :name="`open-time-${index}`" type="time" x-model="storeSettings.hoursPerDay[index].openTime" class="border border-gray-300 rounded px-2 py-1 text-sm focus:ring-2 focus:ring-green-500" :aria-label="`Opening time for ${day}`">
                                                            <span class="text-sm text-gray-500">to</span>
                                                            <input :id="`close-time-${index}`" :name="`close-time-${index}`" type="time" x-model="storeSettings.hoursPerDay[index].closeTime" class="border border-gray-300 rounded px-2 py-1 text-sm focus:ring-2 focus:ring-green-500" :aria-label="`Closing time for ${day}`">
                                                        </div>
                                                        <div x-show="!storeSettings.hoursPerDay[index].isOpen" class="text-sm text-red-600 font-medium">
                                                            Closed
                                                        </div>
                                                    </div>
                                                </template>
                                            </div>
                                            <div class="mt-3 flex space-x-2">
                                                <button @click="setAllDaysHours('09:00', '21:00')" type="button" class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded hover:bg-blue-200 transition-colors">
                                                    Set All: 9AM-9PM
                                                </button>
                                                <button @click="setWeekdayWeekendHours()" type="button" class="text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded hover:bg-purple-200 transition-colors">
                                                    Weekdays: 9AM-9PM, Weekends: 10AM-8PM
                                                </button>
                                                <button @click="setAllDaysClosed()" type="button" class="text-xs bg-red-100 text-red-700 px-2 py-1 rounded hover:bg-red-200 transition-colors">
                                                    Set All Closed
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Tax Configuration -->
                                <div class="bg-white border border-gray-200 rounded-lg p-6">
                                    <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                        <svg class="w-5 h-5 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
                                        </svg>
                                        Tax Configuration
                                    </h3>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Recreational Tax Rate (%)</label>
                                            <div class="relative">
                                                <input id="recreational-tax-rate" name="recreational-tax-rate" x-model="taxSettings.recreationalRate" type="number" step="0.01" min="0" max="100" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" aria-describedby="recreational-tax-help">
                                                <span class="absolute right-3 top-2 text-gray-500">%</span>
                                            </div>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Medical Tax Rate (%)</label>
                                            <div class="relative">
                                                <input id="medical-tax-rate" name="medical-tax-rate" x-model="taxSettings.medicalRate" type="number" step="0.01" min="0" max="100" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" aria-describedby="medical-tax-help">
                                                <span class="absolute right-3 top-2 text-gray-500">%</span>
                                            </div>
                                        </div>
                                        <div class="md:col-span-2">
                                            <label class="flex items-center">
                                                <input id="tax-include-in-price" name="tax-include-in-price" x-model="taxSettings.includeInPrice" type="checkbox" class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded" aria-describedby="tax-include-help">
                                                <span class="ml-2 text-sm text-gray-700">Tax included in displayed prices</span>
                                            </label>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Local Tax Rate (%)</label>
                                            <div class="relative">
                                                <input id="local-tax-rate" name="local-tax-rate" x-model="taxSettings.localRate" type="number" step="0.01" min="0" max="100" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" aria-describedby="local-tax-help">
                                                <span class="absolute right-3 top-2 text-gray-500">%</span>
                                            </div>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">State Tax Rate (%)</label>
                                            <div class="relative">
                                                <input id="state-tax-rate" name="state-tax-rate" x-model="taxSettings.stateRate" type="number" step="0.01" min="0" max="100" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" aria-describedby="state-tax-help">
                                                <span class="absolute right-3 top-2 text-gray-500">%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Sales & Transaction Settings -->
                                <div class="bg-white border border-gray-200 rounded-lg p-6">
                                    <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                        <svg class="w-5 h-5 text-purple-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
                                        </svg>
                                        Sales & Transaction Settings
                                    </h3>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Minimum Sale Amount ($)</label>
                                            <div class="relative">
                                                <span class="absolute left-3 top-2 text-gray-500">$</span>
                                                <input id="minimum-sale-amount" name="minimum-sale-amount" x-model="salesSettings.minimumSale" type="number" step="0.01" min="0" class="w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" aria-describedby="minimum-sale-help">
                                            </div>
                                        </div>
                                        <div class="flex items-end">
                                            <label class="flex items-center">
                                                <input id="enforce-minimum-sale" name="enforce-minimum-sale" x-model="salesSettings.enforceMinimumSale" type="checkbox" class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded" aria-describedby="enforce-minimum-help">
                                                <span class="ml-2 text-sm text-gray-700">Enforce minimum sale amount</span>
                                            </label>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Maximum Daily Purchase Limit ($)</label>
                                            <div class="relative">
                                                <span class="absolute left-3 top-2 text-gray-500">$</span>
                                                <input id="daily-purchase-limit" name="daily-purchase-limit" x-model="salesSettings.dailyLimit" type="number" step="0.01" min="0" class="w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" aria-describedby="daily-limit-help">
                                            </div>
                                        </div>
                                        <div class="flex items-end">
                                            <label class="flex items-center">
                                                <input id="require-customer-info" name="require-customer-info" x-model="salesSettings.requireCustomerInfo" type="checkbox" class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded" aria-describedby="customer-info-help">
                                                <span class="ml-2 text-sm text-gray-700">Require customer information for all sales</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <!-- Printing Preferences -->
                                <div class="bg-white border border-gray-200 rounded-lg p-6">
                                    <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                        <svg class="w-5 h-5 text-red-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                                        </svg>
                                        Printing Preferences
                                    </h3>
                                    <div class="space-y-4">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                            <div>
                                                <label class="flex items-center">
                                                    <input id="autoprint-receipts" name="autoprint-receipts" x-model="printSettings.autoprint" type="checkbox" class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded" aria-describedby="autoprint-help">
                                                    <span class="ml-2 text-sm text-gray-700">Auto-print receipts after sale</span>
                                                </label>
                                            </div>
                                            <div>
                                                <label class="flex items-center">
                                                    <input id="print-labels-auto" name="print-labels-auto" x-model="printSettings.printLabels" type="checkbox" class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded" aria-describedby="print-labels-help">
                                                    <span class="ml-2 text-sm text-gray-700">Print product labels automatically</span>
                                                </label>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-2">Receipt Template</label>
                                                <select id="receipt-template" name="receipt-template" x-model="printSettings.receiptTemplate" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" aria-describedby="receipt-template-help">
                                                    <option value="standard">Standard Receipt</option>
                                                    <option value="detailed">Detailed Receipt</option>
                                                    <option value="minimal">Minimal Receipt</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-2">Paper Size</label>
                                                <select id="paper-size" name="paper-size" x-model="printSettings.paperSize" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" aria-describedby="paper-size-help">
                                                    <option value="80mm">80mm (3.15\")</option>
                                                    <option value="58mm">58mm (2.28\")</option>
                                                    <option value="letter">Letter (8.5x11)</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Auto-print Categories</label>
                                            <p class="text-xs text-gray-500 mb-3">Click categories to enable/disable auto-printing for those product types</p>
                                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                                <template x-for="category in ['Flower', 'Edibles', 'Concentrates', 'Vape Products', 'Topicals', 'Accessories', 'Tinctures', 'Pre-Rolls', 'Infused', 'Hemp', 'Capsules', 'Beverages', 'Suppositories', 'Clones/Seeds', 'Immature Plants', 'Mature Plants']" :key="category">
                                                    <button @click="toggleCategoryAutoprint(category)"
                                                            :class="printSettings.categoriesAutoprint.includes(category) ? 'bg-green-100 border-green-500 text-green-800' : 'bg-gray-100 border-gray-300 text-gray-700 hover:bg-gray-200'"
                                                            class="flex items-center justify-center p-3 border-2 rounded-lg transition-colors cursor-pointer">
                                                        <svg x-show="printSettings.categoriesAutoprint.includes(category)" class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                                                        </svg>
                                                        <svg x-show="!printSettings.categoriesAutoprint.includes(category)" class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V9a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                                                        </svg>
                                                        <span class="text-sm font-medium" x-text="category"></span>
                                                    </button>
                                                </template>
                                            </div>
                                            <div class="mt-3 text-xs text-gray-600">
                                                <span class="font-medium">Selected categories:</span>
                                                <span x-text="printSettings.categoriesAutoprint.length > 0 ? printSettings.categoriesAutoprint.join(', ') : 'None'"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- METRC Integration -->
                                <div class="bg-white border border-gray-200 rounded-lg p-6">
                                    <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                        <svg class="w-5 h-5 text-indigo-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                                        </svg>
                                        METRC Integration
                                    </h3>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">METRC API Key</label>
                                            <input id="metrc-api-key" name="metrc-api-key" x-model="metrcSettings.apiKey" type="password" placeholder="Enter your METRC API key" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" aria-describedby="metrc-api-help">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">User API Key</label>
                                            <input id="metrc-user-key" name="metrc-user-key" x-model="metrcSettings.userKey" type="password" placeholder="Enter your user API key" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" aria-describedby="metrc-user-help">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Facility License Number</label>
                                            <input id="facility-license" name="facility-license" x-model="metrcSettings.facilityLicense" type="text" placeholder="e.g., 100001" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" aria-describedby="facility-license-help">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">State</label>
                                            <select id="metrc-state" name="metrc-state" x-model="metrcSettings.state" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" aria-describedby="metrc-state-help">
                                                <option value="OR">Oregon</option>
                                                <option value="CA">California</option>
                                                <option value="WA">Washington</option>
                                                <option value="CO">Colorado</option>
                                                <option value="NV">Nevada</option>
                                            </select>
                                        </div>
                                        <div class="md:col-span-2 space-y-3">
                                            <label class="flex items-center">
                                                <input id="metrc-auto-sync" name="metrc-auto-sync" x-model="metrcSettings.autoSync" type="checkbox" class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded" aria-describedby="auto-sync-help">
                                                <span class="ml-2 text-sm text-gray-700">Auto-sync inventory with METRC daily</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input id="metrc-track-sales" name="metrc-track-sales" x-model="metrcSettings.trackSales" type="checkbox" class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded" aria-describedby="track-sales-help">
                                                <span class="ml-2 text-sm text-gray-700">Automatically report sales to METRC</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="mt-4 flex space-x-3">
                                        <button @click="testMetrcConnection()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors text-sm">
                                            Test Connection
                                        </button>
                                        <button @click="syncMetrcInventory()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors text-sm">
                                            Sync Now
                                        </button>
                                    </div>
                                </div>

                                <!-- System Maintenance -->
                                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-6">
                                    <h3 class="text-lg font-semibold text-yellow-800 mb-4 flex items-center">
                                        <svg class="w-5 h-5 text-yellow-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                        </svg>
                                        System Maintenance
                                    </h3>
                                    <div class="space-y-3">
                                        <div class="flex items-center justify-between p-3 bg-white border border-yellow-300 rounded">
                                            <div>
                                                <h4 class="text-sm font-medium text-gray-900">Clean Up Inactive Products</h4>
                                                <p class="text-xs text-gray-600">Remove products with no activity for 90+ days from the catalogue</p>
                                            </div>
                                            <button @click="cleanupInactiveProducts()" class="px-3 py-2 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors">
                                                Clean Up
                                            </button>
                                        </div>
                                        <div class="flex items-center justify-between p-3 bg-white border border-yellow-300 rounded">
                                            <div>
                                                <h4 class="text-sm font-medium text-gray-900">Archive Old Sales Data</h4>
                                                <p class="text-xs text-gray-600">Archive sales data older than 1 year for better performance</p>
                                            </div>
                                            <button @click="archiveOldSales()" class="px-3 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors">
                                                Archive
                                            </button>
                                        </div>
                                        <div class="flex items-center justify-between p-3 bg-white border border-yellow-300 rounded">
                                            <div>
                                                <h4 class="text-sm font-medium text-gray-900">Export Database Backup</h4>
                                                <p class="text-xs text-gray-600">Download a complete backup of your POS data</p>
                                            </div>
                                            <button @click="exportBackup()" class="px-3 py-2 bg-green-600 text-white text-sm rounded hover:bg-green-700 transition-colors">
                                                Export
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </template>

                        <!-- Reports Page -->
                        <template x-if="currentPage === 'reports'">
                            <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 fade-in">
                                <div class="bg-white rounded-lg shadow-sm overflow-hidden">
                                    <div class="p-6">
                                        <div class="flex justify-between items-center mb-6">
                                            <h2 class="text-2xl font-bold text-gray-900">Reports Dashboard</h2>
                                            <div class="flex items-center space-x-4">
                                                <!-- Export Buttons -->
                                                <div class="export-buttons">
                                                    <button data-export-report="sales" data-export-format="pdf" class="btn-export btn-pdf">
                                                        📄 Export Sales PDF
                                                    </button>
                                                    <button data-export-report="inventory" data-export-format="excel" class="btn-export btn-excel">
                                                        📊 Export Inventory Excel
                                                    </button>
                                                    <button data-export-report="sales" class="btn-export btn-csv">
                                                        📋 Quick Export
                                                    </button>
                                                </div>
                                                <button @click="showCreateReportModal = true" class="bg-cannabis-green text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors font-semibold shadow-lg">
                                                    <svg class="w-5 h-5 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                                    </svg>
                                                    CREATE REPORT
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Quick Report Templates -->
                                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                                            <div class="bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-lg p-6 hover:shadow-md transition-shadow">
                                                <div class="flex items-center justify-between mb-4">
                                                    <h3 class="text-lg font-semibold text-blue-900">Sales Reports</h3>
                                                    <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                                                    </svg>
                                                </div>
                                                <p class="text-blue-700 text-sm mb-4">Daily, weekly, monthly sales performance and trends</p>
                                                <div class="space-y-2">
                                                    <button @click="generateQuickReport('daily-sales')" class="w-full text-left px-3 py-2 text-sm bg-white text-blue-800 rounded hover:bg-blue-50 transition-colors">Daily Sales Summary</button>
                                                    <button @click="generateQuickReport('weekly-sales')" class="w-full text-left px-3 py-2 text-sm bg-white text-blue-800 rounded hover:bg-blue-50 transition-colors">Weekly Sales Trends</button>
                                                    <button @click="generateQuickReport('monthly-sales')" class="w-full text-left px-3 py-2 text-sm bg-white text-blue-800 rounded hover:bg-blue-50 transition-colors">Monthly Performance</button>
                                                </div>
                                                <div class="mt-4 pt-4 border-t border-blue-200">
                                                    <div class="flex gap-2">
                                                        <button data-export-report="sales" data-export-format="pdf" class="flex-1 btn-export btn-pdf text-xs py-1">📄 PDF</button>
                                                        <button data-export-report="sales" data-export-format="excel" class="flex-1 btn-export btn-excel text-xs py-1">📊 Excel</button>
                                                        <button data-export-report="sales" data-export-format="csv" class="flex-1 btn-export btn-csv text-xs py-1">📋 CSV</button>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-lg p-6 hover:shadow-md transition-shadow">
                                                <div class="flex items-center justify-between mb-4">
                                                    <h3 class="text-lg font-semibold text-green-900">Inventory Reports</h3>
                                                    <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                                                    </svg>
                                                </div>
                                                <p class="text-green-700 text-sm mb-4">Stock levels, reorder alerts, and inventory valuation</p>
                                                <div class="space-y-2">
                                                    <button @click="generateQuickReport('low-stock')" class="w-full text-left px-3 py-2 text-sm bg-white text-green-800 rounded hover:bg-green-50 transition-colors">Low Stock Alert</button>
                                                    <button @click="generateQuickReport('inventory-value')" class="w-full text-left px-3 py-2 text-sm bg-white text-green-800 rounded hover:bg-green-50 transition-colors">Inventory Valuation</button>
                                                    <button @click="generateQuickReport('aging-inventory')" class="w-full text-left px-3 py-2 text-sm bg-white text-green-800 rounded hover:bg-green-50 transition-colors">Aging Inventory</button>
                                                </div>
                                                <div class="mt-4 pt-4 border-t border-green-200">
                                                    <div class="flex gap-2">
                                                        <button data-export-report="inventory" data-export-format="pdf" class="flex-1 btn-export btn-pdf text-xs py-1">📄 PDF</button>
                                                        <button data-export-report="inventory" data-export-format="excel" class="flex-1 btn-export btn-excel text-xs py-1">📊 Excel</button>
                                                        <button data-export-report="inventory" data-export-format="csv" class="flex-1 btn-export btn-csv text-xs py-1">📋 CSV</button>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200 rounded-lg p-6 hover:shadow-md transition-shadow">
                                                <div class="flex items-center justify-between mb-4">
                                                    <h3 class="text-lg font-semibold text-purple-900">Customer Reports</h3>
                                                    <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                                                    </svg>
                                                </div>
                                                <p class="text-purple-700 text-sm mb-4">Customer behavior, loyalty programs, and demographics</p>
                                                <div class="space-y-2">
                                                    <button @click="generateQuickReport('top-customers')" class="w-full text-left px-3 py-2 text-sm bg-white text-purple-800 rounded hover:bg-purple-50 transition-colors">Top Customers</button>
                                                    <button @click="generateQuickReport('customer-loyalty')" class="w-full text-left px-3 py-2 text-sm bg-white text-purple-800 rounded hover:bg-purple-50 transition-colors">Loyalty Program</button>
                                                    <button @click="generateQuickReport('customer-demographics')" class="w-full text-left px-3 py-2 text-sm bg-white text-purple-800 rounded hover:bg-purple-50 transition-colors">Demographics</button>
                                                </div>
                                                <div class="mt-4 pt-4 border-t border-purple-200">
                                                    <div class="flex gap-2">
                                                        <button data-export-report="customers" data-export-format="pdf" class="flex-1 btn-export btn-pdf text-xs py-1">📄 PDF</button>
                                                        <button data-export-report="customers" data-export-format="excel" class="flex-1 btn-export btn-excel text-xs py-1">📊 Excel</button>
                                                        <button data-export-report="customers" data-export-format="csv" class="flex-1 btn-export btn-csv text-xs py-1">📋 CSV</button>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="bg-gradient-to-br from-orange-50 to-orange-100 border border-orange-200 rounded-lg p-6 hover:shadow-md transition-shadow">
                                                <div class="flex items-center justify-between mb-4">
                                                    <h3 class="text-lg font-semibold text-orange-900">Employee Reports</h3>
                                                    <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                                                    </svg>
                                                </div>
                                                <p class="text-orange-700 text-sm mb-4">Performance, sales metrics, and productivity analysis</p>
                                                <div class="space-y-2">
                                                    <button @click="generateQuickReport('employee-sales')" class="w-full text-left px-3 py-2 text-sm bg-white text-orange-800 rounded hover:bg-orange-50 transition-colors">Sales Performance</button>
                                                    <button @click="generateQuickReport('employee-hours')" class="w-full text-left px-3 py-2 text-sm bg-white text-orange-800 rounded hover:bg-orange-50 transition-colors">Hours & Productivity</button>
                                                    <button @click="generateQuickReport('commission-report')" class="w-full text-left px-3 py-2 text-sm bg-white text-orange-800 rounded hover:bg-orange-50 transition-colors">Commission Report</button>
                                                </div>
                                                <div class="mt-4 pt-4 border-t border-orange-200">
                                                    <div class="flex gap-2">
                                                        <button data-export-report="employees" data-export-format="pdf" class="flex-1 btn-export btn-pdf text-xs py-1">📄 PDF</button>
                                                        <button data-export-report="employees" data-export-format="excel" class="flex-1 btn-export btn-excel text-xs py-1">📊 Excel</button>
                                                        <button data-export-report="employees" data-export-format="csv" class="flex-1 btn-export btn-csv text-xs py-1">📋 CSV</button>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="bg-gradient-to-br from-red-50 to-red-100 border border-red-200 rounded-lg p-6 hover:shadow-md transition-shadow">
                                                <div class="flex items-center justify-between mb-4">
                                                    <h3 class="text-lg font-semibold text-red-900">Compliance Reports</h3>
                                                    <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3"/>
                                                    </svg>
                                                </div>
                                                <p class="text-red-700 text-sm mb-4">METRC reporting, tax compliance, and regulatory audits</p>
                                                <div class="space-y-2">
                                                    <button @click="generateQuickReport('metrc-manifest')" class="w-full text-left px-3 py-2 text-sm bg-white text-red-800 rounded hover:bg-red-50 transition-colors">METRC Manifest</button>
                                                    <button @click="generateQuickReport('tax-report')" class="w-full text-left px-3 py-2 text-sm bg-white text-red-800 rounded hover:bg-red-50 transition-colors">Tax Compliance</button>
                                                    <button @click="generateQuickReport('audit-trail')" class="w-full text-left px-3 py-2 text-sm bg-white text-red-800 rounded hover:bg-red-50 transition-colors">Audit Trail</button>
                                                </div>
                                                <div class="mt-4 pt-4 border-t border-red-200">
                                                    <div class="flex gap-2">
                                                        <button data-export-report="metrc" data-export-format="pdf" class="flex-1 btn-export btn-pdf text-xs py-1">📄 PDF</button>
                                                        <button data-export-report="compliance" data-export-format="excel" class="flex-1 btn-export btn-excel text-xs py-1">📊 Excel</button>
                                                        <button data-export-report="tax_report" data-export-format="csv" class="flex-1 btn-export btn-csv text-xs py-1">📋 CSV</button>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 border border-indigo-200 rounded-lg p-6 hover:shadow-md transition-shadow">
                                                <div class="flex items-center justify-between mb-4">
                                                    <h3 class="text-lg font-semibold text-indigo-900">Financial Reports</h3>
                                                    <svg class="w-8 h-8 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
                                                    </svg>
                                                </div>
                                                <p class="text-indigo-700 text-sm mb-4">Profit margins, expenses, and financial summaries</p>
                                                <div class="space-y-2">
                                                    <button @click="generateQuickReport('profit-loss')" class="w-full text-left px-3 py-2 text-sm bg-white text-indigo-800 rounded hover:bg-indigo-50 transition-colors">Profit & Loss</button>
                                                    <button @click="generateQuickReport('cash-flow')" class="w-full text-left px-3 py-2 text-sm bg-white text-indigo-800 rounded hover:bg-indigo-50 transition-colors">Cash Flow</button>
                                                    <button @click="generateQuickReport('margin-analysis')" class="w-full text-left px-3 py-2 text-sm bg-white text-indigo-800 rounded hover:bg-indigo-50 transition-colors">Margin Analysis</button>
                                                </div>
                                                <div class="mt-4 pt-4 border-t border-indigo-200">
                                                    <div class="flex gap-2">
                                                        <button data-export-report="analytics" data-export-format="pdf" class="flex-1 btn-export btn-pdf text-xs py-1">📄 PDF</button>
                                                        <button data-export-report="analytics" data-export-format="excel" class="flex-1 btn-export btn-excel text-xs py-1">📊 Excel</button>
                                                        <button data-export-report="daily_summary" data-export-format="csv" class="flex-1 btn-export btn-csv text-xs py-1">📋 CSV</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Recent Reports -->
                                        <div class="border-t border-gray-200 pt-8">
                                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Recent Reports</h3>
                                            <div class="bg-gray-50 rounded-lg p-4">
                                                <div class="space-y-3">
                                                    <template x-for="report in recentReports" :key="report.id">
                                                        <div class="flex items-center justify-between py-3 px-4 bg-white rounded-lg border border-gray-200">
                                                            <div class="flex items-center space-x-4">
                                                                <div class="w-10 h-10 rounded-lg flex items-center justify-center"
                                                                     :class="getReportTypeColor(report.type)">
                                                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a4 4 0 01-4-4V5a4 4 0 014-4h10a4 4 0 014 4v14a4 4 0 01-4 4z"/>
                                                                    </svg>
                                                                </div>
                                                                <div>
                                                                    <h4 class="font-medium text-gray-900" x-text="report.name"></h4>
                                                                    <p class="text-sm text-gray-500" x-text="`Generated ${formatDate(report.createdAt)} by ${report.createdBy}`"></p>
                                                                </div>
                                                            </div>
                                                            <div class="flex items-center space-x-2">
                                                                <button @click="viewReport(report)" class="text-blue-600 hover:text-blue-800 text-sm font-medium">View</button>
                                                                <div class="flex gap-1">
                                                                    <button :data-export-report="report.type" data-export-format="pdf" class="btn-export btn-pdf text-xs px-2 py-1">📄</button>
                                                                    <button :data-export-report="report.type" data-export-format="excel" class="btn-export btn-excel text-xs px-2 py-1">📊</button>
                                                                    <button :data-export-report="report.type" data-export-format="csv" class="btn-export btn-csv text-xs px-2 py-1">📋</button>
                                                                </div>
                                                                <button @click="duplicateReport(report)" class="text-purple-600 hover:text-purple-800 text-sm font-medium">Duplicate</button>
                                                            </div>
                                                        </div>
                                                    </template>

                                                    <div x-show="recentReports.length === 0" class="text-center py-8 text-gray-500">
                                                        <svg class="w-12 h-12 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a4 4 0 01-4-4V5a4 4 0 014-4h10a4 4 0 014 4v14a4 4 0 01-4 4z"/>
                                                        </svg>
                                                        <p>No reports generated yet. Create your first custom report!</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </template>

                        <!-- Fallback for unknown pages -->
                        <template x-if="!['customers', 'employees', 'products', 'rooms-drawers', 'price-tiers', 'sales', 'order-queue', 'inventory-evaluation', 'analytics', 'reports', 'deals', 'loyalty', 'settings'].includes(currentPage)">
                            <div class="text-center py-12">
                                <div class="w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center">
                                    <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
                                    </svg>
                                </div>
                                <h3 class="text-lg font-medium text-gray-900 mb-2" x-text="getCurrentPageTitle()"></h3>
                                <p class="text-gray-500 mb-4">This page is ready for Laravel implementation.</p>
                                <p class="text-sm text-gray-400">All controllers, models, and Blade views are available for this functionality.</p>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
        </main>

        <!-- Sale Details Modal -->
        <div x-show="showSaleDetailsModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" @keydown.escape="showSaleDetailsModal = false" x-init="showSaleDetailsModal && $el.focus()" tabindex="0">
            <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900">Sale Transaction Details</h3>
                        <button @click="showSaleDetailsModal = false" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                    </div>

                    <div x-show="selectedSale" class="space-y-6">
                        <!-- Transaction Header -->
                        <div class="bg-gray-50 p-4 rounded-lg border">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-2">Transaction Information</h4>
                                    <div class="space-y-1 text-sm">
                                        <div><span class="font-medium text-gray-700">Transaction ID:</span> <span class="font-mono text-blue-600" x-text="selectedSale?.id"></span></div>
                                        <div><span class="font-medium text-gray-700">Date & Time:</span> <span x-text="selectedSale ? new Date(selectedSale.date).toLocaleString() : ''"></span></div>
                                        <div><span class="font-medium text-gray-700">Employee:</span> <span x-text="selectedSale?.employee"></span></div>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-2">Customer Information</h4>
                                    <div class="space-y-1 text-sm">
                                        <div><span class="font-medium text-gray-700">Customer:</span> <span x-text="selectedSale?.customer"></span></div>
                                        <div>
                                            <span class="font-medium text-gray-700">Type:</span>
                                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ml-1"
                                                  :class="selectedSale?.isMedical ? 'bg-green-100 text-green-800' : 'bg-blue-100 text-blue-800'"
                                                  x-text="selectedSale?.isMedical ? 'Medical Patient' : 'Recreational Customer'">
                                            </span>
                                        </div>
                                        <div x-show="selectedSale?.isMedical"><span class="font-medium text-gray-700">Tax Status:</span> <span class="text-green-600 font-medium">Tax Exempt</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Items Purchased -->
                        <div>
                            <h4 class="font-semibold text-gray-900 mb-3">Items Purchased</h4>
                            <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Product</th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase">METRC</th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase">Qty</th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase">Price</th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase">Total</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-200">
                                        <template x-for="(item, index) in selectedSale?.itemDetails || []" :key="index">
                                            <tr class="hover:bg-gray-50">
                                                <td class="px-4 py-3">
                                                    <div class="text-sm font-medium text-gray-900" x-text="item.name"></div>
                                                    <div class="text-xs text-gray-500" x-text="item.category"></div>
                                                </td>
                                                <td class="px-4 py-3 text-center">
                                                    <div class="text-xs font-mono text-purple-700 bg-purple-50 px-2 py-1 rounded" x-text="item.metrcTag ? '...' + item.metrcTag.slice(-5) : 'N/A'"></div>
                                                </td>
                                                <td class="px-4 py-3 text-sm text-gray-600 text-center" x-text="item.quantity"></td>
                                                <td class="px-4 py-3 text-sm text-gray-600 text-right" x-text="'$' + item.price.toFixed(2)"></td>
                                                <td class="px-4 py-3 text-sm font-medium text-gray-900 text-right" x-text="'$' + (item.price * item.quantity).toFixed(2)"></td>
                                            </tr>
                                        </template>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Payment Information -->
                        <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                            <h4 class="font-semibold text-blue-900 mb-3">Payment Summary</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="space-y-2">
                                    <div class="flex justify-between text-sm">
                                        <span class="text-blue-700">Payment Method:</span>
                                        <span class="font-medium text-blue-900 capitalize" x-text="selectedSale?.paymentMethod"></span>
                                    </div>
                                    <div class="flex justify-between text-sm">
                                        <span class="text-blue-700">Subtotal:</span>
                                        <span class="font-medium text-blue-900" x-text="'$' + (selectedSale?.total * 0.83).toFixed(2)"></span>
                                    </div>
                                    <div class="flex justify-between text-sm" x-show="!selectedSale?.isMedical">
                                        <span class="text-blue-700">Tax (20%):</span>
                                        <span class="font-medium text-blue-900" x-text="'$' + (selectedSale?.total * 0.17).toFixed(2)"></span>
                                    </div>
                                </div>
                                <div class="space-y-2">
                                    <div class="flex justify-between text-lg font-bold">
                                        <span class="text-blue-700">Total:</span>
                                        <span class="text-blue-900" x-text="'$' + (selectedSale?.total || 0).toFixed(2)"></span>
                                    </div>
                                    <div class="text-xs text-blue-600" x-show="selectedSale?.isMedical">Medical Patient - Tax Exempt</div>
                                </div>
                            </div>
                        </div>

                        <!-- METRC & Compliance -->
                        <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                            <h4 class="font-semibold text-purple-900 mb-2">Compliance & Tracking</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                <div>
                                    <span class="text-purple-700">METRC Status:</span>
                                    <span class="ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                        <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                                        </svg>
                                        Reported
                                    </span>
                                </div>
                                <div>
                                    <span class="text-purple-700">Age Verification:</span>
                                    <span class="ml-2 text-green-600 font-medium">✓ Verified</span>
                                </div>
                                <div>
                                    <span class="text-purple-700">Oregon OLCC:</span>
                                    <span class="ml-2 text-green-600 font-medium">�� Compliant</span>
                                </div>
                                <div>
                                    <span class="text-purple-700">Receipt ID:</span>
                                    <span class="ml-2 font-mono text-purple-900" x-text="'RCP-' + selectedSale?.id"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="mt-6 flex gap-3">
                        <button @click="showSaleDetailsModal = false" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                            Close
                        </button>
                        <button @click="reprintReceipt(selectedSale)" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V9a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                            </svg>
                            Reprint Receipt
                        </button>
                        <button @click="refundSale(selectedSale)" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
                            </svg>
                            Process Refund
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Customer Modal -->
        <div x-show="showAddCustomerModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" @keydown.escape="closeAddCustomerModal()" @keydown.enter="(!customerForm.name || (customerForm.type === 'medical' && (!customerForm.medicalCardNumber || !customerForm.medicalCardIssueDate || !customerForm.medicalCardExpiry || (customerForm.medicalCardType === 'caregiver' && !customerForm.patientCardNumber)))) ? null : addCustomer()" x-init="showAddCustomerModal && $el.focus()" tabindex="0">
            <div class="bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900">Add New Customer</h3>
                        <button @click="closeAddCustomerModal()" class="text-gray-400 hover:text-gray-600 text-2xl">����</button>
                    </div>

                    <div class="space-y-4">
                        <!-- Customer Type Selection -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-3">Customer Type</label>
                            <div class="grid grid-cols-2 gap-3">
                                <button @click="customerForm.type = 'recreational'"
                                        :class="customerForm.type === 'recreational' ? 'bg-blue-100 border-blue-300 text-blue-800' : 'bg-white border-gray-300 text-gray-700 hover:bg-gray-50'"
                                        class="border-2 rounded-lg p-3 text-center transition-colors">
                                    <svg class="w-6 h-6 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                                    </svg>
                                    <div class="font-medium">Recreational</div>
                                    <div class="text-xs">21+ years old</div>
                                </button>
                                <button @click="customerForm.type = 'medical'"
                                        :class="customerForm.type === 'medical' ? 'bg-green-100 border-green-300 text-green-800' : 'bg-white border-gray-300 text-gray-700 hover:bg-gray-50'"
                                        class="border-2 rounded-lg p-3 text-center transition-colors">
                                    <svg class="w-6 h-6 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                    <div class="font-medium">Medical</div>
                                    <div class="text-xs">Patient/Caregiver</div>
                                </button>
                            </div>
                        </div>

                        <!-- Basic Information -->
                        <div class="space-y-4">
                            <h4 class="text-sm font-medium text-gray-700 border-b border-gray-200 pb-2">Basic Information</h4>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Full Name *</label>
                                    <input type="text" x-model="customerForm.name" placeholder="Enter customer name" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
                                    <input type="tel" x-model="customerForm.phone" placeholder="(555) 123-4567" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                                <input type="email" x-model="customerForm.email" placeholder="customer@example.com" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                            </div>
                        </div>

                        <!-- Medical Information (conditional) -->
                        <div x-show="customerForm.type === 'medical'" class="space-y-4">
                            <h4 class="text-sm font-medium text-gray-700 border-b border-gray-200 pb-2">Medical Cannabis Information</h4>

                            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                <div class="flex items-center mb-3">
                                    <svg class="w-5 h-5 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                    <span class="text-green-800 font-medium">Medical Cannabis Patient/Caregiver</span>
                                </div>
                                <p class="text-green-700 text-sm">This customer will be tax exempt and their information will be retained for compliance.</p>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Medical Card Number *</label>
                                <input type="text" x-model="customerForm.medicalCardNumber" placeholder="Enter medical card number" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                            </div>

                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Card Issue Date *</label>
                                    <input type="date" x-model="customerForm.medicalCardIssueDate" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Card Expiry Date *</label>
                                    <input type="date" x-model="customerForm.medicalCardExpiry" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Card Type</label>
                                <select x-model="customerForm.medicalCardType" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                                    <option value="patient">Patient</option>
                                    <option value="caregiver">Caregiver</option>
                                </select>
                            </div>

                            <!-- Caregiver-specific field -->
                            <div x-show="customerForm.medicalCardType === 'caregiver'" class="space-y-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Patient Card Number *</label>
                                    <input type="text" x-model="customerForm.patientCardNumber" placeholder="Enter patient's medical card number" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                                    <p class="text-xs text-gray-500 mt-1">Required for caregiver verification</p>
                                </div>
                            </div>
                        </div>

                        <!-- Data Retention Notice -->
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <label class="flex items-start">
                                <input id="customer-save-data" name="customer-save-data" type="checkbox" x-model="customerForm.saveData" class="h-4 w-4 text-green-500 rounded focus:ring-green-500 mt-1" aria-describedby="save-customer-help">
                                <div class="ml-3">
                                    <div class="font-medium text-blue-900">Save Customer Information</div>
                                    <div class="text-sm text-blue-700">
                                        <span x-show="customerForm.type === 'medical'">Medical patient information will be automatically saved for compliance purposes.</span>
                                        <span x-show="customerForm.type === 'recreational'">Save customer data for future transactions and loyalty program eligibility.</span>
                                    </div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="mt-6 flex gap-3">
                        <button @click="closeAddCustomerModal()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button @click="addCustomer()" :disabled="!customerForm.name || (customerForm.type === 'medical' && (!customerForm.medicalCardNumber || !customerForm.medicalCardIssueDate || !customerForm.medicalCardExpiry || (customerForm.medicalCardType === 'caregiver' && !customerForm.patientCardNumber)))" class="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed">
                            Add Customer
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Product Modal -->
        <div x-show="showAddProductModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" @keydown.escape="showAddProductModal = false" x-init="showAddProductModal && $el.focus()" tabindex="0">
            <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-semibold text-gray-900">Add New Product</h3>
                        <button @click="showAddProductModal = false; resetProductForm()" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                    </div>

                    <form @submit.prevent="addProduct()" class="space-y-6">
                        <!-- Required Fields Section -->
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <h4 class="text-sm font-semibold text-green-800 mb-4 flex items-center">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                Required Fields
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Product Name *</label>
                                    <input type="text" x-model="productForm.name" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="Enter product name">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Category *</label>
                                    <select x-model="productForm.category" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                                        <option value="">Select category...</option>
                                        <option value="Flower">Flower</option>
                                        <option value="Pre-Rolls">Pre-Rolls</option>
                                        <option value="Infused">Infused (Joints/Blunts)</option>
                                        <option value="Edibles">Edibles</option>
                                        <option value="Concentrates">Concentrates</option>
                                        <option value="Tinctures">Tinctures</option>
                                        <option value="Hemp">Hemp Products</option>
                                        <option value="Paraphernalia">Accessories</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Price ($) *</label>
                                    <input type="number" step="0.01" min="0" x-model="productForm.price" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="0.00">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Cost ($) *</label>
                                    <input type="number" step="0.01" min="0" x-model="productForm.cost" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="0.00">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Vendor *</label>
                                    <input type="text" x-model="productForm.vendor" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="Enter vendor name">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Unit of Measurement *</label>
                                    <select x-model="productForm.unitOfMeasurement" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                                        <option value="">Select unit of measurement...</option>
                                        <!-- Common Flower/Pre-roll Units -->
                                        <optgroup label="Flower & Pre-rolls">
                                            <option value="1g">1 gram</option>
                                            <option value="2g">2 grams</option>
                                            <option value="3.5g">3.5 grams (eighth)</option>
                                            <option value="7g">7 grams (quarter)</option>
                                            <option value="14g">14 grams (half ounce)</option>
                                            <option value="28g">28 grams (ounce)</option>
                                        </optgroup>
                                        <!-- Concentrate Units -->
                                        <optgroup label="Concentrates">
                                            <option value="0.5g">0.5 gram</option>
                                            <option value="1g">1 gram</option>
                                            <option value="2g">2 grams</option>
                                        </optgroup>
                                        <!-- Edible Units -->
                                        <optgroup label="Edibles">
                                            <option value="1 piece">1 piece</option>
                                            <option value="2 pieces">2 pieces</option>
                                            <option value="5 pieces">5 pieces</option>
                                            <option value="10 pieces">10 pieces</option>
                                            <option value="1 package">1 package</option>
                                        </optgroup>
                                        <!-- Accessory Units -->
                                        <optgroup label="Accessories">
                                            <option value="1 unit">1 unit</option>
                                            <option value="1 piece">1 piece</option>
                                        </optgroup>
                                        <!-- Other Units -->
                                        <optgroup label="Other">
                                            <option value="1ml">1 milliliter</option>
                                            <option value="5ml">5 milliliters</option>
                                            <option value="10ml">10 milliliters</option>
                                            <option value="30ml">30 milliliters</option>
                                            <option value="100ml">100 milliliters</option>
                                        </optgroup>
                                    </select>
                                    <p class="text-xs text-gray-500 mt-1">Select the appropriate unit of measurement for this product</p>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Weight *</label>
                                    <input type="number" step="0.01" min="0" x-model="productForm.weight" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="Enter weight (e.g., 3.5)">
                                    <p class="text-xs text-gray-500 mt-1">Enter the actual weight/quantity for this product</p>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">THC (%) *</label>
                                    <input type="number" step="0.01" min="0" max="100" x-model="productForm.thc" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="0.00">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">CBD (%) *</label>
                                    <input type="number" step="0.01" min="0" max="100" x-model="productForm.cbd" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="0.00">
                                </div>
                            </div>
                        </div>

                        <!-- Optional Fields Section -->
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <h4 class="text-sm font-semibold text-blue-800 mb-4 flex items-center">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                Optional Fields
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">SKU (Optional)</label>
                                    <input type="text" x-model="productForm.sku" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter SKU (optional)">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Supplier License Number (Optional)</label>
                                    <input type="text" x-model="productForm.supplierLicense" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="OR-123456 (optional)">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">CBC (%)</label>
                                    <input type="number" step="0.01" min="0" max="100" x-model="productForm.cbc" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="0.00">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">CBN (%)</label>
                                    <input type="number" step="0.01" min="0" max="100" x-model="productForm.cbn" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="0.00">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">CBG (%)</label>
                                    <input type="number" step="0.01" min="0" max="100" x-model="productForm.cbg" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="0.00">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Product Type</label>
                                    <select x-model="productForm.productType" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="">Select type...</option>
                                        <option value="indoor">Indoor</option>
                                        <option value="outdoor">Outdoor</option>
                                        <option value="greenhouse">Greenhouse</option>
                                        <option value="live-resin">Live Resin</option>
                                        <option value="hash-rosin">Hash Rosin</option>
                                        <option value="distillate">Distillate</option>
                                        <option value="full-spectrum">Full Spectrum</option>
                                        <option value="broad-spectrum">Broad Spectrum</option>
                                        <option value="isolate">Isolate</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Strain Dominance</label>
                                    <select x-model="productForm.strainDominance" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="">Select dominance (optional)...</option>
                                        <option value="indica">Indica</option>
                                        <option value="sativa">Sativa</option>
                                        <option value="hybrid">Hybrid</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Serving Size</label>
                                    <input type="number" step="0.01" min="0" x-model="productForm.servingSize" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="0">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Total Servings</label>
                                    <input type="number" min="0" x-model="productForm.totalServings" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="0">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Product Picture</label>
                                    <input id="product-picture-upload" name="product-picture-upload" type="file" accept="image/*" @change="productForm.picture = $event.target.files[0]" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" aria-describedby="picture-upload-help">
                                    <p class="text-xs text-gray-500 mt-1">Upload product image (JPEG, PNG, GIF)</p>
                                </div>
                            </div>
                        </div>

                        <!-- Data Retention Notice -->
                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                            <div class="flex items-center">
                                <svg class="w-5 h-5 text-gray-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                                </svg>
                                <span class="text-gray-700 text-sm">All product data will be automatically saved and retained for future use with METRC compliance.</span>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="flex justify-end space-x-3 pt-4 border-t border-gray-200">
                            <button type="button" @click="showAddProductModal = false; resetProductForm()" class="px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors">
                                Cancel
                            </button>
                            <button type="submit" class="px-6 py-2 bg-cannabis-green text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                </svg>
                                Add Product
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Vendor Packages Modal -->
        <div x-show="showVendorPackagesModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
            <div class="bg-white rounded-lg shadow-xl max-w-5xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-semibold text-gray-900" x-text="selectedVendor ? selectedVendor.name + ' - Package Details' : 'Vendor Packages'"></h3>
                        <button @click="showVendorPackagesModal = false; selectedVendor = null" class="text-gray-400 hover:text-gray-600 text-2xl">��</button>
                    </div>

                    <template x-if="selectedVendor">
                        <div class="space-y-6">
                            <!-- Vendor Info -->
                            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                    <div>
                                        <p class="text-sm font-medium text-purple-800">Vendor Name</p>
                                        <p class="text-purple-900" x-text="selectedVendor.name"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-purple-800">License</p>
                                        <p class="text-purple-900" x-text="selectedVendor.license"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-purple-800">ETA</p>
                                        <p class="text-purple-900" x-text="selectedVendor.etaDate + ' ' + selectedVendor.etaTime"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-purple-800">Status</p>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                              :class="{
                                                  'bg-green-100 text-green-800': selectedVendor.status === 'ready-to-import',
                                                  'bg-blue-100 text-blue-800': selectedVendor.status === 'in-transit',
                                                  'bg-gray-100 text-gray-800': selectedVendor.status === 'imported',
                                                  'bg-red-100 text-red-800': selectedVendor.status === 'delayed'
                                              }"
                                              x-text="selectedVendor.status.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())"></span>
                                    </div>
                                </div>
                            </div>

                            <!-- Packages Table -->
                            <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                <div class="p-4 border-b border-gray-200 bg-gray-50">
                                    <h4 class="text-md font-semibold text-gray-900">Package Details</h4>
                                    <p class="text-sm text-gray-600 mt-1" x-text="'Total packages: ' + selectedVendor.packages.length"></p>
                                </div>
                                <div class="overflow-x-auto">
                                    <table class="w-full">
                                        <thead class="bg-gray-50">
                                            <tr>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">METRC Tag</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Product</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Quantity</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Weight</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cannabinoids</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cost</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Destination</th>
                                            </tr>
                                        </thead>
                                        <tbody class="bg-white divide-y divide-gray-200">
                                            <template x-for="package in selectedVendor.packages" :key="package.id">
                                                <tr class="hover:bg-gray-50">
                                                    <td class="px-4 py-4 whitespace-nowrap">
                                                        <div class="text-xs font-mono text-purple-700 bg-purple-50 px-2 py-1 rounded" x-text="package.metrcTag"></div>
                                                    </td>
                                                    <td class="px-4 py-4">
                                                        <div class="text-sm font-medium text-gray-900" x-text="package.productName"></div>
                                                    </td>
                                                    <td class="px-4 py-4 whitespace-nowrap">
                                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800" x-text="package.category"></span>
                                                    </td>
                                                    <td class="px-4 py-4 whitespace-nowrap">
                                                        <div class="text-sm text-gray-900" x-text="package.quantity + ' units'"></div>
                                                    </td>
                                                    <td class="px-4 py-4 whitespace-nowrap">
                                                        <div class="text-sm text-gray-900" x-text="package.weight"></div>
                                                    </td>
                                                    <td class="px-4 py-4 whitespace-nowrap">
                                                        <div class="text-xs text-gray-600">
                                                            <div>THC: <span x-text="package.thc + '%'"></span></div>
                                                            <div>CBD: <span x-text="package.cbd + '%'"></span></div>
                                                        </div>
                                                    </td>
                                                    <td class="px-4 py-4 whitespace-nowrap">
                                                        <div class="text-sm text-gray-900" x-text="'$' + package.unitCost.toFixed(2)"></div>
                                                        <div class="text-xs text-gray-500" x-text="'Total: $' + package.totalValue.toFixed(2)"></div>
                                                    </td>
                                                    <td class="px-4 py-4 whitespace-nowrap">
                                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800" x-text="package.room.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())"></span>
                                                    </td>
                                                </tr>
                                            </template>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- Summary -->
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <p class="text-sm font-medium text-gray-600">Total Packages</p>
                                    <p class="text-2xl font-bold text-gray-900" x-text="selectedVendor.packages.length"></p>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <p class="text-sm font-medium text-gray-600">Total Value</p>
                                    <p class="text-2xl font-bold text-green-600" x-text="'$' + selectedVendor.totalValue.toFixed(2)"></p>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <p class="text-sm font-medium text-gray-600">Total Cost</p>
                                    <p class="text-2xl font-bold text-blue-600" x-text="'$' + selectedVendor.totalCost.toFixed(2)"></p>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="flex justify-end space-x-3 pt-4 border-t border-gray-200">
                                <button type="button" @click="downloadManifest(selectedVendor)" class="px-4 py-2 text-blue-700 bg-blue-100 rounded-lg hover:bg-blue-200 transition-colors">
                                    Download Manifest
                                </button>
                                <button type="button" @click="showVendorPackagesModal = false; selectedVendor = null" class="px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors">
                                    Close
                                </button>
                                <button type="button" @click="importVendorInventory(selectedVendor); showVendorPackagesModal = false; selectedVendor = null"
                                        :disabled="selectedVendor.status !== 'ready-to-import'"
                                        :class="selectedVendor.status === 'ready-to-import' ? 'bg-green-600 hover:bg-green-700' : 'bg-gray-400 cursor-not-allowed'"
                                        class="px-6 py-2 text-white rounded-lg transition-colors flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"/>
                                    </svg>
                                    Import to Inventory
                                </button>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </div>

        <!-- Add Employee Modal -->
        <div x-show="showAddEmployeeModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" @keydown.escape="showAddEmployeeModal = false" x-init="showAddEmployeeModal && $el.focus()" tabindex="0">
            <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-semibold text-gray-900" x-text="selectedEmployee ? 'Edit Employee' : 'Add New Employee'"></h3>
                        <button @click="showAddEmployeeModal = false; resetEmployeeForm(); selectedEmployee = null" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                    </div>

                    <form @submit.prevent="selectedEmployee ? updateEmployee() : addEmployee()" class="space-y-6">
                        <!-- Personal Information -->
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <h4 class="text-sm font-semibold text-blue-800 mb-4 flex items-center">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                                </svg>
                                Personal Information
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Full Name *</label>
                                    <input type="text" x-model="employeeForm.name" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter full name">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Email *</label>
                                    <input type="email" x-model="employeeForm.email" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="employee@cannabest.com">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                                    <input type="tel" x-model="employeeForm.phone" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="(503) 555-0123">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Hire Date *</label>
                                    <input type="date" x-model="employeeForm.hireDate" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                        </div>

                        <!-- Employment Details -->
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <h4 class="text-sm font-semibold text-green-800 mb-4 flex items-center">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2-2v2m8 0V6a2 2 0 002 2h2a2 2 0 002-2V6"/>
                                </svg>
                                Employment Details
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Role *</label>
                                    <select x-model="employeeForm.role" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                                        <option value="">Select role...</option>
                                        <option value="manager">Manager</option>
                                        <option value="budtender">Budtender</option>
                                        <option value="security">Security</option>
                                        <option value="admin">Admin</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Pay Rate ($/hour) *</label>
                                    <input type="number" step="0.01" min="0" x-model="employeeForm.payRate" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="16.50">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                    <select x-model="employeeForm.status" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                        <option value="terminated">Terminated</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Compliance Information -->
                        <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                            <h4 class="text-sm font-semibold text-purple-800 mb-4 flex items-center">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                                </svg>
                                Cannabis Industry Compliance
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">OLCC Worker Permit Number</label>
                                    <input type="text" x-model="employeeForm.workerPermitNumber" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="Enter permit number (e.g., WP-12345)">
                                    <p class="text-xs text-gray-500 mt-1">Required for cannabis industry employment in Oregon</p>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">METRC API Key</label>
                                    <input type="text" x-model="employeeForm.metrcApiKey" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="API-XX-YYYY (optional)">
                                    <p class="text-xs text-gray-500 mt-1">Enables METRC system access for compliance tracking</p>
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="flex justify-end space-x-3 pt-4 border-t border-gray-200">
                            <button type="button" @click="showAddEmployeeModal = false; resetEmployeeForm(); selectedEmployee = null" class="px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors">
                                Cancel
                            </button>
                            <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                </svg>
                                <span x-text="selectedEmployee ? 'Update Employee' : 'Add Employee'"></span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Employee View Modal -->
        <div x-show="showEmployeeModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" @keydown.escape="showEmployeeModal = false" x-init="showEmployeeModal && $el.focus()" tabindex="0">
            <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-semibold text-gray-900" x-text="selectedEmployee ? selectedEmployee.name + ' - Employee Details' : 'Employee Details'"></h3>
                        <button @click="showEmployeeModal = false; selectedEmployee = null" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                    </div>

                    <template x-if="selectedEmployee">
                        <div class="space-y-6">
                            <!-- Employee Info -->
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <p class="text-sm font-medium text-blue-800">Employee ID</p>
                                        <p class="text-blue-900" x-text="selectedEmployee.id"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-blue-800">Full Name</p>
                                        <p class="text-blue-900" x-text="selectedEmployee.name"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-blue-800">Email</p>
                                        <p class="text-blue-900" x-text="selectedEmployee.email"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-blue-800">Phone</p>
                                        <p class="text-blue-900" x-text="selectedEmployee.phone"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-blue-800">Hire Date</p>
                                        <p class="text-blue-900" x-text="selectedEmployee.hireDate"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-blue-800">Status</p>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                              :class="{
                                                  'bg-green-100 text-green-800': selectedEmployee.status === 'active',
                                                  'bg-red-100 text-red-800': selectedEmployee.status === 'inactive',
                                                  'bg-gray-100 text-gray-800': selectedEmployee.status === 'terminated'
                                              }"
                                              x-text="selectedEmployee.status.charAt(0).toUpperCase() + selectedEmployee.status.slice(1)"></span>
                                    </div>
                                </div>
                            </div>

                            <!-- Employment Details -->
                            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                <h4 class="text-md font-semibold text-green-800 mb-3">Employment Details</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <p class="text-sm font-medium text-green-700">Role</p>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                              :class="{
                                                  'bg-purple-100 text-purple-800': selectedEmployee.role === 'manager',
                                                  'bg-blue-100 text-blue-800': selectedEmployee.role === 'budtender',
                                                  'bg-gray-100 text-gray-800': selectedEmployee.role === 'security',
                                                  'bg-green-100 text-green-800': selectedEmployee.role === 'admin'
                                              }"
                                              x-text="selectedEmployee.role.charAt(0).toUpperCase() + selectedEmployee.role.slice(1)"></span>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-green-700">Pay Rate</p>
                                        <p class="text-green-900" x-text="'$' + selectedEmployee.payRate.toFixed(2) + '/hour'"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-green-700">Hours This Week</p>
                                        <p class="text-green-900" x-text="selectedEmployee.hoursWorked + ' hours'"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-green-700">Weekly Earnings</p>
                                        <p class="text-green-900" x-text="'$' + (selectedEmployee.payRate * selectedEmployee.hoursWorked).toFixed(2)"></p>
                                    </div>
                                </div>
                            </div>

                            <!-- Compliance Status -->
                            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                <h4 class="text-md font-semibold text-purple-800 mb-3">Compliance Status</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <p class="text-sm font-medium text-purple-700">Worker Permit</p>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                              :class="selectedEmployee.workerPermit ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'"
                                              x-text="selectedEmployee.workerPermit ? 'Valid' : 'Missing'"></span>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-purple-700">METRC Access</p>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                              :class="selectedEmployee.metrcApiKey ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'"
                                              x-text="selectedEmployee.metrcApiKey ? 'Active' : 'None'"></span>
                                    </div>
                                </div>
                                <template x-if="selectedEmployee.metrcApiKey">
                                    <div class="mt-3 p-2 bg-purple-100 rounded">
                                        <p class="text-xs text-purple-700">
                                            <strong>METRC Key:</strong> <span x-text="selectedEmployee.metrcApiKey"></span>
                                        </p>
                                    </div>
                                </template>
                            </div>

                            <!-- Permissions -->
                            <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                                <h4 class="text-md font-semibold text-gray-800 mb-3">System Permissions</h4>
                                <div class="flex flex-wrap gap-2">
                                    <template x-for="permission in selectedEmployee.permissions" :key="permission">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800" x-text="permission.toUpperCase()"></span>
                                    </template>
                                    <template x-if="selectedEmployee.permissions.length === 0">
                                        <span class="text-sm text-gray-500">No permissions assigned</span>
                                    </template>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="flex justify-end space-x-3 pt-4 border-t border-gray-200">
                                <button type="button" @click="showEmployeeModal = false; selectedEmployee = null" class="px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors">
                                    Close
                                </button>
                                <button type="button" @click="editEmployee(selectedEmployee); showEmployeeModal = false" class="px-4 py-2 text-blue-700 bg-blue-100 rounded-lg hover:bg-blue-200 transition-colors">
                                    Edit Employee
                                </button>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </div>

        <!-- Cash Count Modal -->
        <div x-show="showCashCountModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
            <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[85vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-semibold text-gray-900" x-text="selectedDrawer ? 'Cash Count - ' + selectedDrawer.name : 'Cash Count'"></h3>
                        <button @click="showCashCountModal = false; selectedDrawer = null; resetCashCount()" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                    </div>

                    <template x-if="selectedDrawer">
                        <form @submit.prevent="completeCashCount()" class="space-y-4">
                            <!-- Drawer Info -->
                            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                <div class="grid grid-cols-2 gap-4 text-sm">
                                    <div>
                                        <span class="font-medium text-purple-800">Assigned Employee:</span>
                                        <p class="text-purple-900" x-text="selectedDrawer.assignedEmployee"></p>
                                    </div>
                                    <div>
                                        <span class="font-medium text-purple-800">Starting Amount:</span>
                                        <p class="text-purple-900" x-text="'$' + selectedDrawer.startingAmount.toFixed(2)"></p>
                                    </div>
                                    <div>
                                        <span class="font-medium text-purple-800">Expected Amount:</span>
                                        <p class="text-purple-900" x-text="'$' + selectedDrawer.currentAmount.toFixed(2)"></p>
                                    </div>
                                    <div>
                                        <span class="font-medium text-purple-800">Opened At:</span>
                                        <p class="text-purple-900" x-text="selectedDrawer.openedAt"></p>
                                    </div>
                                </div>
                            </div>

                            <!-- Cash Count Form -->
                            <div class="space-y-4">
                                <h4 class="font-medium text-gray-900">Count Physical Cash (Start with smallest denominations)</h4>

                                <!-- Coins - Start Here -->
                                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                    <h5 class="text-sm font-medium text-yellow-800 mb-3">Coins (Start Here)</h5>
                                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                        <div>
                                            <label class="block text-xs font-medium text-gray-700 mb-1">Pennies ($0.01)</label>
                                            <input type="number" min="0" x-model.number="cashCount.pennies" @input="calculateTotal()" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-700 mb-1">Nickels ($0.05)</label>
                                            <input type="number" min="0" x-model.number="cashCount.nickels" @input="calculateTotal()" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-700 mb-1">Dimes ($0.10)</label>
                                            <input type="number" min="0" x-model.number="cashCount.dimes" @input="calculateTotal()" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-700 mb-1">Quarters ($0.25)</label>
                                            <input type="number" min="0" x-model.number="cashCount.quarters" @input="calculateTotal()" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
                                        </div>
                                    </div>
                                </div>

                                <!-- Bills - Small to Large -->
                                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                    <h5 class="text-sm font-medium text-green-800 mb-3">Bills (Small to Large)</h5>
                                    <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                                        <div>
                                            <label class="block text-xs font-medium text-gray-700 mb-1">$1 Bills</label>
                                            <input type="number" min="0" x-model.number="cashCount.ones" @input="calculateTotal()" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-700 mb-1">$5 Bills</label>
                                            <input type="number" min="0" x-model.number="cashCount.fives" @input="calculateTotal()" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-700 mb-1">$10 Bills</label>
                                            <input type="number" min="0" x-model.number="cashCount.tens" @input="calculateTotal()" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-700 mb-1">$20 Bills</label>
                                            <input type="number" min="0" x-model.number="cashCount.twenties" @input="calculateTotal()" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-700 mb-1">$50 Bills</label>
                                            <input type="number" min="0" x-model.number="cashCount.fifties" @input="calculateTotal()" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-700 mb-1">$100 Bills</label>
                                            <input type="number" min="0" x-model.number="cashCount.hundreds" @input="calculateTotal()" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
                                        </div>
                                    </div>
                                </div>

                                <!-- Total -->
                                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="font-medium text-gray-700">Counted Total:</span>
                                        <span class="text-lg font-bold text-gray-900" x-text="'$' + cashCount.total.toFixed(2)"></span>
                                    </div>
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="font-medium text-gray-700">Expected Total:</span>
                                        <span class="text-lg font-bold text-gray-900" x-text="'$' + selectedDrawer.currentAmount.toFixed(2)"></span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="font-medium text-gray-700">Variance:</span>
                                        <span class="text-lg font-bold"
                                              :class="Math.abs(cashCount.total - selectedDrawer.currentAmount) < 0.01 ? 'text-green-600' : 'text-red-600'"
                                              x-text="'$' + (cashCount.total - selectedDrawer.currentAmount).toFixed(2)"></span>
                                    </div>
                                </div>

                                <!-- Notes -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Notes (Optional)</label>
                                    <textarea x-model="cashCount.notes" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="Add any notes about variances or issues..."></textarea>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="flex justify-end space-x-3 pt-4 border-t border-gray-200">
                                <button type="button" @click="showCashCountModal = false; selectedDrawer = null; resetCashCount()" class="px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors">
                                    Cancel
                                </button>
                                <button type="button" @click="printClosingSheet(selectedDrawer)" class="px-4 py-2 text-blue-700 bg-blue-100 rounded-lg hover:bg-blue-200 transition-colors">
                                    Print Closing Sheet
                                </button>
                                <button type="submit" class="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                                    Complete Count
                                </button>
                            </div>
                        </form>
                    </template>
                </div>
            </div>
        </div>

        <!-- Room Details Modal -->
        <div x-show="showRoomDetailsModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
            <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-semibold text-gray-900" x-text="selectedRoom ? selectedRoom.name + ' - Room Details' : 'Room Details'"></h3>
                        <button @click="showRoomDetailsModal = false; selectedRoom = null" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                    </div>

                    <template x-if="selectedRoom">
                        <div class="space-y-6">
                            <!-- Room Information -->
                            <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <p class="text-sm font-medium text-orange-800">Room Name</p>
                                        <p class="text-orange-900" x-text="selectedRoom.name"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-orange-800">Room Type</p>
                                        <p class="text-orange-900" x-text="selectedRoom.type"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-orange-800">Status</p>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                              :class="{
                                                  'bg-green-100 text-green-800': selectedRoom.status === 'active',
                                                  'bg-red-100 text-red-800': selectedRoom.status === 'maintenance',
                                                  'bg-yellow-100 text-yellow-800': selectedRoom.status === 'restricted'
                                              }"
                                              x-text="selectedRoom.status.charAt(0).toUpperCase() + selectedRoom.status.slice(1)"></span>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-orange-800">Capacity</p>
                                        <p class="text-orange-900" x-text="selectedRoom.currentCapacity + ' / ' + selectedRoom.maxCapacity + ' items'"></p>
                                    </div>
                                </div>
                            </div>

                            <!-- Environmental Controls -->
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <h4 class="text-md font-semibold text-blue-800 mb-3">Environmental Controls</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <p class="text-sm font-medium text-blue-700">Temperature</p>
                                        <p class="text-blue-900 text-xl font-bold" x-text="selectedRoom.temperature + '°F'"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-blue-700">Humidity</p>
                                        <p class="text-blue-900 text-xl font-bold" x-text="selectedRoom.humidity + '%'"></p>
                                    </div>
                                </div>
                            </div>

                            <!-- Utilization Chart -->
                            <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                                <h4 class="text-md font-semibold text-gray-800 mb-3">Room Utilization</h4>
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-sm font-medium text-gray-700">Current Usage</span>
                                    <span class="text-sm text-gray-600" x-text="Math.round((selectedRoom.currentCapacity / selectedRoom.maxCapacity) * 100) + '%'"></span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-3">
                                    <div class="bg-orange-500 h-3 rounded-full transition-all duration-300" :style="`width: ${(selectedRoom.currentCapacity / selectedRoom.maxCapacity) * 100}%`"></div>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="flex justify-end space-x-3 pt-4 border-t border-gray-200">
                                <button type="button" @click="showRoomDetailsModal = false; selectedRoom = null" class="px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors">
                                    Close
                                </button>
                                <button type="button" @click="editRoom(selectedRoom); showRoomDetailsModal = false" class="px-4 py-2 text-orange-700 bg-orange-100 rounded-lg hover:bg-orange-200 transition-colors">
                                    Edit Room
                                </button>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </div>

        <!-- Add Room Modal -->
        <div x-show="showAddRoomModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" @keydown.escape="closeAddRoomModal()" x-init="showAddRoomModal && $el.focus()" tabindex="0">
            <div class="bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900" x-text="selectedRoom ? 'Edit Room' : 'Add New Room'"></h3>
                        <button @click="closeAddRoomModal()" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                    </div>

                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Room Name *</label>
                            <input type="text" x-model="roomForm.name" placeholder="Enter room name" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500" required>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Room Type *</label>
                            <select x-model="roomForm.type" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500" required>
                                <option value="">Select room type...</option>
                                <option value="cultivation">Cultivation</option>
                                <option value="drying">Drying</option>
                                <option value="curing">Curing</option>
                                <option value="trimming">Trimming</option>
                                <option value="packaging">Packaging</option>
                                <option value="storage">Storage</option>
                                <option value="quarantine">Quarantine</option>
                            </select>
                        </div>

                        <!-- Sales Floor Availability -->
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <label class="block text-sm font-medium text-gray-700 mb-3">Sales Floor Availability</label>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input id="room-for-sale-true" name="room-for-sale" type="radio" x-model="roomForm.forSale" value="true" class="h-4 w-4 text-orange-600 focus:ring-orange-500 border-gray-300" aria-describedby="for-sale-help">
                                    <span class="ml-2 text-sm text-gray-700">For Sale - Items in this room are available for customer purchase</span>
                                </label>
                                <label class="flex items-center">
                                    <input id="room-for-sale-false" name="room-for-sale" type="radio" x-model="roomForm.forSale" value="false" class="h-4 w-4 text-orange-600 focus:ring-orange-500 border-gray-300" aria-describedby="not-for-sale-help">
                                    <span class="ml-2 text-sm text-gray-700">Not For Sale - Items stored for processing, curing, or storage only</span>
                                </label>
                            </div>
                            <p class="text-xs text-blue-600 mt-2">Items in "Not For Sale" rooms will not appear on online menus or be available for customer purchase</p>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Max Capacity (Optional)</label>
                                <input type="number" min="1" x-model="roomForm.maxCapacity" placeholder="100" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
                                <p class="text-xs text-gray-500 mt-1">Leave empty if no capacity limit needed</p>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                <select x-model="roomForm.status" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
                                    <option value="active">Active</option>
                                    <option value="restricted">Restricted</option>
                                </select>
                                <p x-show="roomForm.status === 'restricted'" class="text-xs text-red-600 mt-1">⚠ Restricted rooms cannot have items for sale and will not show on online menus</p>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Temperature (��F)</label>
                                <input type="number" x-model="roomForm.temperature" placeholder="68" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Humidity (%)</label>
                                <input type="number" min="0" max="100" x-model="roomForm.humidity" placeholder="50" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="mt-6 flex gap-3">
                        <button @click="closeAddRoomModal()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button @click="selectedRoom ? updateRoom() : addRoom()" :disabled="!roomForm.name || !roomForm.type" class="flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed" x-text="selectedRoom ? 'Update Room' : 'Add Room'">
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Drawer Modal -->
        <div x-show="showAddDrawerModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
            <div class="bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900">Add New Cash Drawer</h3>
                        <button @click="closeAddDrawerModal()" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                    </div>

                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Drawer Name *</label>
                            <input type="text" x-model="drawerForm.name" placeholder="Register 1" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Location *</label>
                            <input type="text" x-model="drawerForm.location" placeholder="Front Counter" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Assigned Employee *</label>
                            <select x-model="drawerForm.assignedEmployee" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                                <option value="">Select employee...</option>
                                <template x-for="employee in employees.filter(e => e.status === 'active')" :key="employee.id">
                                    <option :value="employee.name" x-text="employee.name"></option>
                                </template>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Starting Amount ($) *</label>
                            <input type="number" step="0.01" min="0" x-model="drawerForm.startingAmount" placeholder="100.00" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="mt-6 flex gap-3">
                        <button @click="closeAddDrawerModal()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button @click="addDrawer()" :disabled="!drawerForm.name || !drawerForm.location || !drawerForm.assignedEmployee || drawerForm.startingAmount < 0" class="flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed">
                            Add Drawer
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- PIN Verification Modal -->
        <div x-show="showPinModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
            <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900">PIN Required</h3>
                        <button @click="closePinModal()" class="text-gray-400 hover:text-gray-600 text-2xl">��</button>
                    </div>

                    <div class="space-y-4">
                        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                            <div class="flex items-center">
                                <svg class="w-5 h-5 text-red-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"/>
                                </svg>
                                <span class="text-red-800 font-medium">Security Verification Required</span>
                            </div>
                            <p class="text-red-700 text-sm mt-1" x-text="pinAction === 'deleteRoom' ? 'You are about to permanently delete a room. This action cannot be undone.' : 'You are about to permanently delete a cash drawer. This action cannot be undone.'"></p>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Enter Manager PIN</label>
                            <input type="password" x-model="pinInput" placeholder="Enter your PIN" maxlength="6" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" required autofocus>
                            <p class="text-xs text-gray-500 mt-1">Contact your manager if you don't have the PIN</p>
                        </div>

                        <div x-show="pinError" class="bg-red-50 border border-red-200 rounded p-3">
                            <p class="text-red-700 text-sm" x-text="pinError"></p>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="mt-6 flex gap-3">
                        <button @click="closePinModal()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button @click="verifyPinAndDelete()" :disabled="!pinInput" class="flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed">
                            Confirm Delete
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Employee Assignment Modal -->
        <div x-show="showEmployeeAssignModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
            <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-semibold text-gray-900" x-text="'Assign Employee to ' + (selectedDrawerForAssignment && selectedDrawerForAssignment.name ? selectedDrawerForAssignment.name : 'Drawer')"></h3>
                        <button @click="showEmployeeAssignModal = false; selectedDrawerForAssignment = null" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                    </div>

                    <div class="space-y-3">
                        <p class="text-sm text-gray-600">Select an employee to assign to this cash drawer:</p>

                        <div class="space-y-2 max-h-64 overflow-y-auto">
                            <template x-for="employee in getActiveEmployees()" :key="employee.id">
                                <button @click="confirmEmployeeAssignment(employee)" class="w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-gray-300 transition-colors">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-medium text-gray-900" x-text="employee.name"></p>
                                            <p class="text-sm text-gray-600" x-text="employee.role"></p>
                                        </div>
                                        <div class="flex items-center text-gray-400">
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                            </svg>
                                        </div>
                                    </div>
                                </button>
                            </template>
                        </div>

                        <template x-if="getActiveEmployees().length === 0">
                            <div class="text-center py-6">
                                <p class="text-gray-500">No active employees available for assignment</p>
                            </div>
                        </template>
                    </div>

                    <div class="mt-6 flex justify-end">
                        <button @click="showEmployeeAssignModal = false; selectedDrawerForAssignment = null" class="px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors">
                            Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- METRC Import Modal -->
        <div x-show="showMetrcImportModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
            <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-semibold text-gray-900">Import Product from METRC</h3>
                        <button @click="showMetrcImportModal = false; selectedVendorForImport = null; resetImportForm()" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                    </div>

                    <template x-if="selectedVendorForImport">
                        <div class="space-y-4">
                            <!-- Vendor Information -->
                            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                <h4 class="font-medium text-purple-900 mb-2">Importing from METRC Vendor</h4>
                                <div class="grid grid-cols-2 gap-4 text-sm">
                                    <div><span class="font-medium">Vendor:</span> <span x-text="selectedVendorForImport.name"></span></div>
                                    <div><span class="font-medium">License:</span> <span x-text="selectedVendorForImport.license"></span></div>
                                    <div><span class="font-medium">Packages:</span> <span x-text="selectedVendorForImport.packages.length"></span></div>
                                    <div><span class="font-medium">Total Value:</span> <span x-text="'$' + selectedVendorForImport.totalValue.toFixed(2)"></span></div>
                                </div>
                            </div>

                            <!-- Auto-filled METRC Data -->
                            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                <h4 class="font-medium text-green-900 mb-3">Auto-filled from METRC</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">METRC Tag</label>
                                        <input type="text" x-model="importForm.metrcTag" readonly class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50 focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Category</label>
                                        <input type="text" x-model="importForm.category" readonly class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50 focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Weight</label>
                                        <input type="text" x-model="importForm.weight" readonly class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50 focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">THC % / CBD %</label>
                                        <input type="text" x-model="importForm.cannabinoids" readonly class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50 focus:outline-none">
                                    </div>
                                </div>
                            </div>

                            <!-- Required User Input -->
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <h4 class="font-medium text-blue-900 mb-3">Product Details (Required)</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div x-data="{ showSuggestions: false, filteredProducts: [] }">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Product Name *</label>
                                        <div class="relative">
                                            <input type="text"
                                                   x-model="importForm.productName"
                                                   @input="filterProductSuggestions($event.target.value); showSuggestions = true"
                                                   @focus="showSuggestions = true"
                                                   @blur="setTimeout(() => showSuggestions = false, 200)"
                                                   required
                                                   class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                                                   placeholder="Type product name for suggestions...">

                                            <!-- Auto-suggestions dropdown -->
                                            <div x-show="showSuggestions && filteredProducts.length > 0"
                                                 class="absolute z-10 w-full bg-white border border-gray-300 rounded-lg shadow-lg mt-1 max-h-48 overflow-y-auto">
                                                <template x-for="product in filteredProducts.slice(0, 8)" :key="product.id">
                                                    <div @click="importForm.productName = product.name; showSuggestions = false"
                                                         class="px-3 py-2 hover:bg-blue-50 cursor-pointer border-b border-gray-100 last:border-b-0">
                                                        <div class="font-medium text-gray-900" x-text="product.name"></div>
                                                        <div class="text-xs text-gray-500" x-text="product.category + ' • ' + product.vendor"></div>
                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">Type to search existing products or create new entry</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">SKU *</label>
                                        <input type="text" x-model="importForm.sku" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter SKU">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Price ($) *</label>
                                        <input type="number" step="0.01" min="0" x-model="importForm.price" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="0.00">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Cost ($) *</label>
                                        <input type="number" step="0.01" min="0" x-model="importForm.cost" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="0.00">
                                    </div>
                                    <div class="md:col-span-2">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Room *</label>
                                        <select x-model="importForm.room" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                            <option value="">Select destination room...</option>
                                            <option value="flower-room-1">Flower Room 1</option>
                                            <option value="flower-room-2">Flower Room 2</option>
                                            <option value="packaging-room">Packaging Room</option>
                                            <option value="storage-room">Storage Room</option>
                                            <option value="vault">Vault</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Image Upload Section -->
                            <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                                <h4 class="font-medium text-orange-900 mb-3">Product Images (Optional)</h4>
                                <div class="space-y-4">
                                    <!-- Main Product Image -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Main Product Image</label>
                                        <div class="border-2 border-dashed border-orange-300 rounded-lg p-6 text-center hover:border-orange-400 transition-colors">
                                            <input type="file" @change="handleImageUpload($event, 'main')" accept="image/*" class="hidden" id="main-image-upload" name="main-image-upload" aria-describedby="main-image-help">
                                            <div x-show="!importForm.mainImage">
                                                <svg class="mx-auto h-12 w-12 text-orange-400" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                                                    <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                </svg>
                                                <p class="mt-2 text-sm text-gray-600">
                                                    <label for="main-image-upload" class="cursor-pointer text-orange-600 hover:text-orange-500 font-medium">Upload main image</label>
                                                    or drag and drop
                                                </p>
                                                <p class="text-xs text-gray-500">PNG, JPG, GIF up to 10MB</p>
                                            </div>
                                            <div x-show="importForm.mainImage" class="flex items-center justify-center space-x-3">
                                                <svg class="h-8 w-8 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                                </svg>
                                                <span class="text-green-700 font-medium" x-text="importForm.mainImage"></span>
                                                <button type="button" @click="importForm.mainImage = null" class="text-red-600 hover:text-red-700">
                                                    <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                                    </svg>
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Additional Images -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Additional Images</label>
                                        <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                            <template x-for="(image, index) in importForm.additionalImages" :key="index">
                                                <div class="relative border border-orange-300 rounded-lg p-3 text-center">
                                                    <svg class="mx-auto h-8 w-8 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                                    </svg>
                                                    <p class="text-xs text-gray-600 mt-1" x-text="image.substring(0, 15) + '...'"></p>
                                                    <button type="button" @click="removeAdditionalImage(index)" class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600">×</button>
                                                </div>
                                            </template>

                                            <!-- Add more images button -->
                                            <div x-show="importForm.additionalImages.length < 3" class="border-2 border-dashed border-orange-300 rounded-lg p-3 text-center hover:border-orange-400 transition-colors">
                                                <input type="file" @change="handleImageUpload($event, 'additional')" accept="image/*" class="hidden" :id="'additional-image-upload-' + importForm.additionalImages.length" :name="'additional-image-upload-' + importForm.additionalImages.length" aria-describedby="additional-image-help">
                                                <label :for="'additional-image-upload-' + importForm.additionalImages.length" class="cursor-pointer">
                                                    <svg class="mx-auto h-8 w-8 text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                                    </svg>
                                                    <p class="text-xs text-gray-600 mt-1">Add Image</p>
                                                </label>
                                            </div>
                                        </div>
                                        <p class="text-xs text-gray-500 mt-2">You can upload up to 3 additional images</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="flex justify-end space-x-3 pt-4 border-t border-gray-200">
                                <button type="button" @click="showMetrcImportModal = false; selectedVendorForImport = null; resetImportForm()" class="px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors">
                                    Cancel
                                </button>
                                <button type="button" @click="executeMetrcImport()" :disabled="!importForm.productName || !importForm.price || !importForm.cost || !importForm.room || !importForm.sku" class="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"/>
                                    </svg>
                                    Import to Inventory
                                </button>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </div>

        <!-- Customer View Modal -->
        <div x-show="showCustomerViewModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
            <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-semibold text-gray-900" x-text="selectedCustomer ? selectedCustomer.name + ' - Customer Details' : 'Customer Details'"></h3>
                        <button @click="showCustomerViewModal = false; selectedCustomer = null" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                    </div>

                    <template x-if="selectedCustomer">
                        <div class="space-y-6">
                            <!-- Customer Info -->
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <p class="text-sm font-medium text-blue-800">Customer ID</p>
                                        <p class="text-blue-900" x-text="selectedCustomer.id"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-blue-800">Full Name</p>
                                        <p class="text-blue-900" x-text="selectedCustomer.name"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-blue-800">Email</p>
                                        <p class="text-blue-900" x-text="selectedCustomer.email"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-blue-800">Phone</p>
                                        <p class="text-blue-900" x-text="selectedCustomer.phone || 'Not provided'"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-blue-800">Customer Type</p>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                              :class="selectedCustomer.isMedical ? 'bg-green-100 text-green-800' : 'bg-blue-100 text-blue-800'"
                                              x-text="selectedCustomer.isMedical ? 'Medical Patient' : 'Recreational Customer'"></span>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-blue-800">Loyalty Points</p>
                                        <p class="text-blue-900" x-text="(selectedCustomer.loyaltyPoints || 0) + ' points'"></p>
                                    </div>
                                </div>
                            </div>

                            <!-- Medical Information -->
                            <div x-show="selectedCustomer.isMedical" class="bg-green-50 border border-green-200 rounded-lg p-4">
                                <h4 class="text-md font-semibold text-green-800 mb-3">Medical Cannabis Information</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <p class="text-sm font-medium text-green-700">Medical Card Number</p>
                                        <p class="text-green-900 font-mono" x-text="selectedCustomer.medicalCard || 'Not provided'"></p>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-green-700">Tax Status</p>
                                        <span class="text-green-600 font-medium">Tax Exempt</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="flex justify-end space-x-3 pt-4 border-t border-gray-200">
                                <button type="button" @click="showCustomerViewModal = false; selectedCustomer = null" class="px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors">
                                    Close
                                </button>
                                <button type="button" @click="editCustomer(selectedCustomer); showCustomerViewModal = false" class="px-4 py-2 text-green-700 bg-green-100 rounded-lg hover:bg-green-200 transition-colors">
                                    Edit Customer
                                </button>
                                <button type="button" @click="startSaleForCustomer(selectedCustomer); showCustomerViewModal = false" class="px-4 py-2 text-white bg-purple-600 rounded-lg hover:bg-purple-700 transition-colors">
                                    Start Sale
                                </button>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </div>

        <!-- Edit Customer Modal -->
        <div x-show="showEditCustomerModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" @keydown.escape="closeEditCustomerModal()" @keydown.enter="!editCustomerForm.name ? null : updateCustomer()" x-init="showEditCustomerModal && $el.focus()" tabindex="0">
            <div class="bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900">Edit Customer</h3>
                        <button @click="closeEditCustomerModal()" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                    </div>

                    <div class="space-y-4">
                        <!-- Basic Information -->
                        <div class="space-y-4">
                            <h4 class="text-sm font-medium text-gray-700 border-b border-gray-200 pb-2">Basic Information</h4>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Full Name *</label>
                                    <input type="text" x-model="editCustomerForm.name" placeholder="Enter customer name" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
                                    <input type="tel" x-model="editCustomerForm.phone" placeholder="(555) 123-4567" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                                <input type="email" x-model="editCustomerForm.email" placeholder="customer@example.com" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                            </div>
                        </div>

                        <!-- Medical Information (if applicable) -->
                        <div x-show="editCustomerForm.isMedical" class="space-y-4">
                            <h4 class="text-sm font-medium text-gray-700 border-b border-gray-200 pb-2">Medical Cannabis Information</h4>

                            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                <div class="flex items-center mb-3">
                                    <svg class="w-5 h-5 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                    <span class="text-green-800 font-medium">Medical Cannabis Patient/Caregiver</span>
                                </div>
                                <p class="text-green-700 text-sm">This customer is tax exempt and their information is retained for compliance.</p>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Medical Card Number</label>
                                <input type="text" x-model="editCustomerForm.medicalCard" readonly class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50 focus:outline-none">
                                <p class="text-xs text-gray-500 mt-1">Medical card numbers cannot be edited for compliance reasons</p>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="mt-6 flex gap-3">
                        <button @click="closeEditCustomerModal()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button @click="updateCustomer()" :disabled="!editCustomerForm.name" class="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed">
                            Update Customer
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Price Tier Modal -->
        <div x-show="showAddTierModal" x-cloak class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" @keydown.escape="closeTierModal()" @keydown.enter="(!tierForm.name || !hasAnyPrices()) ? null : addPriceTier()" x-init="showAddTierModal && $el.focus()" tabindex="0">
            <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-semibold text-gray-900">Add Price Tier</h3>
                        <button @click="closeTierModal()" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                    </div>

                    <div class="space-y-6">
                        <!-- Tier Name -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tier Name *</label>
                            <input type="text" x-model="tierForm.name" placeholder="e.g., Premium Flower, Budget Option, etc." class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                        </div>

                        <!-- Standard Weight Grid -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-3">Standard Weight Pricing</label>
                            <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                    <!-- 1g -->
                                    <div class="flex items-center space-x-3">
                                        <div class="w-16 text-sm font-medium text-gray-700">1g</div>
                                        <div class="flex-1">
                                            <input type="number" step="0.01" min="0" x-model="tierForm.prices.weight_1g" placeholder="0.00" class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
                                        </div>
                                    </div>

                                    <!-- 3.5g -->
                                    <div class="flex items-center space-x-3">
                                        <div class="w-16 text-sm font-medium text-gray-700">3.5g</div>
                                        <div class="flex-1">
                                            <input type="number" step="0.01" min="0" x-model="tierForm.prices.weight_3_5g" placeholder="0.00" class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
                                        </div>
                                    </div>

                                    <!-- 7g -->
                                    <div class="flex items-center space-x-3">
                                        <div class="w-16 text-sm font-medium text-gray-700">7g</div>
                                        <div class="flex-1">
                                            <input type="number" step="0.01" min="0" x-model="tierForm.prices.weight_7g" placeholder="0.00" class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
                                        </div>
                                    </div>

                                    <!-- 14g -->
                                    <div class="flex items-center space-x-3">
                                        <div class="w-16 text-sm font-medium text-gray-700">14g</div>
                                        <div class="flex-1">
                                            <input type="number" step="0.01" min="0" x-model="tierForm.prices.weight_14g" placeholder="0.00" class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
                                        </div>
                                    </div>

                                    <!-- 28g -->
                                    <div class="flex items-center space-x-3 sm:col-span-2">
                                        <div class="w-16 text-sm font-medium text-gray-700">28g</div>
                                        <div class="flex-1">
                                            <input type="number" step="0.01" min="0" x-model="tierForm.prices.weight_28g" @input="autoFillFromOunce($event)" placeholder="0.00" class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Custom Weights Section -->
                        <div>
                            <div class="flex items-center justify-between mb-3">
                                <label class="block text-sm font-medium text-gray-700">Custom Weights</label>
                                <button @click="addCustomWeight()" type="button" class="text-purple-600 hover:text-purple-700 text-sm font-medium">+ Add Custom Weight</button>
                            </div>

                            <div x-show="tierForm.customWeights.length > 0" class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <template x-for="(customWeight, index) in tierForm.customWeights" :key="index">
                                    <div class="flex items-center space-x-3 mb-3 last:mb-0">
                                        <div class="flex-1">
                                            <input type="number" step="0.1" min="0.1" x-model="customWeight.weight" placeholder="Weight (g)" class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
                                        </div>
                                        <div class="flex-1">
                                            <input type="number" step="0.01" min="0" x-model="customWeight.price" placeholder="Price ($)" class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
                                        </div>
                                        <button @click="removeCustomWeight(index)" type="button" class="text-red-600 hover:text-red-700 px-2 py-1">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                            </svg>
                                        </button>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <!-- Pricing Summary -->
                        <div x-show="hasAnyPrices()" class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <h4 class="text-sm font-medium text-green-800 mb-2">Tier Summary</h4>
                            <div class="text-sm text-green-700">
                                <span x-text="'Tier Name: ' + (tierForm.name || 'Unnamed Tier')"></span>
                                <div class="mt-1">
                                    <span x-text="'Total Weights Configured: ' + getTotalWeightsConfigured()"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 flex gap-3">
                        <button @click="closeTierModal()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button @click="addPriceTier()" :disabled="!tierForm.name || !hasAnyPrices()" class="flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed">
                            Add Tier
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Void Sale Modal -->
        <div x-show="showVoidSaleModal" x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50" @keydown.escape="closeVoidSaleModal()" x-init="showVoidSaleModal && $el.focus()" tabindex="0" style="display: none;">
            <div class="relative top-20 mx-auto p-5 border w-[500px] shadow-lg rounded-md bg-white">
                <div class="mt-3">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center">
                            <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10">
                                <svg class="h-6 w-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"/>
                                </svg>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-medium text-gray-900">Void Transaction</h3>
                                <p class="text-sm text-gray-500" x-text="saleToVoid ? `Transaction ID: ${saleToVoid.id}` : ''"></p>
                            </div>
                        </div>
                        <button @click="closeVoidSaleModal()" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                    </div>

                    <!-- Transaction Details -->
                    <div x-show="saleToVoid" class="bg-gray-50 rounded-lg p-4 mb-6">
                        <h4 class="font-semibold text-gray-900 mb-3">Transaction Details</h4>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <span class="text-gray-600">Date/Time:</span>
                                <span class="block font-medium" x-text="saleToVoid ? new Date(saleToVoid.date).toLocaleString() : ''"></span>
                            </div>
                            <div>
                                <span class="text-gray-600">Customer:</span>
                                <span class="block font-medium" x-text="saleToVoid ? saleToVoid.customer : ''"></span>
                            </div>
                            <div>
                                <span class="text-gray-600">Items:</span>
                                <span class="block font-medium" x-text="saleToVoid ? `${saleToVoid.itemCount} items` : ''"></span>
                            </div>
                            <div>
                                <span class="text-gray-600">Total:</span>
                                <span class="block font-medium" x-text="saleToVoid ? `$${saleToVoid.total.toFixed(2)}` : ''"></span>
                            </div>
                            <div>
                                <span class="text-gray-600">Payment:</span>
                                <span class="block font-medium" x-text="saleToVoid ? saleToVoid.paymentMethod : ''"></span>
                            </div>
                            <div>
                                <span class="text-gray-600">Employee:</span>
                                <span class="block font-medium" x-text="saleToVoid ? saleToVoid.employee : ''"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Warning Message -->
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
                        <div class="flex">
                            <svg class="h-5 w-5 text-red-400 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01"/>
                            </svg>
                            <div class="ml-3">
                                <h3 class="text-sm font-medium text-red-800">Warning: This action cannot be undone</h3>
                                <div class="mt-2 text-sm text-red-700">
                                    <ul class="list-disc list-inside space-y-1">
                                        <li>All items will be restored to inventory</li>
                                        <li>Transaction will be marked as VOIDED</li>
                                        <li>METRC push will be prevented</li>
                                        <li>Void will be logged for audit trail</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Void Reason -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Reason for Void *</label>
                        <select x-model="voidForm.reason" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" required>
                            <option value="">Select a reason...</option>
                            <option value="customer-request">Customer Request</option>
                            <option value="inventory-error">Inventory Error</option>
                            <option value="payment-issue">Payment Issue</option>
                            <option value="system-error">System Error</option>
                            <option value="price-error">Price Error</option>
                            <option value="compliance-issue">Compliance Issue</option>
                            <option value="wrong-product">Wrong Product</option>
                            <option value="manager-override">Manager Override</option>
                            <option value="other">Other</option>
                        </select>
                    </div>

                    <!-- Additional Notes -->
                    <div class="mb-6" x-show="voidForm.reason === 'other' || voidForm.reason !== ''">
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <span x-text="voidForm.reason === 'other' ? 'Please specify (required)' : 'Additional Notes (optional)'"></span>
                        </label>
                        <textarea x-model="voidForm.notes" :required="voidForm.reason === 'other'" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" rows="3" placeholder="Enter additional details..."></textarea>
                    </div>

                    <!-- Employee PIN Verification -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Employee PIN *</label>
                        <div class="flex items-center space-x-3">
                            <input type="password" x-model="voidForm.employeePin" placeholder="Enter your PIN" maxlength="6" class="flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" required>
                            <button @click="verifyEmployeePin()" :disabled="!voidForm.employeePin || voidForm.employeePin.length < 4" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm">
                                Verify
                            </button>
                        </div>
                        <div x-show="voidForm.pinVerified" class="mt-2 text-sm text-green-600 flex items-center">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                            </svg>
                            PIN verified - <span x-text="voidForm.verifiedEmployee"></span>
                        </div>
                        <div x-show="voidForm.pinError" class="mt-2 text-sm text-red-600" x-text="voidForm.pinError"></div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex gap-3">
                        <button @click="closeVoidSaleModal()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                            Cancel
                        </button>
                        <button @click="confirmVoidSale()"
                                :disabled="!voidForm.reason || !voidForm.pinVerified || (voidForm.reason === 'other' && !voidForm.notes)"
                                class="flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors">
                            Void Transaction
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Create Deal Modal -->
        <div x-show="showCreateDealModal" x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50" @keydown.escape="closeCreateDealModal()" x-init="showCreateDealModal && $el.focus()" tabindex="0" style="display: none;">
            <div class="relative top-20 mx-auto p-5 border w-[800px] shadow-lg rounded-md bg-white">
                <div class="mt-3">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900" x-text="editingDeal ? 'Edit Deal' : 'Create New Deal'"></h3>
                        <button @click="closeCreateDealModal()" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                    </div>

                    <form @submit.prevent="saveDeal()">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Basic Information -->
                            <div class="space-y-4">
                                <h4 class="font-semibold text-gray-900 border-b border-gray-200 pb-2">Basic Information</h4>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Deal Name *</label>
                                    <input id="deal-name" name="deal-name" type="text" x-model="dealForm.name" placeholder="e.g., Happy Hour 20% Off" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" required aria-describedby="deal-name-help">
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                    <textarea id="deal-description" name="deal-description" x-model="dealForm.description" placeholder="Optional description for customers" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" rows="3" aria-describedby="deal-desc-help"></textarea>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Deal Type *</label>
                                    <select id="deal-type" name="deal-type" x-model="dealForm.type" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" required aria-describedby="deal-type-help">
                                        <option value="">Select deal type...</option>
                                        <option value="percentage">Percentage Discount</option>
                                        <option value="fixed">Fixed Amount Discount</option>
                                        <option value="bogo">Buy One Get One</option>
                                        <option value="buy-x-get-y">Buy X Get Y</option>
                                        <option value="bundle">Bundle Deal</option>
                                        <option value="loyalty">Loyalty Discount</option>
                                        <option value="first-time">First Time Customer</option>
                                        <option value="senior">Senior Discount</option>
                                    </select>
                                </div>

                                <div x-show="['percentage', 'fixed'].includes(dealForm.type)">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">
                                        <span x-text="dealForm.type === 'percentage' ? 'Discount Percentage' : 'Discount Amount'"></span> *
                                    </label>
                                    <div class="relative">
                                        <input id="discount-value" name="discount-value" type="number" x-model="dealForm.discountValue"
                                               :placeholder="dealForm.type === 'percentage' ? '20' : '5.00'"
                                               :step="dealForm.type === 'percentage' ? '1' : '0.01'"
                                               :min="0"
                                               :max="dealForm.type === 'percentage' ? '100' : ''"
                                               class="w-full border border-gray-300 rounded-lg px-3 py-2 pr-8 focus:outline-none focus:ring-2 focus:ring-red-500">
                                        <span class="absolute right-3 top-2 text-gray-500" x-text="dealForm.type === 'percentage' ? '%' : '$'"></span>
                                    </div>
                                </div>

                                <div x-show="dealForm.type === 'buy-x-get-y'">
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Buy Quantity *</label>
                                            <input id="buy-quantity" name="buy-quantity" type="number" x-model="dealForm.buyQuantity" placeholder="2" min="1" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" aria-describedby="buy-quantity-help">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Get Quantity *</label>
                                            <input id="get-quantity" name="get-quantity" type="number" x-model="dealForm.getQuantity" placeholder="1" min="1" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" aria-describedby="get-quantity-help">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Conditions & Restrictions -->
                            <div class="space-y-4">
                                <h4 class="font-semibold text-gray-900 border-b border-gray-200 pb-2">Conditions & Restrictions</h4>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Minimum Purchase Amount</label>
                                    <input id="min-purchase" name="min-purchase" type="number" x-model="dealForm.minPurchase" placeholder="0.00" step="0.01" min="0" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" aria-describedby="min-purchase-help">
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Usage Limit</label>
                                    <input id="usage-limit" name="usage-limit" type="number" x-model="dealForm.usageLimit" placeholder="Leave empty for unlimited" min="1" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" aria-describedby="usage-limit-help">
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Applicable Categories</label>
                                    <div class="space-y-2 max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-3">
                                        <label class="flex items-center">
                                            <input id="all-categories" name="all-categories" type="checkbox" value="" x-model="dealForm.allCategories" @change="toggleAllCategories()" class="mr-2" aria-describedby="all-categories-help">
                                            <span class="text-sm font-medium">All Categories</span>
                                        </label>
                                        <template x-for="category in getUniqueCategories()" :key="category">
                                            <label class="flex items-center">
                                                <input :id="`category-${category}`" :name="`category-${category}`" type="checkbox" :value="category" x-model="dealForm.applicableCategories" :disabled="dealForm.allCategories" class="mr-2" :aria-describedby="`category-${category}-help`">
                                                <span class="text-sm" x-text="category"></span>
                                            </label>
                                        </template>
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Specific Products (Optional)</label>
                                    <select id="applicable-products" name="applicable-products" multiple x-model="dealForm.applicableProducts" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" size="4" aria-describedby="products-help">
                                        <template x-for="product in products.filter(p => !p.isGLS)" :key="product.id">
                                            <option :value="product.id" x-text="product.name"></option>
                                        </template>
                                    </select>
                                    <p class="text-xs text-gray-500 mt-1">Hold Ctrl/Cmd to select multiple products. GLS items are excluded.</p>
                                </div>

                                <div class="flex items-center">
                                    <input type="checkbox" x-model="dealForm.excludeGLS" id="excludeGLS" name="exclude-gls" class="mr-2" checked disabled aria-describedby="exclude-gls-help">
                                    <label for="excludeGLS" class="text-sm text-gray-700">Exclude GLS items (automatic - GLS items only accept manual discounts)</label>
                                </div>

                                <div class="flex items-center">
                                    <input type="checkbox" x-model="dealForm.stackable" id="stackable" name="stackable" class="mr-2" aria-describedby="stackable-help">
                                    <label for="stackable" class="text-sm text-gray-700">Allow stacking with other deals</label>
                                </div>
                            </div>
                        </div>

                        <!-- Schedule -->
                        <div class="mt-6">
                            <h4 class="font-semibold text-gray-900 border-b border-gray-200 pb-2 mb-4">Schedule</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Start Date *</label>
                                    <input id="start-date" name="start-date" type="date" x-model="dealForm.startDate" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" required aria-describedby="start-date-help">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">End Date *</label>
                                    <input id="end-date" name="end-date" type="date" x-model="dealForm.endDate" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" required aria-describedby="end-date-help">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Start Time</label>
                                    <input id="start-time" name="start-time" type="time" x-model="dealForm.startTime" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" aria-describedby="start-time-help">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">End Time</label>
                                    <input type="time" x-model="dealForm.endTime" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                                </div>
                            </div>
                        </div>

                        <!-- Days of Week -->
                        <div class="mt-6">
                            <h4 class="font-semibold text-gray-900 border-b border-gray-200 pb-2 mb-4">Active Days</h4>
                            <div class="grid grid-cols-7 gap-2">
                                <template x-for="(day, index) in ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']" :key="day">
                                    <label class="flex flex-col items-center p-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50"
                                           :class="dealForm.activeDays.includes(index) ? 'bg-red-50 border-red-300' : ''">
                                        <input :id="`active-day-${index}`" :name="`active-day-${index}`" type="checkbox" :value="index" x-model="dealForm.activeDays" class="mb-1" :aria-label="`${day} active toggle`">
                                        <span class="text-sm" x-text="day"></span>
                                    </label>
                                </template>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="flex gap-3 mt-8 pt-6 border-t border-gray-200">
                            <button type="button" @click="closeCreateDealModal()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                                Cancel
                            </button>
                            <button type="submit" class="flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors">
                                <span x-text="editingDeal ? 'Update Deal' : 'Create Deal'"></span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- CSV Import Modal -->
        <div x-show="showCsvImportModal" x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" class="fixed inset-0 bg-gray-500 bg-opacity-75 z-50 flex items-center justify-center p-4">
            <div class="relative bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900">Import Products from CSV</h3>
                        <button @click="closeCsvImportModal()" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                    </div>

                    <!-- File Upload Section -->
                    <div class="mb-6">
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors">
                            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                            </svg>
                            <div class="mt-4">
                                <label for="csv-file-upload" class="cursor-pointer">
                                    <span class="mt-2 block text-sm font-medium text-gray-900">
                                        Choose CSV file to upload
                                    </span>
                                    <input id="csv-file-upload" name="csv-file-upload" type="file" accept=".csv" @change="handleCsvFileUpload($event)" class="sr-only">
                                </label>
                                <p class="mt-2 text-xs text-gray-500">
                                    CSV files only. Use our templates for proper formatting.
                                </p>
                            </div>
                        </div>

                        <div x-show="csvImportForm.fileName" class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                            <div class="flex items-center">
                                <svg class="w-5 h-5 text-blue-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                </svg>
                                <span class="text-blue-900 font-medium" x-text="'Selected: ' + csvImportForm.fileName"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Options Section -->
                    <div class="mb-6 bg-gray-50 p-4 rounded-lg">
                        <h4 class="text-md font-medium text-gray-900 mb-3">Import Options</h4>
                        <div class="space-y-3">
                            <label class="flex items-center">
                                <input id="skip-first-row" name="skip-first-row" type="checkbox" x-model="csvImportForm.skipFirstRow" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded" aria-describedby="skip-row-help">
                                <span class="ml-2 text-sm text-gray-700">Skip first row (contains headers)</span>
                            </label>
                        </div>
                    </div>

                    <!-- Preview Button and Data -->
                    <div class="mb-6">
                        <button @click="previewCsvData()" :disabled="!csvImportForm.fileName" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                            </svg>
                            Preview Data
                        </button>

                        <!-- Preview Results -->
                        <div x-show="csvImportForm.previewData.length > 0" class="mt-4">
                            <div class="bg-white border border-gray-200 rounded-lg p-4">
                                <div class="flex items-center justify-between mb-4">
                                    <h5 class="font-medium text-gray-900">Data Preview (First 10 rows)</h5>
                                    <div class="flex gap-4 text-sm">
                                        <span class="text-green-600 font-medium" x-text="'Valid: ' + csvImportForm.validRows"></span>
                                        <span class="text-red-600 font-medium" x-text="'Errors: ' + csvImportForm.errorRows"></span>
                                        <span class="text-gray-600" x-text="'Total: ' + csvImportForm.totalRows"></span>
                                    </div>
                                </div>

                                <div class="overflow-x-auto">
                                    <table class="w-full text-sm">
                                        <thead>
                                            <tr class="border-b border-gray-200">
                                                <th class="text-left py-2 px-2">Row</th>
                                                <th class="text-left py-2 px-2">Status</th>
                                                <th class="text-left py-2 px-2">Name</th>
                                                <th class="text-left py-2 px-2">Category</th>
                                                <th class="text-left py-2 px-2">Price</th>
                                                <th class="text-left py-2 px-2">Stock</th>
                                                <th class="text-left py-2 px-2">Errors</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <template x-for="row in csvImportForm.previewData" :key="row.rowNum">
                                                <tr class="border-b border-gray-100" :class="row.valid ? 'bg-green-50' : 'bg-red-50'">
                                                    <td class="py-2 px-2" x-text="row.rowNum"></td>
                                                    <td class="py-2 px-2">
                                                        <span :class="row.valid ? 'text-green-600' : 'text-red-600'" x-text="row.valid ? 'Valid' : 'Error'"></span>
                                                    </td>
                                                    <td class="py-2 px-2" x-text="row.data.name"></td>
                                                    <td class="py-2 px-2" x-text="row.data.category"></td>
                                                    <td class="py-2 px-2" x-text="'$' + row.data.price.toFixed(2)"></td>
                                                    <td class="py-2 px-2" x-text="row.data.stock"></td>
                                                    <td class="py-2 px-2">
                                                        <div x-show="!row.valid" class="text-xs text-red-600">
                                                            <template x-for="error in row.errors" :key="error">
                                                                <div x-text="error"></div>
                                                            </template>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </template>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Import Results -->
                    <div x-show="csvImportForm.importComplete" class="mb-6 p-4 bg-green-50 border border-green-200 rounded-lg">
                        <h5 class="font-medium text-green-900 mb-2">Import Complete!</h5>
                        <div class="text-sm text-green-800">
                            <p x-text="'Successfully imported: ' + (csvImportForm.importResults?.imported || 0) + ' products'"></p>
                            <p x-text="'Skipped (errors): ' + (csvImportForm.importResults?.skipped || 0) + ' rows'"></p>
                            <p x-text="'Total processed: ' + (csvImportForm.importResults?.total || 0) + ' rows'"></p>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex gap-3">
                        <button @click="closeCsvImportModal()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                            <span x-text="csvImportForm.importComplete ? 'Close' : 'Cancel'"></span>
                        </button>
                        <button @click="importCsvData()"
                                :disabled="csvImportForm.validRows === 0 || csvImportForm.importing || csvImportForm.importComplete"
                                class="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2">
                            <svg x-show="csvImportForm.importing" class="animate-spin w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                            </svg>
                            <span x-text="csvImportForm.importing ? 'Importing...' : 'Import Products'"></span>
                        </button>
                    </div>

                    <!-- CSV Format Help -->
                    <div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                        <h5 class="font-medium text-blue-900 mb-2">Expected CSV Format:</h5>
                        <p class="text-sm text-blue-800 mb-2">Your CSV should have these columns in order:</p>
                        <code class="text-xs bg-white p-2 rounded border block">
                            Product Name, Category, Price, Cost, Stock, Weight, THC%, CBD%, SKU, Vendor, METRC Tag
                        </code>
                        <p class="text-xs text-blue-700 mt-2">
                            Download our category-specific templates for the exact format and examples.
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Template Download Modal -->
        <div x-show="showTemplateModal" x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" class="fixed inset-0 bg-gray-500 bg-opacity-75 z-50 flex items-center justify-center p-4">
            <div class="relative bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900">Download CSV Import Templates</h3>
                        <button @click="closeTemplateModal()" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
                    </div>

                    <div class="mb-6">
                        <p class="text-gray-600 mb-4">
                            Download pre-formatted CSV templates for different product categories. Each template includes sample data and the correct column structure for importing.
                        </p>

                        <!-- Download All Button -->
                        <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                            <button @click="downloadAllTemplates()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                </svg>
                                Download All Templates
                            </button>
                            <p class="text-sm text-gray-600 mt-2">Downloads all category templates at once</p>
                        </div>
                    </div>

                    <!-- Category Templates Grid -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Flower Template -->
                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="flex items-center mb-3">
                                <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                                    <svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2L13.09 7.26L18 4.27L15.74 9.09L21 8L16.77 11.62L21 16L15.74 14.91L18 19.73L13.09 16.74L12 22L10.91 16.74L6 19.73L8.26 14.91L3 16L7.23 11.62L3 8L8.26 9.09L6 4.27L10.91 7.26L12 2Z"/>
                                    </svg>
                                </div>
                                <h4 class="font-medium text-gray-900">Flower Products</h4>
                            </div>
                            <p class="text-sm text-gray-600 mb-4">Template for flower, buds, and smokable products including THC/CBD percentages and weight specifications.</p>
                            <button @click="downloadTemplate('flower')" class="w-full bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition-colors text-sm">
                                Download Flower Template
                            </button>
                        </div>

                        <!-- Edibles Template -->
                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="flex items-center mb-3">
                                <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mr-3">
                                    <svg class="w-5 h-5 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 15.546c-.523 0-1.046.151-1.5.454a2.704 2.704 0 01-3 0 2.704 2.704 0 00-3 0 2.704 2.704 0 01-3 0 2.704 2.704 0 00-3 0 2.704 2.704 0 01-3 0 2.701 2.701 0 00-1.5-.454M9 6v2m3-2v2m3-2v2M9 3h.01M12 3h.01M15 3h.01M21 21v-7a2 2 0 00-2-2H5a2 2 0 00-2 2v7h18zM3 9h18v4a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/>
                                    </svg>
                                </div>
                                <h4 class="font-medium text-gray-900">Edibles</h4>
                            </div>
                            <p class="text-sm text-gray-600 mb-4">Template for edible products including mg dosages, serving counts, and food safety information.</p>
                            <button @click="downloadTemplate('edibles')" class="w-full bg-orange-600 text-white px-4 py-2 rounded hover:bg-orange-700 transition-colors text-sm">
                                Download Edibles Template
                            </button>
                        </div>

                        <!-- Concentrates Template -->
                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="flex items-center mb-3">
                                <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mr-3">
                                    <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"/>
                                    </svg>
                                </div>
                                <h4 class="font-medium text-gray-900">Concentrates</h4>
                            </div>
                            <p class="text-sm text-gray-600 mb-4">Template for concentrates, extracts, wax, shatter, and other concentrated cannabis products.</p>
                            <button @click="downloadTemplate('concentrates')" class="w-full bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 transition-colors text-sm">
                                Download Concentrates Template
                            </button>
                        </div>

                        <!-- Pre-Rolls Template -->
                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="flex items-center mb-3">
                                <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                                    <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                    </svg>
                                </div>
                                <h4 class="font-medium text-gray-900">Pre-Rolls</h4>
                            </div>
                            <p class="text-sm text-gray-600 mb-4">Template for pre-rolled joints including pack sizes, strain information, and rolling specifications.</p>
                            <button @click="downloadTemplate('prerolls')" class="w-full bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors text-sm">
                                Download Pre-Rolls Template
                            </button>
                        </div>

                        <!-- Tinctures Template -->
                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="flex items-center mb-3">
                                <div class="w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center mr-3">
                                    <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"/>
                                    </svg>
                                </div>
                                <h4 class="font-medium text-gray-900">Tinctures</h4>
                            </div>
                            <p class="text-sm text-gray-600 mb-4">Template for liquid tinctures with mg/ml concentrations and volume specifications.</p>
                            <button @click="downloadTemplate('tinctures')" class="w-full bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 transition-colors text-sm">
                                Download Tinctures Template
                            </button>
                        </div>

                        <!-- Topicals Template -->
                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="flex items-center mb-3">
                                <div class="w-10 h-10 bg-pink-100 rounded-lg flex items-center justify-center mr-3">
                                    <svg class="w-5 h-5 text-pink-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                                    </svg>
                                </div>
                                <h4 class="font-medium text-gray-900">Topicals</h4>
                            </div>
                            <p class="text-sm text-gray-600 mb-4">Template for topical products including creams, balms, and lotions with application types.</p>
                            <button @click="downloadTemplate('topicals')" class="w-full bg-pink-600 text-white px-4 py-2 rounded hover:bg-pink-700 transition-colors text-sm">
                                Download Topicals Template
                            </button>
                        </div>

                        <!-- Vape Products Template -->
                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="flex items-center mb-3">
                                <div class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center mr-3">
                                    <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
                                    </svg>
                                </div>
                                <h4 class="font-medium text-gray-900">Vape Products</h4>
                            </div>
                            <p class="text-sm text-gray-600 mb-4">Template for vape cartridges, pens, and hardware with cartridge specifications.</p>
                            <button @click="downloadTemplate('vape')" class="w-full bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition-colors text-sm">
                                Download Vape Template
                            </button>
                        </div>

                        <!-- Accessories Template -->
                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="flex items-center mb-3">
                                <div class="w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center mr-3">
                                    <svg class="w-5 h-5 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"/>
                                    </svg>
                                </div>
                                <h4 class="font-medium text-gray-900">Accessories</h4>
                            </div>
                            <p class="text-sm text-gray-600 mb-4">Template for smoking accessories, pipes, papers, and paraphernalia (no cannabinoids).</p>
                            <button @click="downloadTemplate('accessories')" class="w-full bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700 transition-colors text-sm">
                                Download Accessories Template
                            </button>
                        </div>

                        <!-- Hemp Template -->
                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="flex items-center mb-3">
                                <div class="w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center mr-3">
                                    <svg class="w-5 h-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"/>
                                    </svg>
                                </div>
                                <h4 class="font-medium text-gray-900">Hemp Products</h4>
                            </div>
                            <p class="text-sm text-gray-600 mb-4">Template for hemp-derived products including CBD, Delta-8, and federally compliant products.</p>
                            <button @click="downloadTemplate('hemp')" class="w-full bg-emerald-600 text-white px-4 py-2 rounded hover:bg-emerald-700 transition-colors text-sm">
                                Download Hemp Template
                            </button>
                        </div>
                    </div>

                    <!-- Instructions -->
                    <div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                        <h5 class="font-medium text-blue-900 mb-2">How to Use Templates:</h5>
                        <ol class="text-sm text-blue-800 space-y-1 list-decimal list-inside">
                            <li>Download the template for your product category</li>
                            <li>Open the CSV file in Excel, Google Sheets, or any spreadsheet program</li>
                            <li>Replace the sample data with your actual product information</li>
                            <li>Save the file as CSV format</li>
                            <li>Use the "Import CSV" button to upload your completed file</li>
                        </ol>
                        <p class="text-xs text-blue-700 mt-3">
                            <strong>Note:</strong> Each template includes sample data to show the expected format. All templates are optimized for Oregon METRC compliance.
                        </p>
                    </div>

                    <!-- Close Button -->
                    <div class="mt-6 flex justify-end">
                        <button @click="closeTemplateModal()" class="px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors">
                            Close
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- CREATE REPORT Modal -->
        <div x-show="showCreateReportModal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" @keydown.escape="closeCreateReportModal()" x-init="showCreateReportModal && $el.focus()" tabindex="0">
            <div class="bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 max-h-[95vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6 pb-4 border-b border-gray-200">
                        <h3 class="text-2xl font-bold text-gray-900">Create Custom Report</h3>
                        <button @click="closeCreateReportModal()" class="text-gray-400 hover:text-gray-600 text-2xl font-bold">&times;</button>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <!-- Left Column: Report Configuration -->
                        <div class="lg:col-span-2 space-y-6">
                            <!-- Basic Report Information -->
                            <div class="bg-gray-50 rounded-lg p-6">
                                <h4 class="text-lg font-semibold text-gray-900 mb-4">Report Details</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Report Name *</label>
                                        <input x-model="customReport.name" type="text" placeholder="e.g., Q4 Sales Analysis" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cannabis-green focus:border-cannabis-green">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Report Type *</label>
                                        <select x-model="customReport.type" @change="updateDataSources()" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cannabis-green focus:border-cannabis-green">
                                            <option value="">Select report type...</option>
                                            <option value="sales">Sales & Revenue</option>
                                            <option value="inventory">Inventory & Stock</option>
                                            <option value="customers">Customer Analysis</option>
                                            <option value="employees">Employee Performance</option>
                                            <option value="financial">Financial Analysis</option>
                                            <option value="compliance">Compliance & Regulatory</option>
                                            <option value="operational">Operational Metrics</option>
                                            <option value="custom">Custom Multi-Source</option>
                                        </select>
                                    </div>
                                    <div class="md:col-span-2">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                        <textarea x-model="customReport.description" placeholder="Describe what this report will analyze..." class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cannabis-green focus:border-cannabis-green" rows="3"></textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- Data Sources -->
                            <div class="bg-blue-50 rounded-lg p-6">
                                <h4 class="text-lg font-semibold text-blue-900 mb-4">Data Sources</h4>
                                <p class="text-sm text-blue-700 mb-4">Select which data sources to include in your report</p>
                                <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                                    <template x-for="source in availableDataSources" :key="source.id">
                                        <label class="flex items-center p-3 bg-white border-2 rounded-lg cursor-pointer transition-colors"
                                               :class="customReport.dataSources.includes(source.id) ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-blue-300'">
                                            <input type="checkbox" :value="source.id" x-model="customReport.dataSources" class="sr-only">
                                            <div class="flex items-center space-x-3">
                                                <svg class="w-5 h-5" :class="customReport.dataSources.includes(source.id) ? 'text-blue-600' : 'text-gray-400'" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" :d="source.icon"></path>
                                                </svg>
                                                <span class="text-sm font-medium" :class="customReport.dataSources.includes(source.id) ? 'text-blue-900' : 'text-gray-700'" x-text="source.name"></span>
                                            </div>
                                        </label>
                                    </template>
                                </div>
                            </div>

                            <!-- Date Range & Filters -->
                            <div class="bg-green-50 rounded-lg p-6">
                                <h4 class="text-lg font-semibold text-green-900 mb-4">Filters & Time Range</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Date Range *</label>
                                        <select x-model="customReport.dateRange" @change="updateDateInputs()" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                                            <option value="today">Today</option>
                                            <option value="yesterday">Yesterday</option>
                                            <option value="last-7-days">Last 7 Days</option>
                                            <option value="last-30-days">Last 30 Days</option>
                                            <option value="this-month">This Month</option>
                                            <option value="last-month">Last Month</option>
                                            <option value="this-quarter">This Quarter</option>
                                            <option value="last-quarter">Last Quarter</option>
                                            <option value="this-year">This Year</option>
                                            <option value="last-year">Last Year</option>
                                            <option value="custom">Custom Range</option>
                                        </select>
                                    </div>
                                    <div x-show="customReport.dateRange === 'custom'" class="grid grid-cols-2 gap-2">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Start Date</label>
                                            <input x-model="customReport.startDate" type="date" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">End Date</label>
                                            <input x-model="customReport.endDate" type="date" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                                        </div>
                                    </div>
                                </div>

                                <!-- Advanced Filters -->
                                <div class="mt-4 space-y-4">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Product Categories</label>
                                            <div class="max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-2 bg-white">
                                                <template x-for="category in productCategories" :key="category">
                                                    <label class="flex items-center py-1">
                                                        <input type="checkbox" :value="category" x-model="customReport.categoryFilters" class="mr-2 text-green-600">
                                                        <span class="text-sm" x-text="category"></span>
                                                    </label>
                                                </template>
                                            </div>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Employee Filter</label>
                                            <select x-model="customReport.employeeFilter" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                                                <option value="">All Employees</option>
                                                <option value="current-user">Current User Only</option>
                                                <option value="admin-level">Admin Level</option>
                                                <option value="manager-level">Manager Level</option>
                                                <option value="cashier-level">Cashier Level</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Customer Type</label>
                                            <select x-model="customReport.customerType" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                                                <option value="">All Customers</option>
                                                <option value="recreational">Recreational Only</option>
                                                <option value="medical">Medical Only</option>
                                                <option value="loyalty">Loyalty Members</option>
                                                <option value="new">New Customers</option>
                                                <option value="returning">Returning Customers</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Payment Method</label>
                                            <select x-model="customReport.paymentMethod" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                                                <option value="">All Payment Methods</option>
                                                <option value="cash">Cash Only</option>
                                                <option value="debit">Debit Card Only</option>
                                                <option value="credit">Credit Card Only</option>
                                                <option value="digital">Digital Payments</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Metrics & KPIs -->
                            <div class="bg-purple-50 rounded-lg p-6">
                                <h4 class="text-lg font-semibold text-purple-900 mb-4">Metrics & KPIs</h4>
                                <p class="text-sm text-purple-700 mb-4">Choose what metrics to calculate and display</p>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <!-- Sales Metrics -->
                                    <div>
                                        <h5 class="font-medium text-gray-900 mb-3">Sales Metrics</h5>
                                        <div class="space-y-2">
                                            <template x-for="metric in salesMetrics" :key="metric.id">
                                                <label class="flex items-center">
                                                    <input type="checkbox" :value="metric.id" x-model="customReport.selectedMetrics" class="mr-2 text-purple-600">
                                                    <span class="text-sm" x-text="metric.name"></span>
                                                </label>
                                            </template>
                                        </div>
                                    </div>
                                    <!-- Inventory Metrics -->
                                    <div>
                                        <h5 class="font-medium text-gray-900 mb-3">Inventory Metrics</h5>
                                        <div class="space-y-2">
                                            <template x-for="metric in inventoryMetrics" :key="metric.id">
                                                <label class="flex items-center">
                                                    <input type="checkbox" :value="metric.id" x-model="customReport.selectedMetrics" class="mr-2 text-purple-600">
                                                    <span class="text-sm" x-text="metric.name"></span>
                                                </label>
                                            </template>
                                        </div>
                                    </div>
                                    <!-- Customer Metrics -->
                                    <div>
                                        <h5 class="font-medium text-gray-900 mb-3">Customer Metrics</h5>
                                        <div class="space-y-2">
                                            <template x-for="metric in customerMetrics" :key="metric.id">
                                                <label class="flex items-center">
                                                    <input type="checkbox" :value="metric.id" x-model="customReport.selectedMetrics" class="mr-2 text-purple-600">
                                                    <span class="text-sm" x-text="metric.name"></span>
                                                </label>
                                            </template>
                                        </div>
                                    </div>
                                    <!-- Financial Metrics -->
                                    <div>
                                        <h5 class="font-medium text-gray-900 mb-3">Financial Metrics</h5>
                                        <div class="space-y-2">
                                            <template x-for="metric in financialMetrics" :key="metric.id">
                                                <label class="flex items-center">
                                                    <input type="checkbox" :value="metric.id" x-model="customReport.selectedMetrics" class="mr-2 text-purple-600">
                                                    <span class="text-sm" x-text="metric.name"></span>
                                                </label>
                                            </template>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Chart & Visualization Options -->
                            <div class="bg-orange-50 rounded-lg p-6">
                                <h4 class="text-lg font-semibold text-orange-900 mb-4">Charts & Visualizations</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Primary Chart Type</label>
                                        <select x-model="customReport.chartType" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                                            <option value="table">Data Table Only</option>
                                            <option value="line">Line Chart</option>
                                            <option value="bar">Bar Chart</option>
                                            <option value="pie">Pie Chart</option>
                                            <option value="doughnut">Doughnut Chart</option>
                                            <option value="area">Area Chart</option>
                                            <option value="scatter">Scatter Plot</option>
                                            <option value="mixed">Mixed Charts</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Chart Color Scheme</label>
                                        <select x-model="customReport.colorScheme" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                                            <option value="cannabis">Cannabis Green</option>
                                            <option value="blue">Professional Blue</option>
                                            <option value="rainbow">Rainbow</option>
                                            <option value="monochrome">Monochrome</option>
                                            <option value="earth">Earth Tones</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="mt-4 space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" x-model="customReport.includeComparisons" class="mr-2 text-orange-600">
                                        <span class="text-sm">Include period-over-period comparisons</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" x-model="customReport.includeTrends" class="mr-2 text-orange-600">
                                        <span class="text-sm">Show trend lines and forecasting</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" x-model="customReport.includeBreakdowns" class="mr-2 text-orange-600">
                                        <span class="text-sm">Include category/segment breakdowns</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Right Column: Preview & Actions -->
                        <div class="space-y-6">
                            <!-- Report Preview -->
                            <div class="bg-gray-50 rounded-lg p-4">
                                <h4 class="font-semibold text-gray-900 mb-3">Report Preview</h4>
                                <div class="bg-white border-2 border-dashed border-gray-300 rounded-lg p-4 min-h-48">
                                    <div x-show="customReport.name" class="mb-3">
                                        <h5 class="font-bold text-lg text-gray-900" x-text="customReport.name"></h5>
                                        <p class="text-sm text-gray-600" x-text="customReport.description"></p>
                                    </div>
                                    <div x-show="customReport.dataSources.length > 0" class="mb-3">
                                        <p class="text-sm font-medium text-gray-700">Data Sources:</p>
                                        <p class="text-xs text-gray-600" x-text="customReport.dataSources.join(', ')"></p>
                                    </div>
                                    <div x-show="customReport.selectedMetrics.length > 0" class="mb-3">
                                        <p class="text-sm font-medium text-gray-700">Metrics:</p>
                                        <p class="text-xs text-gray-600" x-text="customReport.selectedMetrics.length + ' metrics selected'"></p>
                                    </div>
                                    <div x-show="!customReport.name && customReport.dataSources.length === 0" class="text-center text-gray-400">
                                        <svg class="w-12 h-12 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a4 4 0 01-4-4V5a4 4 0 014-4h10a4 4 0 014 4v14a4 4 0 01-4 4z"/>
                                        </svg>
                                        <p class="text-sm">Configure your report to see preview</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Export Options -->
                            <div class="bg-indigo-50 rounded-lg p-4">
                                <h4 class="font-semibold text-indigo-900 mb-3">Export Options</h4>
                                <div class="space-y-3">
                                    <label class="flex items-center">
                                        <input type="checkbox" x-model="customReport.exportFormats" value="pdf" class="mr-2 text-indigo-600">
                                        <span class="text-sm">PDF Report</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" x-model="customReport.exportFormats" value="excel" class="mr-2 text-indigo-600">
                                        <span class="text-sm">Excel Spreadsheet</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" x-model="customReport.exportFormats" value="csv" class="mr-2 text-indigo-600">
                                        <span class="text-sm">CSV Data</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" x-model="customReport.exportFormats" value="json" class="mr-2 text-indigo-600">
                                        <span class="text-sm">JSON Data</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Schedule Options -->
                            <div class="bg-green-50 rounded-lg p-4">
                                <h4 class="font-semibold text-green-900 mb-3">Schedule & Automation</h4>
                                <div class="space-y-3">
                                    <label class="flex items-center">
                                        <input type="checkbox" x-model="customReport.autoSchedule" class="mr-2 text-green-600">
                                        <span class="text-sm">Schedule automatic generation</span>
                                    </label>
                                    <div x-show="customReport.autoSchedule" class="pl-6 space-y-2">
                                        <select x-model="customReport.scheduleFrequency" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm">
                                            <option value="daily">Daily</option>
                                            <option value="weekly">Weekly</option>
                                            <option value="monthly">Monthly</option>
                                            <option value="quarterly">Quarterly</option>
                                        </select>
                                        <input x-model="customReport.scheduleEmail" type="email" placeholder="Email reports to..." class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm">
                                    </div>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="space-y-3">
                                <button @click="generateReport()" :disabled="!isReportValid()" class="w-full bg-cannabis-green text-white py-3 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed font-semibold transition-colors">
                                    Generate Report
                                </button>
                                <button @click="saveReportTemplate()" :disabled="!isReportValid()" class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium transition-colors">
                                    Save as Template
                                </button>
                                <button @click="previewReport()" :disabled="!isReportValid()" class="w-full bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium transition-colors">
                                    Preview Report
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Toast Container -->
        <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2"></div>
    </div>

    <!-- JavaScript -->
<script>
        // Cannabis POS System Initialization
        document.addEventListener('DOMContentLoaded', function() {
            // Validate that the cannabisPOS function exists
            if (typeof cannabisPOS !== 'function') {
                console.error('Critical Error: Cannabis POS function is not defined.');
                return;
            }
            console.log('Cannabis POS system initialized successfully!');
        });
    </script>
</body>
</html>
